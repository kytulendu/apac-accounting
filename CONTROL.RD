
000020 READ-CONTROL.
000030	     READ NETWORK IGNORE LOCK.
000040     IF WS-STATUS = "00"
               MOVE 1            TO WS-COUNT
000050         GO TO READ-CONTROL-EXIT.
000060     IF WS-STAT1 = "2" OR "3" OR "4"
000070         MOVE 2            TO WS-F-ERROR
000080         PERFORM READ-ERROR.
000120       MOVE 2              TO WS-F-ERROR.
000130       PERFORM READ-ERROR.
000140       GO TO READ-CONTROL-EXIT.

000160 READ-CONTROL-LOCK.
000170       READ NETWORK WITH KEPT LOCK.
000180     IF WS-STATUS = "00"
000190         GO TO READ-CONTROL-EXIT.
000200     IF WS-STAT1 = "2" OR "3" OR "4"
000210         MOVE 2            TO WS-F-ERROR
000220         PERFORM READ-ERROR.
000230     IF RECORD-LOCKED
	       MOVE W02-NETWORK  TO WS-FILE
	       MOVE WS-NETKEY	 TO WS-KEY
000240	       PERFORM LOCKED-RECORD WS-COUNT TIMES
	       ADD 1		 TO WS-COUNT
	       IF WS-COUNT > 20
		   MOVE 1	 TO WS-COUNT
	       END-IF
000250	       GO TO READ-CONTROL-LOCK.
000260     IF TOO-MANY-LOCKS
000270         UNLOCK NETWORK
000280         GO TO READ-CONTROL-LOCK.
000290       MOVE 2              TO WS-F-ERROR.
000300       PERFORM READ-ERROR.

000320 READ-CONTROL-EXIT.
000330       EXIT.
