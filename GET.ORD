      *
      *    ****   G E T   S O R D E R   R E C O R D   U S I N G   SOR-KEY.
      *
013270 GET-SORDER-USING-KEY       SECTION.
013280 GET-SOR-ORDNO.
013310       MOVE W10-SORD       TO SOR-REF.
013420       MOVE ZERO           TO SOR-SEQ.
013430 CA10.
013440       PERFORM READ-STOCK THRU READ-STOCK-EXIT.
013450     IF WS-F-ERROR = 0
013460         PERFORM CA500.
013470 CA99.
013480       EXIT.
      *
      *    ****   G E T   S T O C K   R E C O R D   U S I N G   
      *           A L T E R N A T E   C O D E
      *
013490 CA100         SECTION.
013500 CA101.
013510       MOVE 10             TO W50-LENGTH.
013520 CA105.
013530       MOVE W10-ACODE      TO W50-DATA.
013540     IF W50-1 = SPACE
013550         MOVE W50-9        TO W10-ACODE
013560         GO TO CA105.      
013570       CALL "_MSUPCASE" USING W50-DATA
013580                        LENGTH W50-DATA
013590                               W50-LENGTH
013600                        LENGTH W50-LENGTH
013610                               W50-STATUS.
013620       MOVE W50-ACODE      TO STK-ACODE W10-ACODE.
013630 CA110.
013640       PERFORM START-AT-ALT-CODE THRU READ-STOCK-EXIT.
013650     IF WS-F-ERROR = 22
013660         GO TO CA119.
013670       PERFORM READ-STOCK-NEXT THRU READ-STOCK-EXIT.
013680     IF WS-F-ERROR = 0
013690         PERFORM CA500.
013700 CA119.
013710       EXIT.
