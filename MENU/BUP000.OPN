      $set LINKCOUNT"256"
      ******************************************************************
      *                                                                *
      *   *******   **    **  *******     ****      ****      ****     *
      *   **    **  **    **  **    **   **  **    **  **    **  **    *
      *   **    **  **    **  **    **  **    **  **    **  **    **   *
      *   *******   **    **  *******   **    **  **    **  **    **   *
      *   **    **  **    **  **        **    **  **    **  **    **   *
      *   **    **  **    **  **         **  **    **  **    **  **    *
      *   *******    ******   **          ****      ****      ****     *
      *                                                                *
      *     ENGLISH                                                    *
      *                                                                *
      *     ( A P A C )   S T A R T   &   I N I T    P R O G R A M     *
      *                                                                *
      *     VERSION 8.11 - January 2005 			       *
      * 							       *
      ******************************************************************
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		    VERSIONS OF THE APAC SYSTEM		       ณ
      *    ฦอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออต
      *    ณ While developing this system the requirements and budgets ณ
      *    ณ (originally this was a propriety package) for various     ณ
      *    ณ businesses necessitated that at least 4 separate systems  ณ
      *    ณ be produced. As the maintenance and amendments to the 4   ณ
      *    ณ different systems would require man hours that would not  ณ
      *    ณ enable me to do much development, it was decided to use   ณ
      *    ณ one system with the various requirements controlled by    ณ
      *    ณ the various menu programs using a version indicator. This ณ
      *    ณ indicator is located in the second record of the SYSTEM   ณ
      *    ณ file SEC-LEV, which is in the SEC-MODULES. This indicator ณ
      *    ณ together with all the other indicators in SEC-MODULES, is ณ
      *    ณ moved to WS0-MODULES in BUP000 or BUP001 and then passed  ณ
      *    ณ via the LINKAGE SECTION from program to program in  the   ณ
      *    ณ LS0-MODULES group. The other indicators in this group are ณ
      *    ณ used to show which modules of the system are installed.   ณ
      *    ฦอออออออออออออออออออัอออออออออออออออออออัอออออออออออออออออออต
      *    ณ	SYSTEM FILE    ณ      CHAIN.WS	   ณ	 CHAIN.LS      ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *	   ณ  03  SEC-MODULES. ณ  03  WS0-MODULES. ณ  03  LS0-MODULES. ณ
      *    ณ	  05  SEC-DTP  ณ      05  WS0-DTP  ณ	  05  LS0-DTP  ณ
      *    ณ	  05  SEC-STP  ณ      05  WS0-STP  ณ	  05  LS0-STP  ณ
      *    ณ	  05  SEC-HPD  ณ      05  WS0-HPD  ณ	  05  LS0-HPD  ณ
      *    ณ	  05  SEC-CRP  ณ      05  WS0-CRP  ณ	  05  LS0-CRP  ณ
      *    ณ	  05  SEC-GLP  ณ      05  WS0-GLP  ณ	  05  LS0-GLP  ณ
      *    ณ	  05  SEC-POS  ณ      05  WS0-POS  ณ	  05  LS0-POS  ณ
      *    ณ	  05  SEC-JCP  ณ      05  WS0-JCP  ณ	  05  LS0-JCP  ณ
      *    ณ	  05  SEC-VHP  ณ      05  WS0-VHP  ณ	  05  LS0-VHP  ณ
      *    ณ	  05  SEC-WAG  ณ      05  WS0-WAG  ณ	  05  LS0-WAG  ณ
      *    ณ	  05  SEC-SAL  ณ      05  WS0-SAL  ณ	  05  LS0-SAL  ณ
      *    ณ	  05  SEC-LEV  ณ      05  WS0-LEV  ณ	  05  LS0-LEV  ณ
      *    ณ	  05  SEC-WHS  ณ      05  WS0-WHS  ณ	  05  LS0-WHS  ณ
      *    ณ	  05  SEC-RTE  ณ      05  WS0-RTE  ณ	  05  LS0-RTE  ณ
      *	   ณ	  05  FILLER   ณ		   ณ		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
      *
000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.     BUP000.
000030 AUTHOR.         J W LEMMON  (APAC).
000040 DATE-WRITTEN.   OCTOBER 1982.

		   COPYRIGHT NOTICE: COPYRIGHT (C) 1982 - 2005
				     by James William Lemmon.
				       (Id No. 4412165050082).

		   All rights reserved.

		   e-mail jwlem@webmail.co.za.

000050 SECURITY.
		   This program is free software; you can redistribute
		   it and/or modify it under the terms of the GNU General
		   Public License as published by the Free Software
		   Foundation; either version 2 of the License, or (at
		   your option) any later version.

		   This program is distributed in the hope that it will
		   be useful, but WITHOUT ANY WARRANTY; without even the
		   implied warranty of MERCHANTABILITY or FITNESS FOR A
		   PARTICULAR PURPOSE.	See the GNU General Public License
		   for more details.

		   You should have received a copy of the GNU General
		   Public License along with this program; if not, write
		   to the Free Software Foundation, Inc., 59 Temple Place
		   - Suite 330, Boston, MA 02111-1307, USA.

000050 ENVIRONMENT DIVISION.
000060 CONFIGURATION SECTION.
000070 SPECIAL-NAMES.  
000080		       CURSOR IS CSTART
000090		       CONSOLE IS CRT
		       CRT STATUS IS KEY-STATUS.
000090 INPUT-OUTPUT SECTION.
000100 FILE-CONTROL.

       COPY APACFIDS.SL.

       COPY APACFILE.SL.

       COPY APCCOM.SL.

000140 COPY PARAM.SL.

000140 COPY PRNTCONT.SL.

000120 COPY SYSTEM.SL.

000160     SELECT PRNREP  ASSIGN W02-PRINTER
                          ORGANIZATION LINE SEQUENTIAL.

000170 DATA DIVISION.
000180 FILE SECTION.

       COPY APACFIDS.FDE.

       COPY APACFILE.FD.

       COPY APCCOM.FD.

000220 COPY PARAM.IFD.

000140 COPY PRNTCONT.FD.

000200 COPY SYSTEM.FD.

      /
000240 FD  PRNREP      LABEL RECORD OMITTED
000250		       LINAGE WS-PGE-LENGTH.
000260 01  REP-L1.
000270	   03  REP-DETAIL      PIC  X(132).
000280 01  REP-L2.
000290	   03  FILLER	       PIC  X(28).
000300	   03  REP-HEAD        PIC  X(24).
000310	   03  FILLER	       PIC  X(28).
000320 01  REP-L3.
000330     03  REP-GRPH        OCCURS 4.
000340	       05  FILLER      PIC  X(01).
000350	       05  REP-H1      PIC  X(06).
000360	       05  REP-H2      PIC  X(06).
000370	       05  REP-H3      PIC  X(06).
000380	       05  REP-DIV     PIC  X(01).
000390 01  REP-L4.
000400     03  REP-ASCII       OCCURS 4.
000410	       05  FILLER      PIC  X(01).
000420	       05  REP-DEC     PIC  Z99.
000430	       05  FILLER      PIC  X(03).
000440	       05  REP-HEX     PIC  X(02).
000450	       05  FILLER      PIC  X(04).
000460         05  REP-GRAPH.
000470		   07  FILLER  PIC  X(02).
000480             07  REP-ALPH PIC X(01).
000490		   07  FILLER  PIC  X(04).
000500 01  SYS-L1.
000510	   03  FILLER	       PIC  X(05).
000520	   03  SYS-H1	       PIC  X(09).
000530	   03  FILLER	       PIC  X(03).
000540	   03  SYS-H2	       PIC  X(05).
000550	   03  FILLER	       PIC  X(03).
000560	   03  SYS-H3	       PIC  X(09).
000570	   03  FILLER	       PIC  X(03).
000580	   03  SYS-H4	       PIC  X(07).
000590	   03  FILLER	       PIC  X(36).
000600 01  SYS-L2.
000610	   03  FILLER	       PIC  X(07).
000620	   03  SYS-FILE        PIC  X(06).
000630	   03  FILLER	       PIC  X(06).
000640	   03  SYS-DRIVE       PIC  X(01).
000650	   03  FILLER	       PIC  X(08).
000660	   03  SYS-EXT	       PIC  X(03).
000670	   03  FILLER	       PIC  X(07).
000680	   03  SYS-SIZE        PIC  Z(04)9.
000690	   03  FILLER	       PIC  X(37).
      /
000700 WORKING-STORAGE SECTION.
       77  WS-CHECK	   PIC	X(18)	 VALUE
			   "aeWlimemnomLalismJ".
000710 77  WS-S1	       PIC  9(04) COMP-5.
000720 77  WS-S2	       PIC  9(04) COMP-5.
000730 77  WS-S3	       PIC  9(04) COMP-5.
000740 77  WS-S4	       PIC  9(04) COMP-5.
000740 77  WS-S6	       PIC  9(04) COMP-5.
000740 77  WS-SUB-6	       PIC  9(04) COMP-5.
000750 77  WS-C1	       PIC  9(04) COMP-5.
000760 77  WS-C2	       PIC  9(04) COMP-5.
000770 77  WS-C3	       PIC  9(04) COMP-5.
000780 77  WS-C4	       PIC  9(04) COMP-5.
000710 77  WS-IXS1	       PIC  9(04) COMP-5.
000790 77  WS-SECKEY	       PIC  9(04) COMP-5.
000800 77  WS-PARKEY	       PIC  9(04) COMP-5.
000800 77  WS-PRNKEY	       PIC  9(04) COMP-5.
       77  WS-DTE	       PIC  9(08) COMP-3.
       77  WS-LEV	       PIC  9(01).
000810 77  WS-SERIAL	       PIC  X(07).
       77  WS-TERMS	       PIC  9(04) COMP-5.
000820 77  WS-NUM	       PIC  Z(04)9.
       77  WS-CONTRACT	       PIC  X(01) VALUE SPACE.
000870 77  WS-OPTION	       PIC  X(01).
000880 77  WS-INIT	       PIC  9(01) VALUE ZERO.
000890 77  WS-ERROR	       PIC  9(01) VALUE ZERO.
002570 77  WS-PGE-LENGTH       PIC  9(02) VALUE 66.
001870 77  WS-PRN-LENGTH       PIC  9(02) VALUE 62.
       77  WS-RESULT	       PIC  9(02) COMP-X.
       77  WS-FUNCTION         PIC  9(02) COMP-X.
000910 77  WS-CHAR	       PIC  X(01).
000920 77  WS-PAR	       PIC  9(01) VALUE 0.
000940 77  WS-START	       PIC  9(08).
000950 77  WS-END	       PIC  9(08).
000950 77  WS-XXX	       PIC  X(07).
       77  WS-PACK	       PIC  X(08).

000960 01  WS-GRAPHICS.
000970     03  WS-GCHAR        PIC X(01) OCCURS 20.
002060 01  WS-DB-LINE.
002070     03  WS-TOP-LINE.
002080         05  WS-TCHAR    PIC  X(01) OCCURS 80.
002430     03  WS-TOP-LNE2.
002440         05  WS-TCH      PIC  X(01) OCCURS 80.
           03  WS-TP-LINE2 REDEFINES WS-TOP-LNE2.
               05  FILLER      PIC  X(01).
               05  WS-TOP-COMP PIC  X(40).
001430	       05  FILLER      PIC  X(23).
	       05  WS-WRKHD    PIC  X(11).
001430	       05  FILLER      PIC  X(01).
	       05  WS-WRKST    PIC  X(03).
001430	       05  FILLER      PIC  X(01).
002450	   03  WS-MID-LINE.
002460         05  WS-MCHR     PIC  X(01) OCCURS 80.
	   03  WS-MID78 REDEFINES WS-MID-LINE.
	       05  FILLER      PIC  X(01).
	       05  WS-BLNK78   PIC  X(78).
	       05  FILLER      PIC  X(01).
002110	   03  WS-BOT-LINE.
002120         05  WS-BCHAR    PIC  X(01) OCCURS 80.
002470     03  WS-BOT-LNE2.
002480         05  WS-BCH      PIC  X(01) OCCURS 80.
000980 01  W00-ALPHA-SER.
000990     03  W00-SERIAL      PIC X(07).

001010 COPY WS.WS.

001010 COPY CHAIN.WS.

       01  W02-FILE-IDS.

       COPY APACFIDS.ID.

       COPY APACFILE.ID.

       COPY PARAM.ID.

       COPY SYSTEM.ID.

           03  W02-PRINTER.
               05  W02-REPORT PIC X(07) VALUE "BUP000.".
               05  W02-USER   PIC X(05) VALUE SPACES.

	   03  W02-RENAME-FILE PIC  X(64).

	   03  W02-NEW-FILE    PIC  X(64).

	   03  W02-WORK-PTH.
	       05  W02-COMP    PIC  X(03).
	       05  FILLER      PIC  X(05) VALUE "_WORK".
	       05  FILLER      PIC  X(01) VALUE X"00".

	   03  W02-CHECK-SYS.
	       05  W02-CHK-ID  PIC  X(03) VALUE SPACES.
	       05  FILLER      PIC  X(16) VALUE "_DATA\SYSTEM.DAT".
	       05  FILLER      PIC  X(01) VALUE X"00".

	   03  W02-OFFLINE.
	       05  FILLER      PIC  X(07) VALUE "OFFLINE".
	       05  FILLER      PIC  X(01) VALUE X"00".

001160 01  W05-COMMAND.
001170     03  W05-CHAR        PIC  X(01) OCCURS 128.
001180 01  W05-DETAIL.
001190     03  W05-DC          PIC  X(01) OCCURS 2.
001200 01  W05-COM REDEFINES W05-DETAIL.
001210     03  W05-DRW.                        
001220         05  W05-DRAW    PIC  9(02).

       COPY W12.WS.

001490 01  W15-HEX.
001500     03  W15-ASCII       PIC X(01) OCCURS 256.

001510 01  W20-DATE.
001520     03  W20-DAY         PIC 9(02).
001530     03  W20-MONTH       PIC 9(02).
	   03  W20-CENT        PIC 9(02).
001540     03  W20-YEAR        PIC 9(02).
001550 01  W20-DTE1 REDEFINES W20-DATE.
001560	   03  W20-DTE	       PIC 9(08).
001550 01  W20-DTE2 REDEFINES W20-DATE.
	   03  W20-CC	       PIC 9(02).
001520     03  W20-YY          PIC 9(02).
001530     03  W20-MM          PIC 9(02).
001540     03  W20-DD          PIC 9(02).
       01  W20-LEAP REDEFINES W20-DATE.
	   03  FILLER	       PIC 9(04).
	   03  W20-CY	       PIC 9(04).

001570 01  W25-CALCS.
001580	   03  W25-RESULT      PIC  9(09)V99.
001590     03  W25-RESULT1 REDEFINES W25-RESULT.
001600	       05  W25-DAYS    PIC  9(03).
001610	       05  W25-WHOLE   PIC  9(06).
001620	       05  W25-DECIMAL PIC  9(02).
	   03  W25-RESULT2 REDEFINES W25-RESULT.
	       05  FILLER      PIC  9(02).
	       05  W25-KEY     PIC  9(04).
	       05  W25-SUB     PIC  9(01).
	       05  FILLER      PIC  9(02).
001660	   03  W25-TIME        PIC  9(08).
001670     03  W25-TRED REDEFINES  W25-TIME.
001680	       05  FILLER      PIC  9(02).
001690	       05  W25-FACT    PIC  9(06).
	       05  W25-DATE REDEFINES W25-FACT.
		   07  W25-YY  PIC  9(02).
		   07  W25-MM  PIC  9(02).
		   07  W25-DD  PIC  9(02).
	   03  W25-CUR-CC      PIC  9(02) COMP-5.
	   03  W25-PRV-CC      PIC  9(02) COMP-5.
	   03  W25-NXT-CC      PIC  9(02) COMP-5.

001700 01  W30-MONTHS.
001710     03  W30-MONTH-NAMES.
001720         05  W30-ENG     PIC X(36)     VALUE
001730                         "JanFebMarAprMayJunJulAugSepOctNovDec".
001740     03  W30-MONTH REDEFINES W30-MONTH-NAMES
001750                         PIC X(03)     OCCURS 12.
       01  W31-DAYS.
           03  W31-DAY-NUMBERS.
               05  W31-DAYNO   PIC  X(36)    VALUE 
                               "000031059090120151181212243273303334".
               05  W31-DN REDEFINES W31-DAYNO.
                   07  W31-NO  PIC 9(03) OCCURS 12.
	   03  W31-DTE1        PIC 9(06) COMP-5.
	   03  W31-DTE2        PIC 9(06) COMP-5.

       COPY W40.WS.

       COPY FUNCTION.WS.

       01  W75-KEYS.
	   03  W75-S	       PIC  9(02) COMP-5.
	   03  W75-S1	       PIC  9(02) COMP-5.
	   03  W75-S2	       PIC  9(02) COMP-5.
	   03  W75-COM	       PIC  X(03) OCCURS 18.

001870 01  W85-PASS.
001880     03  W85-PW          PIC  X(02).
001890     03  W85-SUPER OCCURS 9
001900                         PIC  X(06).
001910     03  W85-ENTRY       PIC  9(02)    COMP-0.
001920     03  W85-MARG        PIC  9(02)V99.
001930     03  FILLER          PIC  X(02).

       LINKAGE SECTION.

       COPY CHAIN.LS.

001160 01  L05-COMMAND.
001170	   03  L05-CHAR        PIC  X(128).

      /
001940 SCREEN SECTION.

       COPY BLANK.CRT.

      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ			 A P A C   L O G O		       ณ
      *    ณ This is the logo displayed using graphics (ASCII) char-   ณ
      *    ณ acters and will later be changed to use a bitmat when the ณ
      *    ณ menus are changed to GUI.				       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

       COPY LOGO.CRT.

       01  MENU-INSTRUCT.
	   03  LINE 25 COLUMN  2 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE "Use ".
	   03	       COLUMN  6 HIGHLIGHT
				 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 6
				 VALUE "".
	   03	       COLUMN  7 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE " or ".
	   03	       COLUMN 11 HIGHLIGHT
				 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 6
				 VALUE "".
	   03	       COLUMN 12 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE " to point to an item, and ".
	   03	       COLUMN 38 HIGHLIGHT
				 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 6
				 VALUE "<Enter>".
	   03	       COLUMN 45 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE " to Select ".

002880 01  S01.
	   03  LINE  4 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE
	   "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
      -    "ฤฤฤฤฤฤฤฤ".
	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ฟ".
002900	   03  LINE  5 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 FOREGROUND-COLOR 4 HIGHLIGHT VALUE
002910	    "APAC - Business System (Version 2005).
      -     "        ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
002920	   03  LINE  6 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 FOREGROUND-COLOR 7 HIGHLIGHT VALUE
002930	    "Copyright (C) 1982 - 2005  JW Lemmon.
      -     "        ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
002940	   03  LINE  7 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 HIGHLIGHT VALUE
	    "This SOFTWARE is used under the GNU General Public License
      -	    "as      ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
002960	   03  LINE  8 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 FOREGROUND-COLOR 7 HIGHLIGHT VALUE
	    "published by the Free Software Foundation; either version 2
      -     " of the ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
002980	   03  LINE  9 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 HIGHLIGHT VALUE
	    "License, or (at your option) any later version.
      -     "        ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
003000	   03  LINE 10 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 HIGHLIGHT VALUE
	    "This program is distributed in the hope that it will be use
      -	    "ful, but".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
003030	   03  LINE 11 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 HIGHLIGHT VALUE
	    "WITHOUT ANY WARRANTY; without even the implied warranty of
      -	    "        ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
003060	   03  LINE 12 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 HIGHLIGHT VALUE
	    "MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
      -     "        ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
003070	   03  LINE 13 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ณ".
	   03	       COLUMN  7 FOREGROUND-COLOR 7 HIGHLIGHT VALUE
	    "See the GNU General Public License for more details.
      -     "        ".
002920	   03	       COLUMN 74 FOREGROUND-COLOR 0 VALUE "ณ".
	   03  LINE 14 COLUMN  6 FOREGROUND-COLOR 1 HIGHLIGHT VALUE "ภ".
	   03	       COLUMN  7 FOREGROUND-COLOR 0 VALUE
	   "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
      -    "ฤฤฤฤฤฤฤู".

003090	   03  LINE 16 COLUMN  7 FOREGROUND-COLOR 6 HIGHLIGHT VALUE
003100	    "Do you accept these conditions (Y/N)  ".

000850 01  S-PROG.
003430	   03  LINE  2 COLUMN 35 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 7 HIGHLIGHT
003460                           VALUE "SYSTEM MENU".

       01  S-MENU.
	   03  LINE  8 COLUMN 30 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ".
	   03	       COLUMN 51 BACKGROUND-COLOR 7 FOREGROUND-COLOR 0
				 VALUE "ฟ".
	   03  LINE  9 COLUMN 30 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "ณ   ".
	   03	       COLUMN 34 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "SYSTEM CONTROL".
	   03	       COLUMN 48 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 0
				 VALUE "   ณ".
	   03  LINE 10 COLUMN 30 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "1".
	   03	       COLUMN 33 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 0
				 VALUE " Run the System   ณ".
	   03  LINE 11 COLUMN 30 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "2".
	   03	       COLUMN 33 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 0
				 VALUE " Special Routines ณ".
	   03  LINE 12 COLUMN 30 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "9".
	   03	       COLUMN 33 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 0
				 VALUE " Exit to Op-Systemณ".
	   03  LINE 13 COLUMN 30 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 7 HIGHLIGHT
				 VALUE "ภ".
	   03	       COLUMN 31 BACKGROUND-COLOR 7 FOREGROUND-COLOR 0
				 VALUE "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".

       01  S-MENU2.
	   03  LINE  5 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
			 VALUE "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ".
	   03	       COLUMN 51 BACKGROUND-COLOR 2 FOREGROUND-COLOR 0
				 VALUE "ฟ".
	   03  LINE  6 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ  ".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "SPECIAL ROUTINES".
	   03	       COLUMN 49 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE "  ณ".
	   03  LINE  7 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "1".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE " Offline Location ณ".
	   03  LINE  8 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "2".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE " Initialize Files ณ".
001470	   03  LINE  9 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "3".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE " Run the System   ณ".
001570	   03  LINE 10 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "4".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE " Print ASCII Tableณ".
001500	   03  LINE 11 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "5".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE " Clear W/Stat. Logณ".
	   03  LINE 12 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "6".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE " Amend No of W/St ณ".
	   03  LINE 13 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ณ ".
	   03	       COLUMN 32 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "9".
	   03	       COLUMN 33 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 0
				 VALUE " Exit to Op-Systemณ".
	   03  LINE 14 COLUMN 30 BACKGROUND-COLOR 2
				 FOREGROUND-COLOR 2 HIGHLIGHT
				 VALUE "ภ".
	   03	       COLUMN 31 BACKGROUND-COLOR 2 FOREGROUND-COLOR 0
				 VALUE "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".

       01  S-COM.
	   03  LINE  6 COLUMN 28 FOREGROUND-COLOR 7 HIGHLIGHT
	       BACKGROUND-COLOR 7 VALUE "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
      -        "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ".
	   03	       COLUMN 75 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 VALUE "ฟ".
	   03  LINE  7 COLUMN 28 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 29 FOREGROUND-COLOR 5
	       BACKGROUND-COLOR 7 VALUE "     C O M P A N Y   C O D E
      -	       "L O O K U P    ".
	   03	       COLUMN 75 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 VALUE "ณ".
	   03  LINE  8 COLUMN 28 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 29 FOREGROUND-COLOR 5
	       BACKGROUND-COLOR 7 VALUE "ฺฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
      -        "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ".
	   03	       COLUMN 75 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 VALUE "ณ".
	   03  LINE 21 COLUMN 28 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 29 FOREGROUND-COLOR 5
	       BACKGROUND-COLOR 7 VALUE "ภฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
      -        "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".
	   03	       COLUMN 75 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 VALUE "ณ".
	   03  LINE 22 COLUMN 28 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ภ".
	   03	       COLUMN 29 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
	       VALUE "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".
       01  SD-COM.
	   03  COLUMN 30 FOREGROUND-COLOR 5
			 BACKGROUND-COLOR 7 PIC X(03) FROM COM-CODE.
	   03  COLUMN 34 FOREGROUND-COLOR 1 BACKGROUND-COLOR 7
			 PIC X(40) FROM COM-NAME.

003330 01  S03.
003340	   03  LINE 18 COLUMN  7 FOREGROUND-COLOR 6 HIGHLIGHT
				 VALUE "Company Identity Code ?".

003370 01  S04.
003380	   03  LINE 18 COLUMN 31 FOREGROUND-COLOR 7 HIGHLIGHT
003390				 PIC X(03) USING WS-SYS-ID AUTO.

003490 01  S06.
003500     03  LINE  8 COLUMN 12 VALUE "Enter Password >      <".
003510     03  LINE 16 COLUMN  8 BACKGROUND-COLOR 4
003520                           FOREGROUND-COLOR 15 VALUE
003530         " NB. ALL terminals MUST have signed off before this rout
003540-        "ine ".
003550     03  LINE 17 COLUMN  8 BACKGROUND-COLOR 4
003560                           FOREGROUND-COLOR 15 VALUE 
003570         " can  be run.  If this routine is run  while terminals  
003580-        "are ".
003590     03  LINE 18 COLUMN  8 BACKGROUND-COLOR 4
003600                           FOREGROUND-COLOR 15 VALUE 
003610         " still  attached, the  results are unpredictable and  co
003620-        "uld ".
003630     03  LINE 19 COLUMN  8 BACKGROUND-COLOR 4
003640                           FOREGROUND-COLOR 15 VALUE 
003650         " result in the LOSS OF DATA or worse if a recovery is ru
003660-        "n.  ".

003670 01  S07.
003680	   03  LINE  8 COLUMN 28 FOREGROUND-COLOR 7 HIGHLIGHT
				 PIC  X(06) TO W40-CSHPASS AUTO SECURE.

       01  S08.
	   03  LINE 17 COLUMN 32 FOREGROUND-COLOR 7 HIGHLIGHT
				 PIC  X(07) TO W00-SERIAL AUTO SECURE.

003700 01  S10.
003710	   03  LINE  5 COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
003720				 PIC Z9/99/9999 USING SEC-DATE AUTO.

003730 01  S11.
003740	   03  LINE 20 COLUMN  7 FOREGROUND-COLOR 6 HIGHLIGHT
				 VALUE "Work Station id ".

003750 01  S12.
003760	   03  LINE 20 COLUMN 23 FOREGROUND-COLOR 7 HIGHLIGHT
003770                           PIC X(03) USING WS-USER AUTO.

003780 01  S13.
003790     02  S13A.
003800	   03  LINE  2 COLUMN 26 FOREGROUND-COLOR 7 HIGHLIGHT
003810				 VALUE "OFFLINE FILE LOCATIONS".
003820     02  S13B.
	   03  LINE 12 COLUMN 18 FOREGROUND-COLOR 6 HIGHLIGHT
	       VALUE "This routine will set up the offline locations".
	   03  LINE 14 COLUMN 18 FOREGROUND-COLOR 6 HIGHLIGHT
				 VALUE "Press ANY key to continue".

004790 01  S17.
004800	   03  LINE  3 COLUMN 33 FOREGROUND-COLOR 7 HIGHLIGHT
004810                           VALUE "INITIALIZE FILES".
004820	   03  LINE  5 COLUMN  4 FOREGROUND-COLOR 6 HIGHLIGHT
004810				 VALUE "Are you sure (Y/N)? > <".

004790 01  S17A.
004800	   03  LINE  3 COLUMN 31 FOREGROUND-COLOR 7 HIGHLIGHT
004810                           VALUE "REGISTER THE SYSTEM".
004820	   03  LINE  5 COLUMN  4 FOREGROUND-COLOR 6 HIGHLIGHT
004810				 VALUE "Are you sure (Y/N)? > <".

004790 01  S17B.
004800	   03  LINE  3 COLUMN 28 FOREGROUND-COLOR 7 HIGHLIGHT
004810				 VALUE "AMEND NO. OF WORK STATIONS".
004820	   03  LINE  5 COLUMN  4 FOREGROUND-COLOR 6 HIGHLIGHT
004810				 VALUE "Are you sure (Y/N)?".

004790 01  S17C.
004800	   03  LINE  3 COLUMN 34 FOREGROUND-COLOR 7 HIGHLIGHT
004810				 VALUE "RENEW CONTRACT".
004820	   03  LINE  5 COLUMN  4 FOREGROUND-COLOR 6 HIGHLIGHT
004810				 VALUE "Are you sure (Y/N)? > <".

004830 01  S18.
	   03  LINE  4 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ".
	   03	       COLUMN 65 BACKGROUND-COLOR 7 FOREGROUND-COLOR 0
				 VALUE "ฟ".
	   03  LINE  5 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "Packaging and Marketing:                        ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
004850	   03  LINE  6 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE
004860	       "       WORKGROUP DATA SOLUTIONS.                ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03  LINE  7 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE
	       "       18 Milford Crest, North Riding, JHB.     ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
004880	   03  LINE  8 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE
	       "       PO Box 68416,                            ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
004890	   03  LINE  9 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE
	       "       BRYANSTON. 2021                          ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
004900	   03  LINE 10 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "Support:                                        ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
004910	   03  LINE 11 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE
	       "  See the registration card, supplied with the  ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03  LINE 12 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE
	       "  system, for details of the telephone and fax  ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
004910	   03  LINE 13 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE
	       "  numbers of the APAC support line.             ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03  LINE 14 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "  For local support in your area please contact ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03  LINE 15 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
004910	   03	       COLUMN 17 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "  the support line, who will in turn give you   ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03  LINE 16 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03	       COLUMN 17 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "  details of your local support centre.         ".
	   03	       COLUMN 65 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 7 VALUE "ณ".
	   03  LINE 17 COLUMN 16 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "ภ".
	   03	       COLUMN 17 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 0 VALUE
	       "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".

004970	   03  LINE 19 COLUMN 17 FOREGROUND-COLOR 6 HIGHLIGHT
004980		       VALUE "Please key in todays date (DDMMCCYY)".

004990 01  S20.
005000	   03  LINE 19 COLUMN 54 FOREGROUND-COLOR 7 HIGHLIGHT
005010				 PIC Z9/99/9999 USING W20-DTE AUTO.

       01  S25.
	   03  LINE  8 COLUMN  4 FOREGROUND-COLOR 6 HIGHLIGHT
005010				 VALUE "Work Stations :".
	   03  LINE 10 COLUMN 10 VALUE "Package: ".
	   03	       COLUMN 20 FOREGROUND-COLOR 3 HIGHLIGHT
				 PIC  X(08) FROM WS-PACK.
	   03  S25A.
	       05  LINE 8 COLUMN 20 FOREGROUND-COLOR 7 HIGHLIGHT
				    PIC ZZ9 USING WS-TERMS AUTO.

       01  S30.
	   03  LINE 12 COLUMN 50 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 5
				 PIC ZZ9 USING WS-TERMS AUTO.

004870 COPY S99.CRT.

       COPY ERROR.CRT.

      /
010570 PROCEDURE DIVISION
		 USING LS-PARID LS-USER-ID LS0-PROGRAMS L05-COMMAND.
005070 AA000-MAIN              SECTION.
005080 AA00.
             MOVE ALL "X"        TO WS-XXX.
005090       DISPLAY SPACE AT 0101.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ  DATE RETURNS A SIX DIGIT RESULT AS YYMMDD. W25-FACT IS   ณ
      *    ณ  DEFINED AS YYMMDD. THESE DETAILS ARE THEN MOVED TO       ณ
      *    ณ  W12-TODAY (DDMMCCYY) AND THE CENTURY (20) IS INSERTED.   ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     ACCEPT W25-FACT FROM DATE.
	     MOVE W25-YY	 TO W12-YEAR.
	     MOVE W25-MM	 TO W12-MONTH.
	     MOVE W25-DD	 TO W12-DAY.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ T H I S   I F   S T A T E M E N T	 W A S	 U S E D   T O ณ
      *    ณ H A N D L E   T H E   M I L L E N I U M   S W I T C H     ณ
      *    ณ O V E R.						       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
      *	   IF W25-YY < 50
      *	       MOVE 20		 TO W12-CENT
      *	   ELSE
      *	       MOVE 19		 TO W12-CENT.
	     MOVE 20		 TO W12-CENT.
	     MOVE W12-TODAY	 TO TODAY-DDMMYY.
003200	     MOVE W12-DAY	 TO W12-DD.
003210	     MOVE W12-MONTH	 TO W12-MM.
	     MOVE W12-CENT	 TO W12-CC.
003220	     MOVE W12-YEAR	 TO W12-YY.
005100       PERFORM AL000.
005110	     MOVE W05-DRAW	 TO WS-DRAW.

       AA02.
005210       DISPLAY CLR-SCREEN.
	     DISPLAY WS-BLNK78 AT 0202 WITH FOREGROUND-COLOR 3.
	     MOVE 5		 TO SHADE-ROW.
	     MOVE 8		 TO SHADE-COL.
	     MOVE 67		 TO SHADE-WIDTH.
	     MOVE 10		 TO SHADE-LINES.
	     DISPLAY S01.
	     PERFORM SCREEN-SHADOW.
005130       PERFORM AD000.
005140     IF WS-PAR = 9
005150	       PERFORM AK000
	       GO TO AA02.
	   IF MOUSE-ATTACHED = "Y"
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 1		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM.
005210	     DISPLAY CLR-SCREEN.
005220	     DISPLAY S-PROG.
	     MOVE 9		 TO SHADE-ROW.
	     MOVE 32		 TO SHADE-COL.
	     MOVE 20		 TO SHADE-WIDTH.
	     MOVE 5		 TO SHADE-LINES.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		       The System Start Menu		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
005240	     DISPLAY S-MENU.
	     DISPLAY MENU-INSTRUCT.
	     PERFORM SCREEN-SHADOW.
	     MOVE 9		 TO TOP-ROW.
	     MOVE 11		 TO BOTTOM-ROW.
	     MOVE 8		 TO SCREEN-LIN.
	     MOVE 32		 TO SCREEN-COL.
	     MOVE 18		 TO STRING-LENGTH.
	     PERFORM SAVE-ATTR.
006280	     MOVE 2		 TO WS-SECKEY.
006300	     READ SECUR.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	C H E C K   T O	  S E E	  I F	T H E	A N N U A L    ณ
      *    ณ	C O N T R A C T	  M U S T   B E	  R E N E W E D	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	   IF SEC-AGREE = "R"
	       IF NOT (SEC-DAYS = 255)
		   DISPLAY "Contract must be renewed" AT 1629
			    WITH FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4
		   IF SEC-DAYS > 15
		       MOVE SEC-ANDATE
				 TO W20-DTE
015070		       DISPLAY "By - " AT 1729
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4
				W20-DD
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4
				" "
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4
015080				W30-MONTH (W12-MM)
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4
				","
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4
				W12-CC
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4
				W12-YY
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4
				"        "
				WITH FOREGROUND-COLOR 7 HIGHLIGHT
				     BACKGROUND-COLOR 4.

       AA05.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.

       AA10.
	   IF ADIS-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN UP-KEY	 PERFORM MOVE-BLOCK-UP
		 WHEN DOWN-KEY	 PERFORM MOVE-BLOCK-DOWN
		 WHEN MOUSE-KEY  PERFORM POSITION-MOUSE
				 IF MOUSE-ENTER = "Y"
				     MOVE "N"	 TO MOUSE-ENTER
				     GO TO AA15
				 END-IF
				 IF MOUSE-Y = 24
				     IF MOUSE-X = 5
					 MOVE 5  TO KEY-CODE-1
					 GO TO AA10
				     ELSE
				     IF MOUSE-X = 10
					 MOVE 6  TO KEY-CODE-1
					 GO TO AA10
				     ELSE
				     IF MOUSE-X > 36 AND < 44
					 MOVE 0  TO KEY-CODE-1
					 GO TO AA10
				     ELSE
				     IF MOUSE-X > 54 AND < 60
					 MOVE 0  TO KEY-CODE-1
					 MOVE 1  TO KEY-TYPE
					 GO TO AA10
				     END-IF
				 END-IF
		 WHEN ENTER-KEY  GO TO AA15
		 WHEN OTHER	 CALL X"E5"
	       END-EVALUATE
	       GO TO AA05
	   ELSE
	   IF DATA-8BIT
	       MOVE KEY-CODE-1X  TO WS-OPTION
	       IF NOT (WS-OPTION = 1 OR 2 OR 9)
		   CALL X"E5"
		   GO TO AA05
	       END-IF
	       GO TO AA16
	   ELSE
	       CALL X"E5"
	       GO TO AA05.

       AA15.
	   IF SCREEN-LIN < 9
	       CALL X"E5"
	       GO TO AA05
	   ELSE
	   IF SCREEN-LIN = 9
	       MOVE "1"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 10
	       MOVE "2"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 11
	       MOVE "9"		 TO WS-OPTION.
	   GO TO AA18.

       AA16.
	     PERFORM CLEAR-BLOCK.
	   IF WS-OPTION = "9"
	       MOVE 11		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "1"
	       MOVE 9		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "2"
	       MOVE 10		 TO SCREEN-LIN.
	     PERFORM SAVE-ATTR.
	     PERFORM MARK-BLOCK.

       AA18.
	   IF MOUSE-ATTACHED = "Y"
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 0		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM.
005320	   IF WS-OPTION = "9"
005330	       MOVE 6		 TO WS-ERROR
005340         GO TO AZ000-EOJ.
005350	   IF WS-OPTION = "1"
005510         PERFORM AI000
005520         IF WS-ERROR = ZERO
005530		   GO TO AZ000-EOJ.
005160	     GO TO AB00.
005170 AA999.
005180       EXIT.

005190 AB000	    SECTION.
005200 AB00.
006280	     MOVE 2		 TO WS-SECKEY.
006300	     READ SECUR.
	   IF MOUSE-ATTACHED = "Y"
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 1		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM.
005210	     DISPLAY CLR-SCREEN.
005220	     DISPLAY S-PROG.
	     MOVE 6		 TO SHADE-ROW.
	     MOVE 32		 TO SHADE-COL.
	     MOVE 20		 TO SHADE-WIDTH.
	     MOVE 9		 TO SHADE-LINES.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		 The System Special Routines Menu	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     DISPLAY S-MENU2.
	     DISPLAY MENU-INSTRUCT.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ If the USER of the system is not on an annual contract    ณ
      *    ณ then change the 'Renew Contract' menu item to Not Applic- ณ
      *    ณ able and set WS-CONTRACT to 'N'.			       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	   IF NOT (SEC-AGREE = "R") OR
	      (SEC-AGREE = "R" AND SEC-DAYS = 255)
	       MOVE "N"		 TO WS-CONTRACT
	       DISPLAY " (N/A)" AT 1444
			WITH FOREGROUND-COLOR 0
			     BACKGROUND-COLOR 2.
	     PERFORM SCREEN-SHADOW.

       AB02.
	     MOVE 6		 TO TOP-ROW.
	     MOVE 12		 TO BOTTOM-ROW.
	     MOVE 5		 TO SCREEN-LIN.
	     MOVE 32		 TO SCREEN-COL.
	     MOVE 18		 TO STRING-LENGTH.
	     PERFORM SAVE-ATTR.

       AB05.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.

       AB10.
	   IF ADIS-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN UP-KEY	 PERFORM MOVE-BLOCK-UP
		 WHEN DOWN-KEY	 PERFORM MOVE-BLOCK-DOWN
		 WHEN MOUSE-KEY  PERFORM POSITION-MOUSE
				 IF MOUSE-ENTER = "Y"
				     MOVE "N"	 TO MOUSE-ENTER
				     GO TO AB15
				 END-IF
				 IF MOUSE-Y = 24
				     IF MOUSE-X = 5
					 MOVE 5  TO KEY-CODE-1
					 GO TO AB10
				     ELSE
				     IF MOUSE-X = 10
					 MOVE 6  TO KEY-CODE-1
					 GO TO AB10
				     ELSE
				     IF MOUSE-X > 36 AND < 44
					 MOVE 0  TO KEY-CODE-1
					 GO TO AB10
				     ELSE
				     IF MOUSE-X > 54 AND < 60
					 MOVE 0  TO KEY-CODE-1
					 MOVE 1  TO KEY-TYPE
					 GO TO AB10
				     END-IF
				 END-IF
		 WHEN ENTER-KEY  GO TO AB15
		 WHEN OTHER	 CALL X"E5"
	       END-EVALUATE
	       GO TO AB05
	   ELSE
	   IF DATA-8BIT
	       MOVE KEY-CODE-1X  TO WS-OPTION
	       IF (WS-OPTION < 1 OR > 6) AND
		  (WS-OPTION NOT = 9)
		   CALL X"E5"
		   GO TO AB05
	       END-IF
	       GO TO AB16
	   ELSE
	       CALL X"E5"
	       GO TO AB05.

       AB15.
	   IF SCREEN-LIN < 6
	       CALL X"E5"
	       GO TO AB05
	   ELSE
	   IF SCREEN-LIN = 6
	       MOVE "1"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 7
	       MOVE "2"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 8
	       MOVE "3"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 9
	       MOVE "4"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 10
	       MOVE "5"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 11
	       MOVE "6"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 12
	       MOVE "9"		 TO WS-OPTION.
	   GO TO AB18.

       AB16.
	     PERFORM CLEAR-BLOCK.
	   IF WS-OPTION = "9"
	       MOVE 12		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "1"
	       MOVE 6		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "2"
	       MOVE 7		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "3"
	       MOVE 8		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "4"
	       MOVE 9		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "5"
	       MOVE 10		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "6"
	       MOVE 11		 TO SCREEN-LIN.
	     PERFORM SAVE-ATTR.
	     PERFORM MARK-BLOCK.

       AB18.
	   IF MOUSE-ATTACHED = "Y"
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 0		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM.
005320	   IF WS-OPTION = "9"
005330	       MOVE 6		 TO WS-ERROR
005340	       GO TO AZ000-EOJ.
005350	   IF WS-OPTION = "1"
005360         PERFORM AE000         
005370         GO TO AB00.
005380	   IF WS-OPTION = "2"
005420         PERFORM AG000
005430         IF WS-ERROR = 9
005440		   GO TO AZ000-EOJ
005450         ELSE
005460             GO TO AB00.
005410	   IF WS-OPTION = "3"
005390	       PERFORM AI000
005520	       IF WS-ERROR = ZERO
005530		   GO TO AZ000-EOJ
005540         ELSE
005550             GO TO AB00.
005380	   IF WS-OPTION = "4"
005510	       PERFORM AJ000
005400	       GO TO AB00.
005500	   IF WS-OPTION = "5"
005570	       PERFORM AM000
005580         GO TO AB00.
005560	   IF WS-OPTION = "6"
005600	       PERFORM AN000
005610         GO TO AB00.
005620	     GO TO AB05.
      /    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	   D A T E   V A L I D A T I O N   R O U T I N E       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
005630 AB000-DATE              SECTION.
005640 AB000-VALID-DATE.
005650	     MOVE ZERO		 TO WS-ERROR.
005660     IF W20-DAY < 01 OR > 31
005670         GO TO AB010-ERROR.
005680     IF W20-MONTH < 01 OR > 12
005690         GO TO AB010-ERROR.
005700     IF W20-MONTH = 01 OR 03 OR 05 OR 07 OR 08 OR 10 OR 12
005710         GO TO AB999-EXIT.
005720     IF W20-MONTH = 02 AND W20-DAY > 28
005730         GO TO AB005-FEB.
005740     IF W20-DAY > 30
005750         GO TO AB010-ERROR.
005760       GO TO AB999-EXIT.

005770 AB005-FEB.
005780     IF W20-DAY > 29
005790         GO TO AB010-ERROR.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	Check for a leap year if February and the day is 29    ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
005800	     DIVIDE W20-CY BY 4  GIVING W25-RESULT.
005810	   IF W25-DECIMAL = 0
005820         GO TO AB999-EXIT.

005830 AB010-ERROR.
005840	     MOVE 1		 TO WS-ERROR.

005850 AB999-EXIT.
005860       EXIT.
      /    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		   E N D   O F F   P R O G R A M	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
021980 AZ000-END	       SECTION.
021990 AZ000-EOJ.
	   IF WS-DEM > 2
006280	       MOVE 2		 TO WS-SECKEY
006300	       READ SECUR
	       MOVE 2		 TO SEC-DEM
	       MOVE ZERO	 TO SEC-DATE
008570	       REWRITE SEC-REC2.
022000	   IF WS-INIT NOT = 2
022010         GO TO AZ05.
022090       CLOSE PARAM.

022100 AZ05.
022110       CLOSE SECUR.
022130       DISPLAY CLR-SCREEN.
	     MOVE WS-ERROR	 TO WS-RET.
	     MOVE WS-PARID	 TO LS-PARID.
	     MOVE WS-USER-ID	 TO LS-USER-ID.
	     MOVE WS0-PROGRAMS	 TO LS0-PROGRAMS.
	   IF WS-ERROR = ZERO
	       MOVE "C" 	 TO LS-INSTR
	       MOVE SPACES	 TO LS-NEXT-PRG
	   ELSE
	   IF WS-ERROR = 9
	       MOVE "I" 	 TO LS-INSTR
	       MOVE "UTP\APACINST"
				 TO LS-NEXT-PRG
	   ELSE
	       MOVE "E" 	 TO LS-INSTR.

       AZ99.
	     EXIT PROGRAM.

      /    *************************************************************
      *    ****    ROUTINES TO HANDLE VARIOUS FUNCTIONS FOR THE
      * 	   S C R E E N ,   K E Y B O A R D   &	 M O U S E
      *    *************************************************************
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	   SAVE-SCREEN /-2/-3  and  RESTORE-SCREEN /-2/-3      ณ
      *    ฦอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออต
      *    ณ			  SCREEN-SHADOW 		       ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ To routine is used to display a shadow down the right and ณ
      *    ณ along the bottom of a pop-up box. The parameters that are ณ
      *    ณ required:						       ณ
      *	   ณ	       SHADE-ROW   - Top line of the box + 1.	       ณ
      *	   ณ	       SHADE-COL   - Left line of box + 2.	       ณ
      *	   ณ	       SHADE-WIDTH - Width of the box - 2.	       ณ
      *	   ณ	       SHADE-LINES - Hight of box - 1.		       ณ
      *    ฦอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออต
      *    ณ			  CHECK-CORRECT 		       ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ This routine displays a pop-up window with the message    ณ
      *    ณ	      "Correct ENTER - N if incorrect"		       ณ
      *    ณ							       ณ
      *    ณ The response is returned in WS-OPTION (in upper case).    ณ
      *    ณ							       ณ
      *    ณ To start with the pop-up window higher or lower than row  ณ
      *    ณ 13 (default); move another value to SLIN and PERFORM      ณ
      *    ณ CHECK-SETUP THRU CHECK-EXIT.			       ณ
      *    ฦอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออต
      *    ณ			  ERROR-MESSAGE 		       ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ To display an error message with " - Press ANY key" at    ณ
      *    ณ the end; use PERFORM ERROR-MESSAGE.		       ณ
      *    ณ							       ณ
      *    ณ To display just the error message; use PERFORM	       ณ
      *    ณ ERROR-LENGTH THRU ERROR-EXIT.			       ณ
      *    ณ							       ณ
      *    ณ To display the error message higher or lower (default is  ณ
      *    ณ line 13) firstly use PERFORM ERROR-SETUP THRU ERROR-POS   ณ
      *    ณ or PERFORM ERROR-LENGTH THRU ERROR-POS. Move the line     ณ
      *    ณ number to be used to SLIN and then PERFORM ERROR-DISPLAY  ณ
      *    ณ THRU ERROR-EXIT.					       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

       COPY FUNCTION.CRT.

      /    *************************************************************
      *    *****	I N I T I A L I Z E   P R O G R A M	   *****
      *    *************************************************************
005870 AD000	       SECTION 50.
005880 AD00.
	   IF LS-INSTR = "X"
	       DISPLAY WS-BLNK78 AT 1602 WITH FOREGROUND-COLOR 3
	       MOVE SPACE	 TO LS-INSTR
	       GO TO AD05.
005890	     ACCEPT WS-OPTION AT 1644
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
005950	   IF NOT (WS-OPTION = "Y" OR "N")
005960         GO TO AD00.
005970	   IF NOT (WS-OPTION = "Y")
005980	       STOP RUN.
	     MOVE SPACES	 TO WS-SYS-ID.
      *    *************************************************************
      *    ****       G E T   S Y S T E M   E X T E N S I O N	    ****
      *    *************************************************************
005990 AD05.
006000       DISPLAY S03.
	     DISPLAY "F2" AT 2502
		      WITH BACKGROUND-COLOR 3
			   FOREGROUND-COLOR 6 HIGHLIGHT
		     " to view existing codes"
		      WITH BACKGROUND-COLOR 3
			   FOREGROUND-COLOR 1.
006010	     ACCEPT S04.
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN F2-KEY
		     OPEN INPUT APCCOM
018810		     PERFORM COMPANY-LOOKUP
		     CLOSE APCCOM
		     GO TO AD05
		 WHEN OTHER
		     CALL X"E5"
		     GO TO AD05
	       END-EVALUATE.
	     DISPLAY CLEAR-L25.
	   IF WS-SYS-ID = SPACES
	       GO TO AD05.
006020	     MOVE 3		 TO WS-LENGTH.
	     CALL "CBL_TOUPPER" USING WS-SYS-ID
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
006080	     MOVE 1		 TO WS-LENGTH.

       AD05-APAC.
	     PERFORM APACFILES.
006190	   IF NOT (WS-ERROR = 9)
	       OPEN I-O SECUR.
006200	   IF RUNTIME-ERROR
	       IF FLE-LOCKED
006210		   MOVE "Files locked - try later - Press ENTER"
006220				 TO WS-ERR-MES
006230		   PERFORM ERROR-LENGTH THRU ERROR-EXIT
006240		   STOP RUN.
      *
      *	     DISPLAY WS-STAT1 AT 2404.
      *	     DISPLAY WS-STAT2H AT 2407.
      *	     DISPLAY WS-DSKDRV AT 2412.
      *	     DISPLAY W02-SYSTEM AT 2504.
      *	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.
      *
	   IF (WS-STAT1 = "9") AND
	      (WS-STAT2H = 009 OR 199) AND
	      (WS-DSKDRV = "N")
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	       F I L E S   N O T   A V A I L A B L E	       ณ
      *    ณ  Check if this is a Network and if off-line files exist.  ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	       PERFORM AD200
	       IF WS-ERROR = 0
		   PERFORM AD100
		   IF WS-OPTION = "Y"
		       MOVE "OFFLINE\"
				 TO W02-N-OR-L
				    W02-L-OR-N
				    WS-L-OR-N
		       MOVE "L"	 TO WS-DSKDRV
		       GO TO AD05-APAC
		   ELSE
		       MOVE "System Aborted- No network drive"
				 TO WS-ERR-STRING
003260		       PERFORM ERROR-MESSAGE
		       STOP RUN.
006250	   IF WS-STATUS NOT = "00"
006260	       MOVE "Invalid or file not on disk - Exit or 'R'ekey"
				 TO WS-ERR-MES
006230	       PERFORM ERROR-LENGTH THRU ERROR-EXIT
	       IF WS-OPTION = "R"
		   GO TO AD05
               ELSE
006270             STOP RUN.
006280	     MOVE 2		 TO WS-SECKEY.

006290 AD005.
006300       READ SECUR.
006310     IF WS-STATUS = "00"
006320         GO TO AD005A.
006330     IF RUNTIME-ERROR
006340         IF RECORD-LOCKED
006350             GO TO AD005.
006260	     STRING "Invalid or file not on disk - "
		     DELIMITED SIZE
		     WS-STATUS DELIMITED SIZE
		     INTO WS-ERR-MES.
	     PERFORM ERROR-LENGTH THRU ERROR-EXIT.
006370	     STOP RUN.

006380 AD005A.
	     DISPLAY SEC-COMP AT 2207 WITH FOREGROUND-COLOR 14.
	   IF (SEC-TERMS < 2 OR > 100)
	       DISPLAY " Single USER System" AT 2247
			WITH FOREGROUND-COLOR 7 HIGHLIGHT
	   ELSE
	       ADD 1 SEC-TERMS	 GIVING WS-NUM
	       DISPLAY " " AT 2247
			WS-NUM WITH FOREGROUND-COLOR 7 HIGHLIGHT
		       " WORK Stations"
			WITH FOREGROUND-COLOR 7 HIGHLIGHT.
	     PERFORM CHECK-CORRECT.
006160	   IF WS-OPTION = "N"
               CLOSE SECUR
006170         GO TO AD05.
	     MOVE SEC-COMP	 TO WS-COMPANY.
	     MOVE SEC-SYS	 TO APAC-SYSTEM WS-APAC-SYSTEM.
	   IF NOT (SEC-VER = "8.00" OR "8.01" OR "8.02"
			  OR "2001" OR "2002" OR "2003"
			  OR "2004" OR "2005" OR "2006")
	       PERFORM APAC-SETUP-PATHS.
	   IF NOT (SEC-VER = "2006")
	       MOVE "2006"	 TO SEC-VER
008570	       REWRITE SEC-REC2.
	     MOVE SEC-VER	 TO APAC-VERSION WS-APAC-VERSION.
006180	     DISPLAY CLEAR-L25.
	     MOVE 40		 TO WS-S1.

       AD005B.
           IF WS-COMPCHR (WS-S1) = SPACE
               MOVE WS-G8        TO WS-COMPCHR (WS-S1)
               IF WS-S1 > 1
                   SUBTRACT 1    FROM WS-S1
                   GO TO AD005B.
             MOVE WS-COMPANY     TO WS-TOP-COMP.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	      G E T   O P E R A T O R	N U M B E R	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
006630 AD05B.
006640       DISPLAY S11.

006650 AD05U.
006660	     MOVE WS-SYS-ID	 TO WS-USER.
006670       ACCEPT S12.
006680	     MOVE 3		 TO WS-LENGTH.
	     CALL "CBL_TOUPPER" USING WS-USER
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
006740	     MOVE 1		 TO WS-LENGTH.
006750	     MOVE SEC-PMODS	 TO WS0-PMODS.
	   IF WS-USER = WS-SYS-ID
	       MOVE "Supervisorฤ"
				 TO WS-WRKHD
	   ELSE
	       MOVE "Workstation"
				 TO WS-WRKHD
	       MOVE WS-USER	 TO WS-WRKST.
             MOVE SEC-DEM        TO WS-DEM.
006790	   IF (SEC-DTP NOT = 2) AND (SEC-STP NOT = 2) AND
006800        (SEC-CRP NOT = 2) AND (SEC-GLP NOT = 2) AND
006810        (SEC-POS NOT = 2) AND (SEC-HPD NOT = 2) AND
006820        (SEC-JCP NOT = 2) AND (SEC-VHP NOT = 2)
               MOVE "LPT1"       TO W02-PRINTER
006830         GO TO AD08.
006840       OPEN I-O PARAM.
006850	   IF RUNTIME-ERROR
	       IF FLE-LOCKED
006860		   DISPLAY "Files locked - try later - Press ENTER"
			    AT 2312
006870			    WITH FOREGROUND-COLOR 14 "   " WS-PARID
006880		   ACCEPT WS-OPTION AT 2351
			  WITH FOREGROUND-COLOR 15 AUTO
006890		   STOP RUN.
006900       MOVE 2              TO WS-INIT.
006910     IF WS-STATUS NOT = "00"
006920         GO TO AD06.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		CHECK IF LAST RUN ENDED CORRECTLY	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
006930	     MOVE 4		 TO WS-PARKEY.

006940 AD05-PAR.
006950       READ PARAM LOCK.
006960     IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980             GO TO AD05-PAR.
006990     IF PAR-USERS = 0
007020	       MOVE 1		 TO WS-PAR PAR-LOGON
007030         GO TO AD07U.
007040	     MOVE 1		 TO WS-S1.
007050	     MOVE 0		 TO WS-S2 WS-S3.

007060 AD05-CHECK.
007070	   IF PAR-USR(WS-S1) = WS-USER
007080	       IF PAR-PROG(WS-S1) = SPACES
007090		   MOVE SPACES	 TO PAR-USR (WS-S1)
		   SUBTRACT 1	 FROM PAR-USERS
007100         ELSE
007120             GO TO AD06.
007160     IF WS-S1 < 24
007170	       ADD 1		 TO WS-S1
007180         GO TO AD05-CHECK.
007270	     MOVE 1		 TO PAR-LOGON.
007280       GO TO AD07U.

007290 AD06.
	     DISPLAY CLR-SCREEN.
007300	     DISPLAY "Last run not ended off correctly" AT 0814
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT.
007320     IF PAR-PROG (WS-S1) = "99"
007330	       DISPLAY "Reload files and redo any updating done since la
      - 	       "st BACKUP" AT 1014 WITH BACKGROUND-COLOR 7
			FOREGROUND-COLOR 4 HIGHLIGHT
007350         STOP RUN.
007360	     DISPLAY "Recovery procedure will now be initiated" AT 1014
		      WITH FOREGROUND-COLOR 6 HIGHLIGHT.
007380	     DISPLAY "Press ANY key to continue" AT 1214
		      WITH FOREGROUND-COLOR 6 HIGHLIGHT.

007400 AD07.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.
007500	     MOVE 9		 TO WS-PAR.
007510       UNLOCK PARAM.
007520	     GO TO AD99.

007530 AD07U.
007540       REWRITE PAR-RECORD4.
007550       UNLOCK PARAM.

       AD07W.
             MOVE 1              TO WS-PARKEY.
006950       READ PARAM.
006960     IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980             GO TO AD07W.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ C H E C K	 I F   D E M O N S T R A T I O N   S Y S T E M ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	   IF (SEC-DEM = 1) OR (PAR-STAT = 1)
               IF SEC-COUNT < 75
		   PERFORM AD15
               END-IF
           ELSE
               MOVE ZERO         TO SEC-COUNT.
             MOVE SEC-COUNT      TO WS-DAYS.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		 C H E C K   F O R   E X P I R Y	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	   IF SEC-COUNT > 65
               COMPUTE WS-NUM = 15 - (WS-DAYS - 65)
               DISPLAY "This package must be registered within" AT 2502
			WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 12
			WS-NUM WITH
			BACKGROUND-COLOR 3 FOREGROUND-COLOR 15 BLINK
		       " days"
			WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 12.

       AD07X.
	     MOVE 3		 TO WS-PARKEY.
006950	     READ PARAM.
006960     IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980             GO TO AD07X.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ  A D D I T I O N A L   S E C U R I T Y   I N C L U D E D  ณ
      *    ณ	      ( ---TRYING TO CUT DOWN ON PIRACY--- )	       ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ	    New Systems - already correct		       ณ
      *    ณ	    (This ROUTINE updating older versions)	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	   IF NOT (PAR-VER = "2006")
	       MOVE "2006"	 TO PAR-VER
007540	       REWRITE PAR-RECORD3.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	  S E R I A L	N U M B E R   A N D   S Y S T E M      ณ
      *    ณ	  F R O M   P A R A M E T E R	F I L E 	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE PAR-LEV	 TO WS-LEV.
	     MOVE PAR-SERIAL	 TO WS-SERIAL.
	     MOVE PAR-CUR-YR	 TO WS-CUR-YR.
	     MOVE PAR-CUR-CEN	 TO WS-CUR-CEN.
	     MOVE PAR-PRV-CEN	 TO WS-PRV-CEN.
	     MOVE PAR-NXT-CEN	 TO WS-NXT-CEN.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	S U P E R V I S O R   P R I N T E R   D E T A I L S    ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 110		 TO WS-USUB.
014240	     ADD 2549 WS-USUB	 GIVING W25-RESULT.
             MOVE W25-KEY        TO WS-PARKEY.
             ADD 1 W25-SUB       GIVING WS-S6.
006950	     READ PARAM.
006960     IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980             GO TO AD07X.
	     ADD 501 TRM-PRN4 (WS-S6)
                                 GIVING WS-SUB-6.
           IF TRM-STDP (WS-S6) = 1
               MOVE "LPT1"       TO W02-PRINTER
           ELSE
           IF TRM-STDP (WS-S6) = 2
               MOVE "LPT2"       TO W02-PRINTER
           ELSE
           IF TRM-STDP (WS-S6) = 3
               MOVE "LPT3"       TO W02-PRINTER
           ELSE
           IF TRM-STDP (WS-S6) = 4
               MOVE "COM1"       TO W02-PRINTER
           ELSE
           IF TRM-STDP (WS-S6) = 5
               MOVE "COM2"       TO W02-PRINTER
           ELSE
           IF TRM-STDP (WS-S6) = 9
	       MOVE LS-USER	 TO W02-USER.
	     ADD 501 TRM-PRN3 (WS-S6)
                                 GIVING W25-RESULT.
             DIVIDE W25-RESULT BY 2
                                 GIVING WS-PARKEY
                                 REMAINDER WS-S6.
             ADD 1               TO WS-S6.
	     READ PARAM.
006960	   IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980             GO TO AD07X.
	     MOVE TRM-LENGTH (WS-S6)
				 TO WS-PRN-LENGTH.
	     MOVE TRM-PAGE (WS-S6)
				 TO WS-PGE-LENGTH.

007560 AD08.
007570	     MOVE 1		 TO WS-SECKEY.
007580       READ SECUR.
007590     IF RUNTIME-ERROR
007600         IF RECORD-LOCKED
007610             GO TO AD08.
007620     IF WS-STATUS NOT = "00"
007630	       MOVE "Disk error - AD08"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
007640         STOP RUN.
007650	     MOVE 1		 TO WS-S1.

007660 AD10.
007670	     MOVE SEC-ASCII (WS-S1)
				 TO W15-ASCII (WS-S1).
007680     IF WS-S1 < 256
007690	       ADD 1		 TO WS-S1
007700         GO TO AD10.
	     MOVE 5		 TO WS-PARKEY.

       AD12.
006950	     READ PARAM.
006960	   IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980		   GO TO AD12.
	   IF NOT (PAR-BC = "Y")
	       MOVE "Y" 	 TO PAR-BC
	       MOVE 80		 TO PAR-BC-HGHT
	       MOVE 4		 TO PAR-COLUMN
	       MOVE 45		 TO PAR-ROW
	       MOVE 2		 TO PAR-NAR
	       MOVE 2		 TO PAR-WIDE
	       MOVE 2		 TO PAR-FONT
	       MOVE 160 	 TO PAR-F-ROW
	       MOVE ZERO	 TO PAR-F-COLUMN
	       MOVE 125 	 TO PAR-F-ROW2
	       MOVE ZERO	 TO PAR-F-COL2
	       MOVE "Y" 	 TO PAR-SPLIT
007540	       REWRITE PAR-RECORD5.
	     GO TO AD99.
       AD15.
             MOVE W12-T-YMD      TO WS-DTE.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ  N U M B E R   O F   D A Y S   F R O M   S T A R T   O F  ณ
      *    ณ  P R E V I O U S	C E N T U R Y	-   D A T E   1        ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     COMPUTE W31-DTE1 = (W12-CY - (WS-PRV-CEN*100)) * 365.25.
             ADD W31-NO (W12-MM) TO W31-DTE1.
             ADD W12-DD          TO W31-DTE1.
             MOVE WS-DTE         TO W12-T-YMD.
           IF W12-T-YMD < SEC-INITIAL
               MOVE W12-T-YMD    TO SEC-INITIAL.
             MOVE SEC-INITIAL    TO W20-DTE.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ  N U M B E R   O F   D A Y S   F R O M   S T A R T   O F  ณ
      *    ณ  P R E V I O U S	C E N T U R Y	-   D A T E   2        ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     COMPUTE W31-DTE2 = (W20-CY - (WS-PRV-CEN*100)) * 365.25.
             ADD W31-NO (W20-MM) TO W31-DTE2.
             ADD W20-DD          TO W31-DTE2.
           IF (W31-DTE1 - W31-DTE2) < 75
               SUBTRACT W31-DTE2 FROM W31-DTE1
                                 GIVING SEC-COUNT
           ELSE
               MOVE 75           TO SEC-COUNT.
008570       REWRITE SEC-REC2.

       AD99.
	     EXIT.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ   N E T W O R K   D R I V E   N O T   A V A I L A B L E   ณ
      *    ณ   M U S T	 S Y S T E M   R U N   O F F - L I N E	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
       AD100	       SECTION 50.
       AD105.
	     PERFORM SAVE-SCREEN-3.
	     DISPLAY "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ"
		     AT 1120 WITH FOREGROUND-COLOR 0
				  BACKGROUND-COLOR 5
		     "ฟ" WITH FOREGROUND-COLOR 5 HIGHLIGHT
			      BACKGROUND-COLOR 5.
	     DISPLAY "ณ" AT 1220 WITH FOREGROUND-COLOR 0
				      BACKGROUND-COLOR 5
		     "Network files not available at present!"
		     WITH FOREGROUND-COLOR 3 HIGHLIGHT
			  BACKGROUND-COLOR 5
		     "ณ" WITH FOREGROUND-COLOR 5 HIGHLIGHT
			      BACKGROUND-COLOR 5.
	     DISPLAY "ณ" AT 1320 WITH FOREGROUND-COLOR 0
				      BACKGROUND-COLOR 5
		     "Work off-line (Y/N)                    "
		      WITH FOREGROUND-COLOR 3 HIGHLIGHT
			   BACKGROUND-COLOR 5
		     "ณ" WITH FOREGROUND-COLOR 5 HIGHLIGHT
			      BACKGROUND-COLOR 5.
	     DISPLAY "ภ" AT 1420 WITH FOREGROUND-COLOR 0
				      BACKGROUND-COLOR 5
		     "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู"
		      WITH FOREGROUND-COLOR 5 HIGHLIGHT
			   BACKGROUND-COLOR 5.
	     MOVE 12		 TO SHADE-ROW.
	     MOVE 22		 TO SHADE-COL.
	     MOVE 40		 TO SHADE-WIDTH.
	     MOVE 3		 TO SHADE-LINES.
	     PERFORM SCREEN-SHADOW.
	     MOVE "N"		 TO WS-OPTION.

       AD110.
	     ACCEPT WS-OPTION AT 1341
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 5 UPDATE AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	   IF NOT (WS-OPTION = "N" OR "Y")
	       GO TO AD110.
	     PERFORM RESTORE-SCREEN-3.

007710 AD199.
007720	     EXIT.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	       F I L E S   N O T   A V A I L A B L E	       ณ
      *    ณ  Check if this is a Network and if off-line files exist.  ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
       AD200	       SECTION 50.
       AD205.
	     MOVE ZERO		 TO WS-ERROR.
	     MOVE "OFFLINE\"     TO W02-N-OR-L.
	     MOVE WS-SYS-ID	 TO W02-SYSPTH.
	     CALL "CBL_CHECK_FILE_EXIST" USING W02-APACFILE
					       FILE-DETAILS
				     RETURNING WS-STATUS.
	   IF WS-STAT1H = 1
	       MOVE 9		 TO WS-ERROR.
	     MOVE "SYSTEMS\"     TO W02-N-OR-L.

007710 AD999.
007720       EXIT.
      /    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		 O F F L I N E	 L O C A T I O N S	       ณ
      *    ณThis routine inserted from version 8.07 and sets up the    ณ
      *    ณoffline directory and locations if it has not been created.ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
007730 AE000                   SECTION 51.
007740 AE00.
007750       DISPLAY CLR-SCREEN.
007760	     DISPLAY S13.

008090 AE05.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.
	     MOVE "OFFLINE\"     TO W02-L-OR-N
				    W02-N-OR-L.
	     MOVE WS-SYS-ID	 TO W02-SYSPTH.
	     MOVE ZERO		 TO WS-ERROR.
	     CALL "CBL_CHECK_FILE_EXIST" USING W02-APACFILE
					       FILE-DETAILS
				     RETURNING WS-STATUS.
	   IF WS-STAT1H = ZERO
	       MOVE "Off-line locations exist"
				 TO WS-ERR-STRING
	       PERFORM ERROR-MESSAGE
	       GO TO AE999.
	     CALL "CBL_CREATE_DIR" USING W02-OFFLINE
			       RETURNING WS-STATUS.
	     PERFORM OFFLFILES.
	     PERFORM OFFL-SETUP-PATHS.
	     MOVE "Off-line locations created"
				 TO WS-ERR-STRING.
	     PERFORM ERROR-MESSAGE.
	     MOVE "SYSTEMS\"     TO W02-L-OR-N
				    W02-N-OR-L.
008620 AE999.
008630       EXIT.
      *    *************************************************************
      *     C R E A T E	  O F F L I N E	  F I L E S   L O C A T I O N S
      *    *************************************************************
       OFFLFILES       SECTION 52.
       OFFL-FILES-INIT.
	     MOVE WS-SYS-ID	 TO W02-SYSPTH.
	     OPEN OUTPUT APACFILE.
	     CLOSE APACFILE.
	     PERFORM OFFL-CREATE-NEW THRU OFFL-CREATE-NEW-EXIT.
	     CLOSE APACFILE.
	     GO TO OFFLFILES-EXIT.

       OFFL-CREATE-NEW.
	     OPEN I-O APACFILE.
      *    *************************************************************
      *    A S S E T T	 F I L E  -  F U T U R E   D E V E L O P M E N T
      *    *************************************************************
	     MOVE "ASSETT"	 TO APAC-KEY.
	     MOVE "ASSETT.DAT"	 TO APAC-NAME.
	     MOVE 11		 TO APAC-FILE.
	     MOVE SPACES	 TO APAC-PATH.
	     STRING WS-SYS-ID DELIMITED SIZE
		    "_DATA\" DELIMITED SIZE
		    INTO APAC-PATH.

       OFFL-WRITE-APACFILE.
	     WRITE APAC-RECORD1.

       OFFL-DATA-FILES.
      *    *************************************************************
      *    **** 	D A I L Y   -	A U D I T   F I L E	    ****
      *    *************************************************************
	     MOVE "AUDITF"	 TO APAC-KEY.
	     MOVE "AUDIT.DAT"	 TO APAC-NAME.
	     MOVE 16		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ** B A R C O D E   L A B E L S   T O	  B E	P R I N T E D **
      *    *************************************************************
	     MOVE "BARCOD"	 TO APAC-KEY.
	     MOVE "BARCODE.DAT"	 TO APAC-NAME.
	     MOVE 57		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****    P U R C H A S E S   -   C A R D E X	 F I L E    ****
      *    *************************************************************
	     MOVE "PURDEX"	 TO APAC-KEY.
	     MOVE "CARDEXPR.DAT" TO APAC-NAME.
	     MOVE 56		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****       S A L E S	  -   C A R D E X   F I L E	    ****
      *    *************************************************************
	     MOVE "CARDEX"	 TO APAC-KEY.
	     MOVE "CARDEXSL.DAT" TO APAC-NAME.
	     MOVE 43		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    C A T A L O G U E   I T E M S   F I L E - F U T U R E   D E V
      *    *************************************************************
	     MOVE "CATITM"	 TO APAC-KEY.
	     MOVE "CATITM.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    C A T A L O G U E   F I L E	 -   F U T U R E   D E V E L O P
      *    *************************************************************
	     MOVE "CATLOG"	 TO APAC-KEY.
	     MOVE "CATLOG.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****      C H E Q U E S   R E C E I V E D   F I L E	    ****
      *    *************************************************************
	     MOVE "CHEQUE"	 TO APAC-KEY.
	     MOVE "CHEQUE.DAT"	 TO APAC-NAME.
	     MOVE 36		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    C H E Q U E S   B A T C H   F I L E	-  C R E D I T O R S  AP
      *    *************************************************************
	     MOVE "CHQBATCH"	 TO APAC-KEY.
	     MOVE "CHQBCH.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    C H E Q U E S   B A T C H   F I L E	-  G / L  -  C U R R  D.
      *    *************************************************************
	     MOVE "CHQBCH"	 TO APAC-KEY.
	     MOVE "CHQBCH_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	    C O N T R O L   F I L E		    ****
      *    *************************************************************
	     MOVE "NETWORK"	 TO APAC-KEY.
	     MOVE "CONTROL.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****   ( A / P )   C R E D I T O R	M E M O	  F I L E   ****
      *    *************************************************************
	     MOVE "CRDMEM"	 TO APAC-KEY.
	     MOVE "AP_MEMO.DAT"	 TO APAC-NAME.
	     MOVE 6		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    *** C R E D I T O R	 A C C O U N T	 ( A / P )   F I L E ***
      *    *************************************************************
	     MOVE "CREDIT"	 TO APAC-KEY.
	     MOVE "AP_ACNT.DAT"	 TO APAC-NAME.
	     MOVE 7		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ( A / P )   C R E D I T O R	 T R A N S A C T I O N	 F I L E
      *    *************************************************************
	     MOVE "CRTRAN"	 TO APAC-KEY.
	     MOVE "AP_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 8		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *     C A S H   B O O K	F I L E  -  F U T U R E   D E V E L O P
      *    *************************************************************
	     MOVE "CSBOOK"	 TO APAC-KEY.
	     MOVE "CSBOOK.DAT"	 TO APAC-NAME.
	     MOVE 29		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *     C A S H   B O O K	T R A N S A C T   F I L E - F U T U R E
      *    *************************************************************
	     MOVE "CSTRAN"	 TO APAC-KEY.
	     MOVE "CSTRAN.DAT"	 TO APAC-NAME.
	     MOVE 30		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****      D E B T O R   C O N T R A C T S   F I L E	    ****
      *    *************************************************************
	     MOVE "DBFOTO"	 TO APAC-KEY.
	     MOVE "AR_CONT.DAT"	 TO APAC-NAME.
	     MOVE 3		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****    D E B T O R	 T R A N S A C T I O N	 F I L E    ****
      *    *************************************************************
	     MOVE "DBTRAN"	 TO APAC-KEY.
	     MOVE "AR_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 4		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****    D E B T O R	 C O L L E C T I O N S	 F I L E    ****
      *    *************************************************************
	     MOVE "DEBCOL"	 TO APAC-KEY.
	     MOVE "AR_COL.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****        D E B T O R   H I S T O R Y   F I L E	    ****
      *    *************************************************************
	     MOVE "DEBHIS"	 TO APAC-KEY.
	     MOVE "AR_HIST.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****     ( A / R )	D E B T O R   M E M O	F I L E	    ****
      *    *************************************************************
	     MOVE "DEBMEM"	 TO APAC-KEY.
	     MOVE "AR_MEMO.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *     D E B T O R	  O R D E R   F I L E	-  C U R R E N T   D E V
      *    *************************************************************
	     MOVE "DEBORD"	 TO APAC-KEY.
	     MOVE "AR_ORD.DAT"	 TO APAC-NAME.
	     MOVE 53		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	   D E B T O R	 G / P	 F I L E	    ****
      *    *************************************************************
	     MOVE "DEBPRF"	 TO APAC-KEY.
	     MOVE "DEBPRF.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****  D E B T O R   A C C O U N T   ( A / R )   F I L E  ****
      *    *************************************************************
	     MOVE "DEBTOR"	 TO APAC-KEY.
	     MOVE "AR_ACNT.DAT"	 TO APAC-NAME.
	     MOVE 2		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	   D E P A R T M E N T	 F I L E	    ****
      *    *************************************************************
	     MOVE "DEPART"	 TO APAC-KEY.
	     MOVE "DEPART.DAT"	 TO APAC-NAME.
	     MOVE 38		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *     E G G   S A L E S	F I L E   -   E G G   P R O D U C E R S
      *    *************************************************************
	     MOVE "EGGSLE"	 TO APAC-KEY.
	     MOVE "EGGSLE.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    *** G E N E R A L   L E D G E R   A C C O U N T   F I L E ***
      *    *************************************************************
	     MOVE "GACCNT"	 TO APAC-KEY.
	     MOVE "GL_ACNT.DAT"	 TO APAC-NAME.
	     MOVE 12		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	    G U A R A N T E E	F I L E		    ****
      *    *************************************************************
	     MOVE "GARTEE"	 TO APAC-KEY.
	     MOVE "GARTEE.DAT"	 TO APAC-NAME.
	     MOVE 9		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *     G E N E R A L   L E D G   B A T C H   H E A D E R	F I L E
      *    *************************************************************
	     MOVE "GLBHDR"	 TO APAC-KEY.
	     MOVE "GL_BHDR.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    G / L   J O U R N A L S   B A T C H	 T R A N S A C T I O N S
      *    *************************************************************
	     MOVE "GLBTCH"	 TO APAC-KEY.
	     MOVE "GLBTCH_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *     G / L   C H E Q U E S   B A T C H	T R A N S A C T I O N S
      *    *************************************************************
	     MOVE "GLCHEQ"	 TO APAC-KEY.
	     MOVE "GLCHEQ_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    G / L   D E P O S I T S   B A T C H	 T R A N S A C T I O N S
      *    *************************************************************
	     MOVE "GLDEPO"	 TO APAC-KEY.
	     MOVE "GLDEPO_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****	G / L	R E C U R R I N G   T R A N S A C T I O N S ****
      *    *************************************************************
	     MOVE "GLINST"	 TO APAC-KEY.
	     MOVE "GL_INST.DAT"	 TO APAC-NAME.
	     MOVE 15		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    G E N E R A L   L E D G E R	 T R A N S A C T I O N	 F I L E
      *    *************************************************************
	     MOVE "GLTRAN"	 TO APAC-KEY.
	     MOVE "GL_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 13		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    *** G / L   P O S T	 D A T E D   C H E Q U E S   F I L E ***
      *    *************************************************************
	     MOVE "GPDCHQ"	 TO APAC-KEY.
	     MOVE "GL_PDCHQ.DAT" TO APAC-NAME.
	     MOVE 45		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****  ( A / R )   D E B T O R   I N V O I C E  F I L E   ****
      *    *************************************************************
	     MOVE "INVOIC"	 TO APAC-KEY.
	     MOVE "INVOICE.DAT"	 TO APAC-NAME.
	     MOVE 22		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "ITEMS"	 TO APAC-KEY.
	     MOVE "ITEMS.DAT"	 TO APAC-NAME.
	     MOVE 57		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JCHIST"	 TO APAC-KEY.
	     MOVE "JCHIST.DAT"	 TO APAC-NAME.
	     MOVE 58		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** J O B	C O S T I N G	-   D E T A I L S   F I L E ****
      *    *************************************************************
	     MOVE "JOBCST"	 TO APAC-KEY.
	     MOVE "JOBLIN.DAT"	 TO APAC-NAME.
	     MOVE 25		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JOBAUD"	 TO APAC-KEY.
	     MOVE "JOBAUD.DAT"	 TO APAC-NAME.
	     MOVE 24		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JCLINE"	 TO APAC-KEY.
	     MOVE "JCLINE.DAT"	 TO APAC-NAME.
	     MOVE 59		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****	 J O B	 C O S T I N G	 -   H E A D E R   F I L E  ****
      *    *************************************************************
	     MOVE "JOBHDR"	 TO APAC-KEY.
	     MOVE "JOBHDR.DAT"	 TO APAC-NAME.
	     MOVE 21		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *     J O B   C O S T I N G   -	R E Q U I S I T I O N	F I L E
      *    *************************************************************
	     MOVE "JOBREQ"	 TO APAC-KEY.
	     MOVE "JOBREQ.DAT"	 TO APAC-NAME.
	     MOVE 26		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ***	J O B	C O S T I N G	-   R E M A R K S   F I L E  ***
      *    *************************************************************
	     MOVE "JOBRMK"	 TO APAC-KEY.
	     MOVE "JOBRMK.DAT"	 TO APAC-NAME.
	     MOVE 27		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JOBSTAT"	 TO APAC-KEY.
	     MOVE "JOBSTAT.DAT"	 TO APAC-NAME.
	     MOVE 60		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JOBTECH"	 TO APAC-KEY.
	     MOVE "JOBTECH.DAT"	 TO APAC-NAME.
	     MOVE 61		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JOBWAR"	 TO APAC-KEY.
	     MOVE "JOBWAR.DAT"	 TO APAC-NAME.
	     MOVE 28		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	  I N T E G R A T I O N	  F I L E	    ****
      *    *************************************************************
	     MOVE "LEDTRF"	 TO APAC-KEY.
	     MOVE "LEDTRF.DAT"	 TO APAC-NAME.
	     MOVE 40		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    I N T E G R A T I O N   F I L E   (C R E D I T O R S   G / L)
      *    *************************************************************
	     MOVE "LEDTRG"	 TO APAC-KEY.
	     MOVE "LTRG_XXX.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	  P A R A M E T E R   F I L E		    ****
      *    *************************************************************
	     MOVE "PARAM"	 TO APAC-KEY.
	     MOVE "PARAM.DAT"	 TO APAC-NAME.
	     MOVE 1		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PDCHEQ"	 TO APAC-KEY.
	     MOVE "PDCHEQ.DAT"	 TO APAC-NAME.
	     MOVE 44		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	P I C K I N G	S L I P   F I L E	    ****
      *    *************************************************************
	     MOVE "PICSLIP"	 TO APAC-KEY.
	     MOVE "PICSLP.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****        P U R C H A S E	 O R D E R   F I L E	    ****
      *    *************************************************************
	     MOVE "PORDER"	 TO APAC-KEY.
	     MOVE "PORDER.DAT"	 TO APAC-NAME.
	     MOVE 10		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	   P L U   C O D E S   F I L E		    ****
      *    *************************************************************
	     MOVE "POSPLU"	 TO APAC-KEY.
	     MOVE "POSPLU.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    R O U T E   F I L E	 -   C U R R E N T   D E V E L O P M E N
      *    *************************************************************
	     MOVE "ROUTE"	 TO APAC-KEY.
	     MOVE "ROUTE.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	     P O S   S L I P S	 F I L E	    ****
      *    *************************************************************
	     MOVE "PSLIPS"	 TO APAC-KEY.
	     MOVE "PSLIPS.DAT"	 TO APAC-NAME.
	     MOVE 35		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****      N E T W O R K   (S H A R E D)   F I L E	    ****
      *    *************************************************************
	     MOVE "SHARED"	 TO APAC-KEY.
	     MOVE "SHARED.DAT"	 TO APAC-NAME.
	     MOVE 33		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	   S A L E S   O R D E R   F I L E	    ****
      *    *************************************************************
	     MOVE "SORDER"	 TO APAC-KEY.
	     MOVE "SORDER.DAT"	 TO APAC-NAME.
	     MOVE 17		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *	   *************************************************************
      *    *** S T O C K   ( I V E N T O R Y )	 P A R T S   F I L E ***
      *    *************************************************************
	     MOVE "SPARTS"	 TO APAC-KEY.
	     MOVE "IN_PARTS.DAT" TO APAC-NAME.
	     MOVE 20		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "STKDEX"	 TO APAC-KEY.
	     MOVE "IN_ADJ.DAT"	 TO APAC-NAME.
	     MOVE 46		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ***	S T O C K   ( I V E N T O R Y )   M E M O   F I L E  ***
      *    *************************************************************
	     MOVE "STKMEM"	 TO APAC-KEY.
	     MOVE "IN_MEMO.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****      S T O C K	 ( I V E N T O R Y )   F I L E	    ****
      *    *************************************************************
	     MOVE "STOCKF"	 TO APAC-KEY.
	     MOVE "INVENT.DAT"	 TO APAC-NAME.
	     MOVE 5		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "SYSTEM"	 TO APAC-KEY.
	     MOVE "SYSTEM.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 		U S E R S   F I L E		    ****
      *    *************************************************************
	     MOVE "SYSUSE"	 TO APAC-KEY.
	     MOVE "USERS.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "TERMINAL"	 TO APAC-KEY.
	     MOVE "TRMNAL.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "TRFRIN"	 TO APAC-KEY.
	     MOVE "TRFRIN.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "TRFOUT"	 TO APAC-KEY.
	     MOVE "TRFOUT.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****       V A L U E	  A D D E D   T A X   F I L E	    ****
      *    *************************************************************
	     MOVE "TXTRAN"	 TO APAC-KEY.
	     MOVE "TX_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 19		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "UNTSLE"	 TO APAC-KEY.
	     MOVE "UNTSLE.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "VEHICLE"	 TO APAC-KEY.
	     MOVE "VEHICLE.DAT"	 TO APAC-NAME.
	     MOVE 54		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "VSTOCK"	 TO APAC-KEY.
	     MOVE "V_INVENT.DAT" TO APAC-NAME.
	     MOVE 55		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	    W A R E H O U S E	F I L E		    ****
      *    *************************************************************
	     MOVE "WARHSE"	 TO APAC-KEY.
	     MOVE "WARHSE.DAT"	 TO APAC-NAME.
	     MOVE 51		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    W A R E H O U S E  -  S T O C K  ( I V E N T O R Y )  F I L E
      *    *************************************************************
	     MOVE "WSTOCK"	 TO APAC-KEY.
	     MOVE "W_INVENT.DAT" TO APAC-NAME.
	     MOVE 52		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.

       OFFL-WORK-FILES.
	     MOVE "BULKST"	 TO APAC-KEY.
	     MOVE "BULK_XXX.WRK" TO APAC-NAME.
	     MOVE 59		 TO APAC-FILE.
	     MOVE SPACES	 TO APAC-PATH.
	     STRING WS-SYS-ID DELIMITED SIZE
		    "_WORK\" DELIMITED SIZE
		    INTO APAC-PATH.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****   P U R C H A S E   O R D E R	W O R K	  F I L E   ****
      *    *************************************************************
	     MOVE "CORDER"	 TO APAC-KEY.
	     MOVE "CORD_XXX.WRK" TO APAC-NAME.
	     MOVE 48		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "CRETRN"	 TO APAC-KEY.
	     MOVE "CTRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DBTCON"	 TO APAC-KEY.
	     MOVE "DCON_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DPTSALES"	 TO APAC-KEY.
	     MOVE "DSAL_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DEBTEX"	 TO APAC-KEY.
	     MOVE "DBEX_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DEBTOT"	 TO APAC-KEY.
	     MOVE "DTOT_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DEBTRN"	 TO APAC-KEY.
	     MOVE "DTRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DRBTCH"	 TO APAC-KEY.
	     MOVE "DBCH_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "GLBATCH"	 TO APAC-KEY.
	     MOVE "GBAL_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **	 G / L	 T R A N S A C T I O N	 W O R K   F I L E    **
      *    *************************************************************
	     MOVE "GLJRN"	 TO APAC-KEY.
	     MOVE "GJRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **	 G / L	 T R A N S A C T I O N	 W O R K   F I L E    **
      *    *************************************************************
	     MOVE "GLTRNB"	 TO APAC-KEY.
	     MOVE "GTRB_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "INVSAL"	 TO APAC-KEY.
	     MOVE "INVS_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "LEDTRN"	 TO APAC-KEY.
	     MOVE "LTRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "MEMDEB"	 TO APAC-KEY.
	     MOVE "DEBM_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "MOVEMT"	 TO APAC-KEY.
	     MOVE "MOVM_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PERFRM"	 TO APAC-KEY.
	     MOVE "PERF_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PRCLAB"	 TO APAC-KEY.
	     MOVE "PLAB_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PRNDISK"	 TO APAC-KEY.
	     MOVE "PRNT_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PURCH"	 TO APAC-KEY.
	     MOVE "PURC_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "RECEIPTS"	 TO APAC-KEY.
	     MOVE "RECP_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 	    R E C O V E R Y   F I L E		    ****
      *    *************************************************************
	     MOVE "RECOVER"	 TO APAC-KEY.
	     MOVE "RECV_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    **** 		S A L E S   F I L E		    ****
      *    *************************************************************
	     MOVE "SALE"	 TO APAC-KEY.
	     MOVE "SALE_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
      *    *************************************************************
      *    ****    S A L E S   F I L E	-  J O B   C O S T I N G    ****
      *    *************************************************************
	     MOVE "SALEJ"	 TO APAC-KEY.
	     MOVE "SALJ_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "SALESMAN"	 TO APAC-KEY.
	     MOVE "SMAN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "SALESTRK"	 TO APAC-KEY.
	     MOVE "STRK_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "STKORD"	 TO APAC-KEY.
	     MOVE "STKO_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "STKSEL"	 TO APAC-KEY.
	     MOVE "STKS_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "STKWRK"	 TO APAC-KEY.
	     MOVE "STOT_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.

       OFFL-OLD-FILES.
	     MOVE SPACES	 TO APAC-PATH.
	     STRING WS-SYS-ID DELIMITED SIZE
		    "_DATA\" DELIMITED SIZE
		    INTO APAC-PATH.
	     MOVE "ASSOLD"	 TO APAC-KEY.
	     MOVE "ASSETT.OLD"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "CAROLD"	 TO APAC-KEY.
	     MOVE "CARDEXSL.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "CHQBHOLD"	 TO APAC-KEY.
	     MOVE "CHQBCH_1.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "CHQOLD"	 TO APAC-KEY.
	     MOVE "CHEQUE.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "CREOLD"	 TO APAC-KEY.
	     MOVE "AP_ACNT.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "CRMOLD"	 TO APAC-KEY.
	     MOVE "AP_MEMO.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "CRTOLD"	 TO APAC-KEY.
	     MOVE "AP_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DBFOLD"	 TO APAC-KEY.
	     MOVE "AR_CONT.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DBMOLD"	 TO APAC-KEY.
	     MOVE "AR_MEMO.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DBTOLD"	 TO APAC-KEY.
	     MOVE "AR_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DEBOLD"	 TO APAC-KEY.
	     MOVE "AR_ACNT.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "DEPOLD"	 TO APAC-KEY.
	     MOVE "DEPART.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "GACOLD"	 TO APAC-KEY.
	     MOVE "GL_ACNT.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "GAROLD"	 TO APAC-KEY.
	     MOVE "GARTEE.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "GBHOLD"	 TO APAC-KEY.
	     MOVE "GL_BHDR.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "GLBOLD"	 TO APAC-KEY.
	     MOVE "GLBTCH_1.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "GPDOLD"	 TO APAC-KEY.
	     MOVE "GL_PDCHQ.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "GTROLD"	 TO APAC-KEY.
	     MOVE "GL_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "INVOLD"	 TO APAC-KEY.
	     MOVE "INVOICE.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "ITMOLD"	 TO APAC-KEY.
	     MOVE "ITEMS.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JAUOLD"	 TO APAC-KEY.
	     MOVE "JOBAUD.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JHDOLD"	 TO APAC-KEY.
	     MOVE "JOBHDR.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JHSOLD"	 TO APAC-KEY.
	     MOVE "JCHIST.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JOBOLD"	 TO APAC-KEY.
	     MOVE "JOBLIN.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JRMOLD"	 TO APAC-KEY.
	     MOVE "JOBRMK.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JRQOLD"	 TO APAC-KEY.
	     MOVE "JOBREQ.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JSTOLD"	 TO APAC-KEY.
	     MOVE "JOBSTAT.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JTCOLD"	 TO APAC-KEY.
	     MOVE "JOBTECH.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "JWAOLD"	 TO APAC-KEY.
	     MOVE "JOBWAR.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "LEDOLD"	 TO APAC-KEY.
	     MOVE "LEDTRF.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PDCOLD"	 TO APAC-KEY.
	     MOVE "PDCHEQ.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PRDOLD"	 TO APAC-KEY.
	     MOVE "CARDEXPR.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "PUROLD"	 TO APAC-KEY.
	     MOVE "PORDER.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "SLPOLD"	 TO APAC-KEY.
	     MOVE "PSLIPS.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "SOROLD"	 TO APAC-KEY.
	     MOVE "SORDER.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "SPAOLD"	 TO APAC-KEY.
	     MOVE "IN_PARTS.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "STKOLD"	 TO APAC-KEY.
	     MOVE "INVENT.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "STMOLD"	 TO APAC-KEY.
	     MOVE "IN_MEMO.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "STXOLD"	 TO APAC-KEY.
	     MOVE "IN_ADJ.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "TXTOLD"	 TO APAC-KEY.
	     MOVE "TX_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "UNTOLD"	 TO APAC-KEY.
	     MOVE "UNTSLE.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "VEHOLD"	 TO APAC-KEY.
	     MOVE "VEHICLE.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "VSTOLD"	 TO APAC-KEY.
	     MOVE "V_INVENT.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "WAROLD"	 TO APAC-KEY.
	     MOVE "WARHSE.OLD"	 TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     MOVE "WSTOLD"	 TO APAC-KEY.
	     MOVE "W_INVENT.OLD" TO APAC-NAME.
	     PERFORM OFFL-WRITE-APACFILE.
	     CLOSE APACFILE.

       OFFL-CREATE-NEW-EXIT.
	     EXIT.

       OFFLFILES-EXIT.
	     EXIT.

       OFFL-SETUP-PATHS        SECTION 52.
       OFFL-SETUP.
	     MOVE WS-SYS-ID	 TO W02-SYSPTH W02-SYSID.
	     OPEN INPUT APACFILE.
	     OPEN OUTPUT APACFIDS.
	     CLOSE APACFIDS.
	     OPEN I-O APACFIDS.
	     MOVE SPACES	 TO APAC-KEY.
000030	     START APACFILE
	       KEY >= APAC-KEY.

       OFFL-GET-NEXT-FILE-ID.
000320	     READ APACFILE NEXT WITH IGNORE LOCK.
000350	   IF NOT (WS-STAT1 = "0")
000370	       GO TO OFFL-SETUP-END.
	     MOVE APAC-KEY	 TO AFID-KEY.
	     MOVE SPACES	 TO AFID-PATH.
	     STRING APAC-PATH DELIMITED BY " "
		    APAC-NAME DELIMITED BY " "
		    INTO AFID-PATH.
	     WRITE AFID-RECORD1.
	     GO TO OFFL-GET-NEXT-FILE-ID.

       OFFL-SETUP-END.
	     CLOSE APACFILE
		   APACFIDS.

       OFFL-SETUP-EXIT.
	     EXIT.
      /    *************************************************************
      *    *****	    INITIALIZE MUDULES (FILES)		   *****
      *    *************************************************************
011610 AG000                   SECTION 53.
011620 AG00.
011630       DISPLAY CLR-SCREEN.
011640       DISPLAY S17.
011650	     MOVE "N"		 TO WS-OPTION.
011660 AG02.
011670	     ACCEPT WS-OPTION AT 0525
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
011680			 UPDATE AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
011740	   IF NOT (WS-OPTION = "N" OR "Y")
011750         GO TO AG02.
011760	   IF WS-OPTION = "N"
011770         GO TO AG999.
	     DISPLAY WS-BLNK78 AT 0502 WITH FOREGROUND-COLOR 3.
011780	     DISPLAY "Key in date (DDMMCCYY)" AT 0504
		      WITH FOREGROUND-COLOR 6 HIGHLIGHT.
011790	     MOVE 2		 TO WS-SECKEY.

011800 AG03.
011810       READ SECUR LOCK.
011820     IF RUNTIME-ERROR
011830         IF RECORD-LOCKED
011840             GO TO AG03.
011850     IF WS-STATUS NOT = "00"
011860	       MOVE "Disk error - AG00"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
011870	       STOP RUN.
	     MOVE TODAY-DDMMYY	 TO SEC-DATE.

011880 AG05.
011890       ACCEPT S10.
011900	     MOVE SEC-DATE	 TO W20-DTE.
011910	     DISPLAY WS-BLNK78 AT 2302 WITH FOREGROUND-COLOR 3.
011920       PERFORM AB000-DATE.
011930     IF WS-ERROR = 1
011940	       MOVE "Invalid date"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
011950         GO TO AG05.
	   IF WS0-LEV = 0
	       MOVE "JUNIOR"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 1
	       MOVE "ENTRY"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 2
	       MOVE "BASIC"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 3
	       MOVE "STANDARD"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 4
	       MOVE "PREMIUM"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 5
	       MOVE "G O L D"	 TO WS-PACK
	   ELSE
	       MOVE "S.MANAG."	 TO WS-PACK.
	     DISPLAY S25.

       AG06.
	     MOVE SEC-TERMS	 TO WS-TERMS.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		       Is this a new system?		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
           IF SEC-NUM = WS-XXX
	       PERFORM AG30 THRU AG35.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ Check if additional  modules  have	 been  added  and need ณ
      *    ณ to be  initialized	 or  whether  all  modules  need to be ณ
      *    ณ initialized.					       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
011960     IF SEC-DTP = 1 OR SEC-STP = 1 OR SEC-CRP = 1 OR
011970        SEC-GLP = 1 OR SEC-HPD = 1 OR SEC-POS = 1 OR
011980        SEC-JCP = 1 OR SEC-VHP = 1
011990         IF SEC-DTP = 2 OR SEC-STP = 2
012000             OR SEC-CRP = 2 OR SEC-GLP = 2
012010             OR SEC-HPD = 2 OR SEC-POS = 2
012020             OR SEC-JCP = 2 OR SEC-VHP = 2
012030             GO TO AG12.
	     MOVE W12-T-YMD	 TO SEC-INITIAL.
             MOVE ZERO           TO SEC-COUNT
                                    SEC-DEM.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	       UPDATE DETAILS IN THE PARAMETER FILE	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
       AG07.
	     MOVE 3		 TO WS-PARKEY.
006950	     READ PARAM.
006960     IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980		   GO TO AG07.
	     MOVE SEC-NUM	 TO PAR-SERIAL WS-SERIAL.
	     MOVE SEC-LEV	 TO PAR-LEV    WS-LEV.
007540	     REWRITE PAR-RECORD3.

       AG08.
012360	     MOVE SPACES	 TO SEC-COMP.
012370	     DISPLAY "Company Name" AT 1604.
012380	     ACCEPT SEC-COMP AT 1618
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT PROMPT AUTO.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	   Are the modules (files) to be reinitialized?        ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
012390 AG10.
012400	     MOVE "Y"		 TO WS-OPTION.
012410     IF (WS0-STP = 2) OR (WS0-DTP = 2) OR
012420        (WS0-CRP = 2) OR (WS0-GLP = 2) OR
012430        (WS0-HPD = 2) OR (WS0-POS = 2) OR
012440        (WS0-JCP = 2) OR (WS0-VHP = 2)
012450         DISPLAY "Initialize again (Y/N)" AT 2312
                        WITH FOREGROUND-COLOR 14
012460	       ACCEPT WS-OPTION AT 2335 WITH FOREGROUND-COLOR 15
012470                                      UPDATE AUTO
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	     DISPLAY WS-BLNK78 AT 2302 WITH FOREGROUND-COLOR 3.
012530	   IF WS-OPTION = "N"
012540         GO TO AG25.
012550     IF SEC-DTP = 2
012560	       MOVE 1		 TO WS0-DTP.
012570     IF SEC-STP = 2
012580	       MOVE 1		 TO WS0-STP.
012590	   IF SEC-CRP = 2
012600	       MOVE 1		 TO WS0-CRP.
012610     IF SEC-GLP = 2
012620	       MOVE 1		 TO WS0-GLP.
012630     IF SEC-HPD = 2
012640	       MOVE 1		 TO WS0-HPD.
012650     IF SEC-POS = 2
012660	       MOVE 1		 TO WS0-POS.
012670     IF SEC-JCP = 2
012680	       MOVE 1		 TO WS0-JCP.
012690     IF SEC-VHP = 2
012700	       MOVE 1		 TO WS0-VHP.

012710 AG12.
012720	   IF WS0-DTP = 1
012730	       MOVE 2		 TO SEC-DTP.
012740     IF WS0-STP = 1
012750	       MOVE 2		 TO SEC-STP.
012760     IF WS0-CRP = 1
012770	       MOVE 2		 TO SEC-CRP.
012780     IF WS0-GLP = 1
012790	       MOVE 2		 TO SEC-GLP.
012800     IF WS0-HPD = 1
012810	       MOVE 2		 TO SEC-HPD.
012820     IF WS0-POS = 1
012830	       MOVE 2		 TO SEC-POS.
012840     IF WS0-JCP = 1
012850	       MOVE 2		 TO SEC-JCP.
012860     IF WS0-VHP = 1
012870	       MOVE 2		 TO SEC-VHP.
012880	     MOVE WS-SYS-ID	 TO SEC-EXT.
	   IF SEC-AGREE = "R"
	       MOVE W12-T-YMD	 TO W20-DTE
	       ADD 1		 TO W20-YY
	       MOVE W20-DTE	 TO SEC-ANDATE
	       MOVE 255 	 TO SEC-DAYS
	       IF ((W20-MM = 01 OR 03 OR 05 OR 07 OR 08 OR 10 OR 12)
		   AND (W20-DD > 16)) OR
		  ((W20-MM = 02) AND (W20-DD > 14)) OR
		  (W20-DD > 15)
		   IF W20-MM < 12
		       ADD 1	 TO W20-MM
		   ELSE
		       MOVE 1	 TO W20-MM
		       ADD 1	 TO W20-YY
		   END-IF
		   IF W20-DD < 16
		       SUBTRACT 14
				 FROM W20-DD
		   ELSE
		       SUBTRACT 15
				 FROM W20-DD
		   END-IF
		   IF W20-MM > 12
		       SUBTRACT 12
				 FROM W20-MM
		       ADD 1	 TO W20-YY
		   END-IF
	       ELSE
	       IF (W20-MM = 02 AND W20-DD < 14)
		   ADD 14	 TO W20-DD
	       ELSE
		   MOVE 28	 TO W20-DD
	       END-IF
	       IF NOT (W20-MM = 02)
		   ADD 15	 TO W20-DD
	       END-IF
	       END-IF
	       MOVE W20-DTE	 TO SEC-EXPDATE
	   END-IF.
012890	     REWRITE SEC-REC2.
012900       UNLOCK SECUR.
012910     IF WS-STATUS NOT = "00"
012920	       MOVE "Disk error - AG10"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
012930         STOP RUN.
012940	     MOVE 9		 TO WS-ERROR.
012950       GO TO AG999.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		   Get details for a new system		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
       AG30.
	     MOVE "APACOPN"	 TO SEC-NUM.
	   IF SEC-POS > ZERO
	       DISPLAY S25.
	   IF WS0-LEV < 2
	       MOVE 2		 TO WS-S2
	   ELSE
	   IF WS0-LEV < 3
	       MOVE 4		 TO WS-S2
	   ELSE
	   IF WS0-LEV < 4
	       MOVE 10		 TO WS-S2
	   ELSE
	       MOVE 100		 TO WS-S2.
	     MOVE WS-S2 	 TO WS-NUM.
	     DISPLAY "Maximum work stations: " AT 1210
		      WS-NUM WITH FOREGROUND-COLOR 6 HIGHLIGHT .

       AG32.
	     ACCEPT S25A.
	     PERFORM CHECK-CORRECT.
006160	   IF WS-OPTION = "N"
	       GO TO AG32.
	   IF NOT (WS-TERMS < WS-S2)
	       MOVE "Maximum W/Stations exceeded - ENTER"
				 TO WS-ERR-MES
	       PERFORM ERROR-LENGTH THRU ERROR-EXIT
	       GO TO AG32.
	     MOVE WS-TERMS	 TO SEC-TERMS.

       AG35.
             EXIT.

013190 AG999.
013200       EXIT.
      /    *************************************************************
      *    *****	      S T A R T   S Y S T E M		   *****
      *    *************************************************************
014530 AI000                   SECTION 55.
       AI0.
014760	     MOVE 2		 TO WS-SECKEY.

       AI0-READ.
014780	     READ SECUR.
014790     IF RUNTIME-ERROR
014800         IF RECORD-LOCKED
014810		   GO TO AI0-READ.
014820     IF WS-STATUS NOT = "00"
014830	       MOVE "Disk error - AI00 (SYSTEM)"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
014840         STOP RUN.

014540 AI00.
014550	     MOVE 1		 TO WS-ERROR.
014560     IF (WS0-DTP NOT = 2) AND (WS0-STP NOT = 2) AND
014570        (WS0-CRP NOT = 2) AND (WS0-GLP NOT = 2) AND
014580        (WS0-HPD NOT = 2) AND (WS0-POS NOT = 2) AND
014590        (WS0-JCP NOT = 2) AND (WS0-VHP NOT = 2)
014600	       MOVE "Files not yet initialized"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
014640         GO TO AI999.
	   IF SEC-AGREE = "R" AND
	      SEC-DAYS = ZERO
	       MOVE "Contract must be renewed!"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
014640         GO TO AI999.
014650	   IF WS0-POS = 2
014660	       MOVE "Y" 	 TO WS-CSS.

       AI02.
	     MOVE 3		 TO WS-PARKEY.
006950	     READ PARAM.
006960	   IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980		   GO TO AI02.
	     MOVE PAR-CUR-YR	 TO WS-CUR-YR.
	     MOVE PAR-CUR-CEN	 TO WS-CUR-CEN.
	     MOVE PAR-PRV-CEN	 TO WS-PRV-CEN.
	     MOVE PAR-NXT-CEN	 TO WS-NXT-CEN.
014670	     MOVE 1		 TO WS-PARKEY.

014680 AI05.
014690       READ PARAM.
014700	   IF RUNTIME-ERROR
014710         IF RECORD-LOCKED
014720             GO TO AI05.
014730     IF WS-STATUS NOT = "00"
014740	       MOVE "Disk error - AI00 (PARAM)"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
014750         STOP RUN.

014770 AI10.
014850	   IF (PAR-COMPANY NOT = SEC-COMP) OR
	      (WS-SERIAL NOT = SEC-NUM) OR
	      (WS-LEV NOT = SEC-LEV)
014860	       MOVE "Contact your supplier"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
014870         STOP RUN.
      *    *************************************************************
      *    ****   U S E D   T O   C H E C K   F O R   C L E A R
      * 	  O N	D E M O N S T R A T I O N   S Y S T E M
      *    *************************************************************
	     MOVE SEC-DATE	 TO WS-DTE.

014920 AI25.
014930       DISPLAY CLR-SCREEN.
	     MOVE 5		 TO SHADE-ROW.
	     MOVE 18		 TO SHADE-COL.
	     MOVE 48		 TO SHADE-WIDTH.
	     MOVE 13		 TO SHADE-LINES.
	     DISPLAY S18.
	     PERFORM SCREEN-SHADOW.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ  DATE returns a six digit result as YYMMDD. W25-FACT is   ณ
      *    ณ  defined as YYMMDD. These details are moved to W12-TODAY  ณ
      *    ณ  and W20-DATE (DDMMCCYY). The current century is inserted ณ
      *    ณ  The system then checks the year and the current year (as ณ
      *    ณ  recorded in the data base) and if the year is less by    ณ
      *    ณ  more than 70, the next century will be inserted. If the  ณ
      *    ณ  year is greater by more than 70, the previous century    ณ
      *    ณ  will be inserted. 				       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
      *      ACCEPT W12-T-YMD FROM DATE.
	     ACCEPT W25-FACT FROM DATE.
	     MOVE W25-YY	 TO W20-YEAR  W12-YEAR.
	     MOVE W25-MM	 TO W20-MONTH W12-MONTH.
	     MOVE W25-DD	 TO W20-DAY   W12-DAY.
	     MOVE WS-CUR-CEN	 TO W20-CENT  W12-CENT.
	   IF W25-YY < (WS-CUR-YR - 70)
	       MOVE WS-NXT-CEN	 TO W20-CENT W12-CENT
	   ELSE
	   IF W25-YY > (WS-CUR-YR + 70)
	       MOVE WS-PRV-CEN	 TO W20-CENT W12-CENT.

014970 AI30.
014980       ACCEPT S20.
006180	     DISPLAY CLEAR-L25.
014990       PERFORM AB000-DATE.
015000     IF WS-ERROR = 1
015010	       MOVE "Invalid date"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
015020         GO TO AI30.
015030	     MOVE W20-DAY	 TO W12-DAY W12-DD.
015040	     MOVE W20-MONTH	 TO W12-MONTH W12-MM.
015050	     MOVE W20-YEAR	 TO W12-YEAR W12-YY.
	     MOVE W20-CENT	 TO W12-CENT W12-CC.
	     MOVE W12-TODAY	 TO TODAY-DDMMYY SEC-DATE.
015060	     DISPLAY WS-BLNK78 AT 2102 WITH FOREGROUND-COLOR 3.
015060	     DISPLAY WS-BLNK78 AT 2302 WITH FOREGROUND-COLOR 3.
015070	     DISPLAY "Todays date - " AT 2129 W12-DD " "
015080		      W30-MONTH (W12-MM) "," W12-CC W12-YY.
015090	     DISPLAY "Is date correct (Y/N) ?" AT 2329
		      WITH FOREGROUND-COLOR 6 HIGHLIGHT.
	     MOVE "Y"		 TO WS-OPTION.

       AI35.
015100	     ACCEPT WS-OPTION AT 2353 WITH FOREGROUND-COLOR 7 HIGHLIGHT
                                          UPDATE AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	   IF NOT (WS-OPTION = "N" OR "Y")
               GO TO AI35.
015160	   IF WS-OPTION = "N"
015170         GO TO AI30.
015180	     MOVE W12-TODAY	 TO PAR-DMY.
015190	     MOVE W12-T-YMD	 TO PAR-YMD.
015200       REWRITE PAR-RECORD1.
	   IF SEC-AGREE = "R"
	       IF NOT (W12-T-YMD < SEC-EXPDATE)
		   MOVE ZERO	 TO SEC-DAYS
	       ELSE
		   COMPUTE W31-DTE1 = W12-YY * 365.25
		   ADD W31-NO (W12-MM)
				 TO W31-DTE1
		   ADD W12-DD	 TO W31-DTE1
		   MOVE SEC-EXPDATE
				 TO W20-DTE
		   COMPUTE W31-DTE2 = W20-YY * 365.25
		   ADD W31-NO (W20-MM)
				 TO W31-DTE2
		   ADD W20-DD	 TO W31-DTE2
		   SUBTRACT W31-DTE2 FROM W31-DTE1
				 GIVING W25-DAYS
		   IF W25-DAYS < 46
		       MOVE W25-DAYS
				 TO SEC-DAYS.
	     MOVE SEC-DEM	 TO WS-DEM.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	   T E S T   F O R   D E M O N S T R A T I O N	       ณ
      *    ณ	   S Y S T E M					       ณ
      *    ณ							       ณ
      *    ณ	   Is the run date still the same ?		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	   IF SEC-DATE = WS-DTE
      *    *************************************************************
      *    ****   M U S T   I N D I C A T O R	B E   R E S E T   ?
      *    *************************************************************
	       IF WS-DEM > 2
		   MOVE 2	 TO WS-DEM SEC-DEM
	       END-IF
	   ELSE
      *    *************************************************************
      *    ****   M U S T   I N D I C A T O R	B E   S E T    ?
      *    *************************************************************
	   IF WS-DEM = 2
	       MOVE ZERO	 TO W31-DTE1
	       ADD W31-NO (W12-MM)
				 TO W31-DTE1
	       ADD W12-DD	 TO W31-DTE1
	       DIVIDE W31-DTE1 BY 13 GIVING W31-DTE2
				 REMAINDER WS-C1
	       IF WS-C1 = 3 OR 6 OR 9 OR 12
		   DIVIDE 3	 INTO WS-C1
		   ADD 2 WS-C1	 GIVING WS-DEM
		   MOVE WS-DEM	 TO SEC-DEM.
008570	     REWRITE SEC-REC2.
	   IF W12-YY = WS-CUR-YR
	       GO TO AI999.

012390 AI40.
	     MOVE 3		 TO WS-PARKEY.
006950	     READ PARAM.
006960     IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980		   GO TO AI40.
	     MOVE W12-YY	 TO PAR-CUR-YR.
	   IF W12-YY < (WS-CUR-YR - 70)
	       ADD 1		 TO PAR-CUR-CEN
				    PAR-PRV-CEN
				    PAR-NXT-CEN
	   ELSE
	   IF W12-YY > (WS-CUR-YR + 70)
	       SUBTRACT 1	 FROM PAR-CUR-CEN
				      PAR-PRV-CEN
				      PAR-NXT-CEN.
002380	     REWRITE PAR-RECORD3.

015210 AI999.
015220       EXIT.
      /    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		      DECIMAL/HEX/ASCII TABLE		       ณ
      *    ณ This routine has  been inserted  to help  both developers ณ
      *    ณ and users.  This is a table  that is never available when ณ
      *    ณ needed so I included this routine to solve the problem    ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
015230 AJ000		       SECTION 56.
       AJ0.
             DISPLAY "Waiting for printer response" AT 2312
                      WITH FOREGROUND-COLOR 14 BLINK.
006780       OPEN OUTPUT PRNREP.
	     CALL X"91" USING X91-RES X91-FUN PRNREP.
	     DISPLAY WS-BLNK78 AT 2302 WITH FOREGROUND-COLOR 3.

015240 AJ00.
015250       DISPLAY CLR-SCREEN.
015260       DISPLAY (12, 12) "Busy printing DECIMAL/HEX/ASCII Table".
015270	     MOVE SPACES	 TO REP-DETAIL.
015280	     MOVE "DECIMAL/HEX/ASCII TABLE"
				 TO REP-HEAD.
015290       WRITE REP-L1 BEFORE 1 LINES.
015300	     MOVE 0		 TO WS-C1.
015310	     MOVE 64		 TO WS-C2.
015320	     MOVE 128		 TO WS-C3.
015330	     MOVE 192		 TO WS-C4.
015340	     MOVE SPACES	 TO REP-DETAIL.
015350	     MOVE "DEC" 	 TO REP-H1 (1) REP-H1 (2)
				    REP-H1 (3) REP-H1 (4).
015360	     MOVE "HEX" 	 TO REP-H2 (1) REP-H2 (2)
				    REP-H2 (3) REP-H2 (4).
015370	     MOVE "ASCII"	 TO REP-H3 (1) REP-H3 (2)
015380				    REP-H3 (3) REP-H3 (4).

015390 AJ05.
015400	     MOVE "|"		 TO REP-DIV (1) REP-DIV (2)
015410				    REP-DIV (3) REP-DIV (4).
015420       WRITE REP-L1 BEFORE 1 LINES.
015430	     MOVE SPACES	 TO REP-DETAIL.
015440	     MOVE WS-C1 	 TO REP-DEC (1).
015450	     MOVE WS-C2 	 TO REP-DEC (2).
015460	     MOVE WS-C3 	 TO REP-DEC (3).
015470	     MOVE WS-C4 	 TO REP-DEC (4).
015480	     ADD 1		 TO WS-C1.
015490	     ADD 1		 TO WS-C2.
015500	     ADD 1		 TO WS-C3.
015510	     ADD 1		 TO WS-C4.

015520 AJ15.
015530	     MOVE "00"		 TO REP-HEX (1).
015540	     MOVE "40"		 TO REP-HEX (2).
015550	     MOVE "80"		 TO REP-HEX (3).
015560	     MOVE "C0"		 TO REP-HEX (4).
015570	     MOVE "NUL" 	 TO REP-GRAPH (1).
015580	     MOVE "@"		 TO REP-ALPH (2).
015580	     MOVE X"80" 	 TO REP-ALPH (3).
015580	     MOVE X"C0" 	 TO REP-ALPH (4).
015590       PERFORM AJ05.
015600	     MOVE "01"		 TO REP-HEX (1).
015610	     MOVE "41"		 TO REP-HEX (2).
015620	     MOVE "81"		 TO REP-HEX (3).
015630	     MOVE "C1"		 TO REP-HEX (4).
015640	     MOVE "SOH" 	 TO REP-GRAPH (1).
015650	     MOVE "A"		 TO REP-ALPH (2).
015580	     MOVE X"81" 	 TO REP-ALPH (3).
015580	     MOVE X"C1" 	 TO REP-ALPH (4).
015660       PERFORM AJ05.
015670	     MOVE "02"		 TO REP-HEX (1).
015680	     MOVE "42"		 TO REP-HEX (2).
015690	     MOVE "82"		 TO REP-HEX (3).
015700	     MOVE "C2"		 TO REP-HEX (4).
015710	     MOVE "STX" 	 TO REP-GRAPH (1).
015720	     MOVE "B"		 TO REP-ALPH (2).
015580	     MOVE X"82" 	 TO REP-ALPH (3).
015580	     MOVE X"C2" 	 TO REP-ALPH (4).
015730       PERFORM AJ05.
015740	     MOVE "03"		 TO REP-HEX (1).
015750	     MOVE "43"		 TO REP-HEX (2).
015760	     MOVE "83"		 TO REP-HEX (3).
015770	     MOVE "C3"		 TO REP-HEX (4).
015780	     MOVE "ETX" 	 TO REP-GRAPH (1).
015790	     MOVE "C"		 TO REP-ALPH (2).
015580	     MOVE X"83" 	 TO REP-ALPH (3).
015580	     MOVE X"C3" 	 TO REP-ALPH (4).
015800       PERFORM AJ05.
015810	     MOVE "04"		 TO REP-HEX (1).
015820	     MOVE "44"		 TO REP-HEX (2).
015830	     MOVE "84"		 TO REP-HEX (3).
015840	     MOVE "C4"		 TO REP-HEX (4).
015850	     MOVE "EOT" 	 TO REP-GRAPH (1).
015860	     MOVE "D"		 TO REP-ALPH (2).
015580	     MOVE X"84" 	 TO REP-ALPH (3).
015580	     MOVE X"C4" 	 TO REP-ALPH (4).
015870       PERFORM AJ05.
015880	     MOVE "05"		 TO REP-HEX (1).
015890	     MOVE "45"		 TO REP-HEX (2).
015900	     MOVE "85"		 TO REP-HEX (3).
015910	     MOVE "C5"		 TO REP-HEX (4).
015920	     MOVE "ENQ" 	 TO REP-GRAPH (1).
015930	     MOVE "E"		 TO REP-ALPH (2).
015580	     MOVE X"85" 	 TO REP-ALPH (3).
015580	     MOVE X"C5" 	 TO REP-ALPH (4).
015940       PERFORM AJ05.
015950	     MOVE "06"		 TO REP-HEX (1).
015960	     MOVE "46"		 TO REP-HEX (2).
015970	     MOVE "86"		 TO REP-HEX (3).
015980	     MOVE "C6"		 TO REP-HEX (4).
015990	     MOVE "ACK" 	 TO REP-GRAPH (1).
016000	     MOVE "F"		 TO REP-ALPH (2).
015580	     MOVE X"86" 	 TO REP-ALPH (3).
015580	     MOVE X"C6" 	 TO REP-ALPH (4).
016010       PERFORM AJ05.
016020	     MOVE "07"		 TO REP-HEX (1).
016030	     MOVE "47"		 TO REP-HEX (2).
016040	     MOVE "87"		 TO REP-HEX (3).
016050	     MOVE "C7"		 TO REP-HEX (4).
016060	     MOVE "BEL" 	 TO REP-GRAPH (1).
016070	     MOVE "G"		 TO REP-ALPH (2).
015580	     MOVE X"87" 	 TO REP-ALPH (3).
015580	     MOVE X"C7" 	 TO REP-ALPH (4).
016080       PERFORM AJ05.
016090	     MOVE "08"		 TO REP-HEX (1).
016100	     MOVE "48"		 TO REP-HEX (2).
016110	     MOVE "88"		 TO REP-HEX (3).
016120	     MOVE "C8"		 TO REP-HEX (4).
016130	     MOVE "BS"		 TO REP-GRAPH (1).
016140	     MOVE "H"		 TO REP-ALPH (2).
015580	     MOVE X"88" 	 TO REP-ALPH (3).
015580	     MOVE X"C8" 	 TO REP-ALPH (4).
016150       PERFORM AJ05.
016160	     MOVE "09"		 TO REP-HEX (1).
016170	     MOVE "49"		 TO REP-HEX (2).
016180	     MOVE "89"		 TO REP-HEX (3).
016190	     MOVE "C9"		 TO REP-HEX (4).
016200	     MOVE "HT"		 TO REP-GRAPH (1).
016210	     MOVE "I"		 TO REP-ALPH (2).
015580	     MOVE X"89" 	 TO REP-ALPH (3).
015580	     MOVE X"C9" 	 TO REP-ALPH (4).
016220       PERFORM AJ05.
016230	     MOVE "0A"		 TO REP-HEX (1).
016240	     MOVE "4A"		 TO REP-HEX (2).
016250	     MOVE "8A"		 TO REP-HEX (3).
016260	     MOVE "CA"		 TO REP-HEX (4).
016270	     MOVE "LF"		 TO REP-GRAPH (1).
016280	     MOVE "J"		 TO REP-ALPH (2).
015580	     MOVE X"8A" 	 TO REP-ALPH (3).
015580	     MOVE X"CA" 	 TO REP-ALPH (4).
016290       PERFORM AJ05.
016300	     MOVE "0B"		 TO REP-HEX (1).
016310	     MOVE "4B"		 TO REP-HEX (2).
016320	     MOVE "8B"		 TO REP-HEX (3).
016330	     MOVE "CB"		 TO REP-HEX (4).
016340	     MOVE "VT"		 TO REP-GRAPH (1).
016350	     MOVE "K"		 TO REP-ALPH (2).
015580	     MOVE X"8B" 	 TO REP-ALPH (3).
015580	     MOVE X"CB" 	 TO REP-ALPH (4).
016360       PERFORM AJ05.
016370	     MOVE "0C"		 TO REP-HEX (1).
016380	     MOVE "4C"		 TO REP-HEX (2).
016390	     MOVE "8C"		 TO REP-HEX (3).
016400	     MOVE "CC"		 TO REP-HEX (4).
016410	     MOVE "FF"		 TO REP-GRAPH (1).
016420	     MOVE "L"		 TO REP-ALPH (2).
015580	     MOVE X"8C" 	 TO REP-ALPH (3).
015580	     MOVE X"CC" 	 TO REP-ALPH (4).
016430       PERFORM AJ05.
016440	     MOVE "0D"		 TO REP-HEX (1).
016450	     MOVE "4D"		 TO REP-HEX (2).
016460	     MOVE "8D"		 TO REP-HEX (3).
016470	     MOVE "CD"		 TO REP-HEX (4).
016480	     MOVE "CR"		 TO REP-GRAPH (1).
016490	     MOVE "M"		 TO REP-ALPH (2).
015580	     MOVE X"8D" 	 TO REP-ALPH (3).
015580	     MOVE X"CD" 	 TO REP-ALPH (4).
016500       PERFORM AJ05.
016510	     MOVE "0E"		 TO REP-HEX (1).
016520	     MOVE "4E"		 TO REP-HEX (2).
016530	     MOVE "8E"		 TO REP-HEX (3).
016540	     MOVE "CE"		 TO REP-HEX (4).
016550	     MOVE "SO"		 TO REP-GRAPH (1).
016560	     MOVE "N"		 TO REP-ALPH (2).
015580	     MOVE X"8E" 	 TO REP-ALPH (3).
015580	     MOVE X"CE" 	 TO REP-ALPH (4).
016570       PERFORM AJ05.
016580	     MOVE "0F"		 TO REP-HEX (1).
016590	     MOVE "4F"		 TO REP-HEX (2).
016600	     MOVE "8F"		 TO REP-HEX (3).
016610	     MOVE "CF"		 TO REP-HEX (4).
016620	     MOVE "SI"		 TO REP-GRAPH (1).
016630	     MOVE "O"		 TO REP-ALPH (2).
015580	     MOVE X"8F" 	 TO REP-ALPH (3).
015580	     MOVE X"CF" 	 TO REP-ALPH (4).
016640       PERFORM AJ05.
016650	     MOVE "10"		 TO REP-HEX (1).
016660	     MOVE "50"		 TO REP-HEX (2).
016670	     MOVE "90"		 TO REP-HEX (3).
016680	     MOVE "D0"		 TO REP-HEX (4).
016690	     MOVE "DLE" 	 TO REP-GRAPH (1).
016700	     MOVE "P"		 TO REP-ALPH (2).
015580	     MOVE X"90" 	 TO REP-ALPH (3).
015580	     MOVE X"D0" 	 TO REP-ALPH (4).
016710       PERFORM AJ05.
016720	     MOVE "11"		 TO REP-HEX (1).
016730	     MOVE "51"		 TO REP-HEX (2).
016740	     MOVE "91"		 TO REP-HEX (3).
016750	     MOVE "D1"		 TO REP-HEX (4).
016760	     MOVE "DC1" 	 TO REP-GRAPH (1).
016770	     MOVE "Q"		 TO REP-ALPH (2).
015580	     MOVE X"91" 	 TO REP-ALPH (3).
015580	     MOVE X"D1" 	 TO REP-ALPH (4).
016780       PERFORM AJ05.
016790	     MOVE "12"		 TO REP-HEX (1).
016800	     MOVE "52"		 TO REP-HEX (2).
016810	     MOVE "92"		 TO REP-HEX (3).
016820	     MOVE "D2"		 TO REP-HEX (4).
016830	     MOVE "DC2" 	 TO REP-GRAPH (1).
016840	     MOVE "R"		 TO REP-ALPH (2).
015580	     MOVE X"92" 	 TO REP-ALPH (3).
015580	     MOVE X"D2" 	 TO REP-ALPH (4).
016850       PERFORM AJ05.
016860	     MOVE "13"		 TO REP-HEX (1).
016870	     MOVE "53"		 TO REP-HEX (2).
016880	     MOVE "93"		 TO REP-HEX (3).
016890	     MOVE "D3"		 TO REP-HEX (4).
016900	     MOVE "DC3" 	 TO REP-GRAPH (1).
016910	     MOVE "S"		 TO REP-ALPH (2).
015580	     MOVE X"93" 	 TO REP-ALPH (3).
015580	     MOVE X"D3" 	 TO REP-ALPH (4).
016920       PERFORM AJ05.
016930	     MOVE "14"		 TO REP-HEX (1).
016940	     MOVE "54"		 TO REP-HEX (2).
016950	     MOVE "94"		 TO REP-HEX (3).
016960	     MOVE "D4"		 TO REP-HEX (4).
016970	     MOVE "DC4" 	 TO REP-GRAPH (1).
016980	     MOVE "T"		 TO REP-ALPH (2).
015580	     MOVE X"94" 	 TO REP-ALPH (3).
015580	     MOVE X"D4" 	 TO REP-ALPH (4).
016990       PERFORM AJ05.
017000	     MOVE "15"		 TO REP-HEX (1).
017010	     MOVE "55"		 TO REP-HEX (2).
017020	     MOVE "95"		 TO REP-HEX (3).
017030	     MOVE "D5"		 TO REP-HEX (4).
017040	     MOVE "NAK" 	 TO REP-GRAPH (1).
017050	     MOVE "U"		 TO REP-ALPH (2).
015580	     MOVE X"95" 	 TO REP-ALPH (3).
015580	     MOVE X"D5" 	 TO REP-ALPH (4).
017060       PERFORM AJ05.
017070	     MOVE "16"		 TO REP-HEX (1).
017080	     MOVE "56"		 TO REP-HEX (2).
017090	     MOVE "96"		 TO REP-HEX (3).
017100	     MOVE "D6"		 TO REP-HEX (4).
017110	     MOVE "SYN" 	 TO REP-GRAPH (1).
017120	     MOVE "V"		 TO REP-ALPH (2).
015580	     MOVE X"96" 	 TO REP-ALPH (3).
015580	     MOVE X"D6" 	 TO REP-ALPH (4).
017130       PERFORM AJ05.
017140	     MOVE "17"		 TO REP-HEX (1).
017150	     MOVE "57"		 TO REP-HEX (2).
017160	     MOVE "97"		 TO REP-HEX (3).
017170	     MOVE "D7"		 TO REP-HEX (4).
017180	     MOVE "ETB" 	 TO REP-GRAPH (1).
017190	     MOVE "W"		 TO REP-ALPH (2).
015580	     MOVE X"97" 	 TO REP-ALPH (3).
015580	     MOVE X"D7" 	 TO REP-ALPH (4).
017200       PERFORM AJ05.
017210	     MOVE "18"		 TO REP-HEX (1).
017220	     MOVE "58"		 TO REP-HEX (2).
017230	     MOVE "98"		 TO REP-HEX (3).
017240	     MOVE "D8"		 TO REP-HEX (4).
017250	     MOVE "CAN" 	 TO REP-GRAPH (1).
017260	     MOVE "X"		 TO REP-ALPH (2).
015580	     MOVE X"98" 	 TO REP-ALPH (3).
015580	     MOVE X"D8" 	 TO REP-ALPH (4).
017270       PERFORM AJ05.
017280	     MOVE "19"		 TO REP-HEX (1).
017290	     MOVE "59"		 TO REP-HEX (2).
017300	     MOVE "99"		 TO REP-HEX (3).
017310	     MOVE "D9"		 TO REP-HEX (4).
017320	     MOVE "EM"		 TO REP-GRAPH (1).
017330	     MOVE "Y"		 TO REP-ALPH (2).
015580	     MOVE X"99" 	 TO REP-ALPH (3).
015580	     MOVE X"D9" 	 TO REP-ALPH (4).
017340       PERFORM AJ05.
017350	     MOVE "1A"		 TO REP-HEX (1).
017360	     MOVE "5A"		 TO REP-HEX (2).
017370	     MOVE "9A"		 TO REP-HEX (3).
017380	     MOVE "DA"		 TO REP-HEX (4).
017390	     MOVE "SUB" 	 TO REP-GRAPH (1).
017400	     MOVE "Z"		 TO REP-ALPH (2).
015580	     MOVE X"9A" 	 TO REP-ALPH (3).
015580	     MOVE X"DA" 	 TO REP-ALPH (4).
017410       PERFORM AJ05.
017420	     MOVE "1B"		 TO REP-HEX (1).
017430	     MOVE "5B"		 TO REP-HEX (2).
017440	     MOVE "9B"		 TO REP-HEX (3).
017450	     MOVE "DB"		 TO REP-HEX (4).
017460	     MOVE "ESC" 	 TO REP-GRAPH (1).
017470	     MOVE "["		 TO REP-ALPH (2).
015580	     MOVE X"9B" 	 TO REP-ALPH (3).
015580	     MOVE X"DB" 	 TO REP-ALPH (4).
017480       PERFORM AJ05.
017490	     MOVE "1C"		 TO REP-HEX (1).
017500	     MOVE "5C"		 TO REP-HEX (2).
017510	     MOVE "9C"		 TO REP-HEX (3).
017520	     MOVE "DC"		 TO REP-HEX (4).
017530	     MOVE "FS"		 TO REP-GRAPH (1).
017540	     MOVE "\"            TO REP-ALPH (2).
015580	     MOVE X"9C" 	 TO REP-ALPH (3).
015580	     MOVE X"DC" 	 TO REP-ALPH (4).
017550       PERFORM AJ05.
017560	     MOVE "1D"		 TO REP-HEX (1).
017570	     MOVE "5D"		 TO REP-HEX (2).
017580	     MOVE "9D"		 TO REP-HEX (3).
017590	     MOVE "DD"		 TO REP-HEX (4).
017600	     MOVE "GS"		 TO REP-GRAPH (1).
017610	     MOVE "]"		 TO REP-ALPH (2).
015580	     MOVE X"9D" 	 TO REP-ALPH (3).
015580	     MOVE X"DD" 	 TO REP-ALPH (4).
017620       PERFORM AJ05.
017630	     MOVE "1E"		 TO REP-HEX (1).
017640	     MOVE "5E"		 TO REP-HEX (2).
017650	     MOVE "9E"		 TO REP-HEX (3).
017660	     MOVE "DE"		 TO REP-HEX (4).
017670	     MOVE "RS"		 TO REP-GRAPH (1).
017680	     MOVE "^"		 TO REP-ALPH (2).
015580	     MOVE X"9E" 	 TO REP-ALPH (3).
015580	     MOVE X"DE" 	 TO REP-ALPH (4).
017690       PERFORM AJ05.
017700	     MOVE "1F"		 TO REP-HEX (1).
017710	     MOVE "5F"		 TO REP-HEX (2).
017720	     MOVE "9F"		 TO REP-HEX (3).
017730	     MOVE "DF"		 TO REP-HEX (4).
017740	     MOVE "US"		 TO REP-GRAPH (1).
017750	     MOVE "<"		 TO REP-ALPH (2).
015580	     MOVE X"9F" 	 TO REP-ALPH (3).
015580	     MOVE X"DF" 	 TO REP-ALPH (4).
017760       PERFORM AJ05.
017770	     MOVE "20"		 TO REP-HEX (1).
017780	     MOVE "60"		 TO REP-HEX (2).
017790	     MOVE "A0"		 TO REP-HEX (3).
017800	     MOVE "E0"		 TO REP-HEX (4).
017810	     MOVE "SPACE"	 TO REP-GRAPH (1).
017820	     MOVE "'"		 TO REP-ALPH (2).
015580	     MOVE X"A0" 	 TO REP-ALPH (3).
015580	     MOVE X"E0" 	 TO REP-ALPH (4).
017830       PERFORM AJ05.
017840	     MOVE "21"		 TO REP-HEX (1).
017850	     MOVE "61"		 TO REP-HEX (2).
017860	     MOVE "A1"		 TO REP-HEX (3).
017870	     MOVE "E1"		 TO REP-HEX (4).
017880	     MOVE "!"		 TO REP-ALPH (1).
017890	     MOVE "a"		 TO REP-ALPH (2).
015580	     MOVE X"A1" 	 TO REP-ALPH (3).
015580	     MOVE X"E1" 	 TO REP-ALPH (4).
017900       PERFORM AJ05.
017910	     MOVE "22"		 TO REP-HEX (1).
017920	     MOVE "62"		 TO REP-HEX (2).
017930	     MOVE "A2"		 TO REP-HEX (3).
017940	     MOVE "E2"		 TO REP-HEX (4).
017950	     MOVE """"		 TO REP-ALPH (1).
017960	     MOVE "b"		 TO REP-ALPH (2).
015580	     MOVE X"A2" 	 TO REP-ALPH (3).
015580	     MOVE X"E2" 	 TO REP-ALPH (4).
017970       PERFORM AJ05.
017980	     MOVE "23"		 TO REP-HEX (1).
017990	     MOVE "63"		 TO REP-HEX (2).
018000	     MOVE "A3"		 TO REP-HEX (3).
018010	     MOVE "E3"		 TO REP-HEX (4).
018020	     MOVE "#"		 TO REP-ALPH (1).
018030	     MOVE "c"		 TO REP-ALPH (2).
015580	     MOVE X"A3" 	 TO REP-ALPH (3).
015580	     MOVE X"E3" 	 TO REP-ALPH (4).
018040       PERFORM AJ05.
018050	     MOVE "24"		 TO REP-HEX (1).
018060	     MOVE "64"		 TO REP-HEX (2).
018070	     MOVE "A4"		 TO REP-HEX (3).
018080	     MOVE "E4"		 TO REP-HEX (4).
018090	     MOVE "$"		 TO REP-ALPH (1).
018100	     MOVE "d"		 TO REP-ALPH (2).
015580	     MOVE X"A4" 	 TO REP-ALPH (3).
015580	     MOVE X"E4" 	 TO REP-ALPH (4).
018110       PERFORM AJ05.
018120	     MOVE "25"		 TO REP-HEX (1).
018130	     MOVE "65"		 TO REP-HEX (2).
018140	     MOVE "A5"		 TO REP-HEX (3).
018150	     MOVE "E5"		 TO REP-HEX (4).
018160	     MOVE "%"		 TO REP-ALPH (1).
018170	     MOVE "e"		 TO REP-ALPH (2).
015580	     MOVE X"A5" 	 TO REP-ALPH (3).
015580	     MOVE X"E5" 	 TO REP-ALPH (4).
018180       PERFORM AJ05.
018190	     MOVE "26"		 TO REP-HEX (1).
018200	     MOVE "66"		 TO REP-HEX (2).
018210	     MOVE "A6"		 TO REP-HEX (3).
018220	     MOVE "E6"		 TO REP-HEX (4).
018230	     MOVE "&"		 TO REP-ALPH (1).
018240	     MOVE "f"		 TO REP-ALPH (2).
015580	     MOVE X"A6" 	 TO REP-ALPH (3).
015580	     MOVE X"E6" 	 TO REP-ALPH (4).
018250       PERFORM AJ05.
018260	     MOVE "27"		 TO REP-HEX (1).
018270	     MOVE "67"		 TO REP-HEX (2).
018280	     MOVE "A7"		 TO REP-HEX (3).
018290	     MOVE "E7"		 TO REP-HEX (4).
018300	     MOVE "'"		 TO REP-ALPH (1).
018310	     MOVE "g"		 TO REP-ALPH (2).
015580	     MOVE X"A7" 	 TO REP-ALPH (3).
015580	     MOVE X"E7" 	 TO REP-ALPH (4).
018320       PERFORM AJ05.
018330	     MOVE "28"		 TO REP-HEX (1).
018340	     MOVE "68"		 TO REP-HEX (2).
018350	     MOVE "A8"		 TO REP-HEX (3).
018360	     MOVE "E8"		 TO REP-HEX (4).
018370	     MOVE "("		 TO REP-ALPH (1).
018380	     MOVE "h"		 TO REP-ALPH (2).
015580	     MOVE X"A8" 	 TO REP-ALPH (3).
015580	     MOVE X"E8" 	 TO REP-ALPH (4).
018390       PERFORM AJ05.
018400	     MOVE "29"		 TO REP-HEX (1).
018410	     MOVE "69"		 TO REP-HEX (2).
018420	     MOVE "A9"		 TO REP-HEX (3).
018430	     MOVE "E9"		 TO REP-HEX (4).
018440	     MOVE ")"		 TO REP-ALPH (1).
018450	     MOVE "i"		 TO REP-ALPH (2).
015580	     MOVE X"A9" 	 TO REP-ALPH (3).
015580	     MOVE X"E9" 	 TO REP-ALPH (4).
018460       PERFORM AJ05.
018470	     MOVE "2A"		 TO REP-HEX (1).
018480	     MOVE "6A"		 TO REP-HEX (2).
018490	     MOVE "AA"		 TO REP-HEX (3).
018500	     MOVE "EA"		 TO REP-HEX (4).
018510	     MOVE "*"		 TO REP-ALPH (1).
018520	     MOVE "j"		 TO REP-ALPH (2).
015580	     MOVE X"AA" 	 TO REP-ALPH (3).
015580	     MOVE X"EA" 	 TO REP-ALPH (4).
018530       PERFORM AJ05.
018540	     MOVE "2B"		 TO REP-HEX (1).
018550	     MOVE "6B"		 TO REP-HEX (2).
018560	     MOVE "AB"		 TO REP-HEX (3).
018570	     MOVE "EB"		 TO REP-HEX (4).
018580	     MOVE "+"		 TO REP-ALPH (1).
018590	     MOVE "k"		 TO REP-ALPH (2).
015580	     MOVE X"AB" 	 TO REP-ALPH (3).
015580	     MOVE X"EB" 	 TO REP-ALPH (4).
018600       PERFORM AJ05.
018610	     MOVE "2C"		 TO REP-HEX (1).
018620	     MOVE "6C"		 TO REP-HEX (2).
018630	     MOVE "AC"		 TO REP-HEX (3).
018640	     MOVE "EC"		 TO REP-HEX (4).
018650	     MOVE ","		 TO REP-ALPH (1).
018660	     MOVE "l"		 TO REP-ALPH (2).
015580	     MOVE X"AC" 	 TO REP-ALPH (3).
015580	     MOVE X"EC" 	 TO REP-ALPH (4).
018670       PERFORM AJ05.
018680	     MOVE "2D"		 TO REP-HEX (1).
018690	     MOVE "6D"		 TO REP-HEX (2).
018700	     MOVE "AD"		 TO REP-HEX (3).
018710	     MOVE "ED"		 TO REP-HEX (4).
018720	     MOVE "-"		 TO REP-ALPH (1).
018730	     MOVE "m"		 TO REP-ALPH (2).
015580	     MOVE X"AD" 	 TO REP-ALPH (3).
015580	     MOVE X"ED" 	 TO REP-ALPH (4).
018740       PERFORM AJ05.
018750	     MOVE "2E"		 TO REP-HEX (1).
018760	     MOVE "6E"		 TO REP-HEX (2).
018770	     MOVE "AE"		 TO REP-HEX (3).
018780	     MOVE "EE"		 TO REP-HEX (4).
018790	     MOVE "."		 TO REP-ALPH (1).
018800	     MOVE "n"		 TO REP-ALPH (2).
015580	     MOVE X"AE" 	 TO REP-ALPH (3).
015580	     MOVE X"EE" 	 TO REP-ALPH (4).
018810       PERFORM AJ05.
018820	     MOVE "2F"		 TO REP-HEX (1).
018830	     MOVE "6F"		 TO REP-HEX (2).
018840	     MOVE "AF"		 TO REP-HEX (3).
018850	     MOVE "EF"		 TO REP-HEX (4).
018860	     MOVE "/"		 TO REP-ALPH (1).
018870	     MOVE "o"		 TO REP-ALPH (2).
015580	     MOVE X"AF" 	 TO REP-ALPH (3).
015580	     MOVE X"EF" 	 TO REP-ALPH (4).
018880       PERFORM AJ05.
018890	     MOVE "30"		 TO REP-HEX (1).
018900	     MOVE "70"		 TO REP-HEX (2).
018910	     MOVE "B0"		 TO REP-HEX (3).
018920	     MOVE "F0"		 TO REP-HEX (4).
018930	     MOVE "0"		 TO REP-ALPH (1).
018940	     MOVE "p"		 TO REP-ALPH (2).
015580	     MOVE X"B0" 	 TO REP-ALPH (3).
015580	     MOVE X"F0" 	 TO REP-ALPH (4).
018950       PERFORM AJ05.
018960	     MOVE "31"		 TO REP-HEX (1).
018970	     MOVE "71"		 TO REP-HEX (2).
018980	     MOVE "B1"		 TO REP-HEX (3).
018990	     MOVE "F1"		 TO REP-HEX (4).
019000	     MOVE "1"		 TO REP-ALPH (1).
019010	     MOVE "q"		 TO REP-ALPH (2).
015580	     MOVE X"B1" 	 TO REP-ALPH (3).
015580	     MOVE X"F1" 	 TO REP-ALPH (4).
019020       PERFORM AJ05.
019030	     MOVE "32"		 TO REP-HEX (1).
019040	     MOVE "72"		 TO REP-HEX (2).
019050	     MOVE "B2"		 TO REP-HEX (3).
019060	     MOVE "F2"		 TO REP-HEX (4).
019070	     MOVE "2"		 TO REP-ALPH (1).
019080	     MOVE "r"		 TO REP-ALPH (2).
015580	     MOVE X"B2" 	 TO REP-ALPH (3).
015580	     MOVE X"F2" 	 TO REP-ALPH (4).
019090       PERFORM AJ05.
019100	     MOVE "33"		 TO REP-HEX (1).
019110	     MOVE "73"		 TO REP-HEX (2).
019120	     MOVE "B3"		 TO REP-HEX (3).
019130	     MOVE "F3"		 TO REP-HEX (4).
019140	     MOVE "3"		 TO REP-ALPH (1).
019150	     MOVE "s"		 TO REP-ALPH (2).
015580	     MOVE X"B3" 	 TO REP-ALPH (3).
015580	     MOVE X"F3" 	 TO REP-ALPH (4).
019160       PERFORM AJ05.
019170	     MOVE "34"		 TO REP-HEX (1).
019180	     MOVE "74"		 TO REP-HEX (2).
019190	     MOVE "B4"		 TO REP-HEX (3).
019200	     MOVE "F4"		 TO REP-HEX (4).
019210	     MOVE "4"		 TO REP-ALPH (1).
019220	     MOVE "t"		 TO REP-ALPH (2).
015580	     MOVE X"B4" 	 TO REP-ALPH (3).
015580	     MOVE X"F4" 	 TO REP-ALPH (4).
019230       PERFORM AJ05.
019240	     MOVE "35"		 TO REP-HEX (1).
019250	     MOVE "75"		 TO REP-HEX (2).
019260	     MOVE "B5"		 TO REP-HEX (3).
019270	     MOVE "F5"		 TO REP-HEX (4).
019280	     MOVE "5"		 TO REP-ALPH (1).
019290	     MOVE "u"		 TO REP-ALPH (2).
015580	     MOVE X"B5" 	 TO REP-ALPH (3).
015580	     MOVE X"F5" 	 TO REP-ALPH (4).
019300       PERFORM AJ05.
019310	     MOVE "36"		 TO REP-HEX (1).
019320	     MOVE "76"		 TO REP-HEX (2).
019330	     MOVE "B6"		 TO REP-HEX (3).
019340	     MOVE "F6"		 TO REP-HEX (4).
019350	     MOVE "6"		 TO REP-ALPH (1).
019360	     MOVE "v"		 TO REP-ALPH (2).
015580	     MOVE X"B6" 	 TO REP-ALPH (3).
015580	     MOVE X"F6" 	 TO REP-ALPH (4).
019370       PERFORM AJ05.
019380	     MOVE "37"		 TO REP-HEX (1).
019390	     MOVE "77"		 TO REP-HEX (2).
019400	     MOVE "B7"		 TO REP-HEX (3).
019410	     MOVE "F7"		 TO REP-HEX (4).
019420	     MOVE "7"		 TO REP-ALPH (1).
019430	     MOVE "w"		 TO REP-ALPH (2).
015580	     MOVE X"B7" 	 TO REP-ALPH (3).
015580	     MOVE X"F7" 	 TO REP-ALPH (4).
019440       PERFORM AJ05.
019450	     MOVE "38"		 TO REP-HEX (1).
019460	     MOVE "78"		 TO REP-HEX (2).
019470	     MOVE "B8"		 TO REP-HEX (3).
019480	     MOVE "F8"		 TO REP-HEX (4).
019490	     MOVE "8"		 TO REP-ALPH (1).
019500	     MOVE "x"		 TO REP-ALPH (2).
015580	     MOVE X"B8" 	 TO REP-ALPH (3).
015580	     MOVE X"F8" 	 TO REP-ALPH (4).
019510       PERFORM AJ05.
019520	     MOVE "39"		 TO REP-HEX (1).
019530	     MOVE "79"		 TO REP-HEX (2).
019540	     MOVE "B9"		 TO REP-HEX (3).
019550	     MOVE "F9"		 TO REP-HEX (4).
019560	     MOVE "9"		 TO REP-ALPH (1).
019570	     MOVE "y"		 TO REP-ALPH (2).
015580	     MOVE X"B9" 	 TO REP-ALPH (3).
015580	     MOVE X"F9" 	 TO REP-ALPH (4).
019580       PERFORM AJ05.
019590	     MOVE "3A"		 TO REP-HEX (1).
019600	     MOVE "7A"		 TO REP-HEX (2).
019610	     MOVE "BA"		 TO REP-HEX (3).
019620	     MOVE "FA"		 TO REP-HEX (4).
019630	     MOVE ":"		 TO REP-ALPH (1).
019640	     MOVE "z"		 TO REP-ALPH (2).
015580	     MOVE X"BA" 	 TO REP-ALPH (3).
015580	     MOVE X"FA" 	 TO REP-ALPH (4).
019650       PERFORM AJ05.
019660	     MOVE "3B"		 TO REP-HEX (1).
019670	     MOVE "7B"		 TO REP-HEX (2).
019680	     MOVE "BB"		 TO REP-HEX (3).
019690	     MOVE "FB"		 TO REP-HEX (4).
019700	     MOVE ";"		 TO REP-ALPH (1).
019710	     MOVE "{"		 TO REP-ALPH (2).
015580	     MOVE X"BB" 	 TO REP-ALPH (3).
015580	     MOVE X"FB" 	 TO REP-ALPH (4).
019720       PERFORM AJ05.
019730	     MOVE "3C"		 TO REP-HEX (1).
019740	     MOVE "7C"		 TO REP-HEX (2).
019750	     MOVE "BC"		 TO REP-HEX (3).
019760	     MOVE "FC"		 TO REP-HEX (4).
019770	     MOVE "<"		 TO REP-ALPH (1).
019780	     MOVE "|"		 TO REP-ALPH (2).
015580	     MOVE X"BC" 	 TO REP-ALPH (3).
015580	     MOVE X"FC" 	 TO REP-ALPH (4).
019790       PERFORM AJ05.
019800	     MOVE "3D"		 TO REP-HEX (1).
019810	     MOVE "7D"		 TO REP-HEX (2).
019820	     MOVE "BD"		 TO REP-HEX (3).
019830	     MOVE "FD"		 TO REP-HEX (4).
019840	     MOVE "="		 TO REP-ALPH (1).
019850	     MOVE "}"		 TO REP-ALPH (2).
015580	     MOVE X"BD" 	 TO REP-ALPH (3).
015580	     MOVE X"FD" 	 TO REP-ALPH (4).
019860       PERFORM AJ05.
019870	     MOVE "3E"		 TO REP-HEX (1).
019880	     MOVE "7E"		 TO REP-HEX (2).
019890	     MOVE "BE"		 TO REP-HEX (3).
019900	     MOVE "FE"		 TO REP-HEX (4).
019910	     MOVE ">"		 TO REP-ALPH (1).
019920	     MOVE "~"		 TO REP-ALPH (2).
015580	     MOVE X"BE" 	 TO REP-ALPH (3).
015580	     MOVE X"FE" 	 TO REP-ALPH (4).
019930       PERFORM AJ05.
019940	     MOVE "3F"		 TO REP-HEX (1).
019950	     MOVE "7F"		 TO REP-HEX (2).
019960	     MOVE "BF"		 TO REP-HEX (3).
019970	     MOVE "FF"		 TO REP-HEX (4).
019980	     MOVE "?"		 TO REP-ALPH (1).
019990	     MOVE "DEL" 	 TO REP-GRAPH (2).
015580	     MOVE X"BF" 	 TO REP-ALPH (3).
015580	     MOVE X"FF" 	 TO REP-ALPH (4).
020000       PERFORM AJ05.
020010	     MOVE SPACES	 TO REP-DETAIL.
020020       WRITE REP-L1 BEFORE PAGE.
022120       CLOSE PRNREP.

020030 AJ999.
020040       EXIT.
      /    *************************************************************
      *    *****	       RECOVERY INITIALIZE		   *****
      *    *************************************************************
020050 AK000                   SECTION 57.
020060 AK00.
022090       CLOSE PARAM.
022110	     CLOSE SECUR.
	     MOVE WS-SYS-ID	 TO W02-SYSID.
	     OPEN I-O APACFIDS.
020070	   IF PAR-PROG (WS-S1) = "DB" OR "DS"
	       MOVE "UTP\LEDREB" TO WS-NEXT-PRG
020250	       CALL WS-NEXT-PRG
		  USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY
	       CANCEL WS-NEXT-PRG
	       MOVE "UTP\TAXREB" TO WS-NEXT-PRG
020250	       CALL WS-NEXT-PRG
		  USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY
	       CANCEL WS-NEXT-PRG
020080	       DISPLAY (12, 12) "Loading DEBTOR recovery"
	       MOVE "UTP\DTPREC" TO WS-NEXT-PRG
020100     ELSE
020110     IF PAR-PROG (WS-S1) = "CR" OR "CS"
020120         DISPLAY (12, 12) "Loading CREDITOR recovery"
	       MOVE "UTP\CRPREC" TO WS-NEXT-PRG
020140	   ELSE
020150	   IF PAR-PROG (WS-S1) = "JC"
020160	       DISPLAY (12, 12) "Loading JOB COSTING recovery"
020170	       MOVE "UTP\JCPREC" TO WS-NEXT-PRG
020180     ELSE
020190     IF PAR-PROG (WS-S1) = "ST"
020200         DISPLAY (12, 12) "Loading STOCK recovery"
	       MOVE "UTP\STPREC" TO WS-NEXT-PRG
020220     ELSE
020230     IF PAR-PROG (WS-S1) = "GL" OR "CG"
020240         DISPLAY (12, 12) "Loading G/LEDGER recovery"
	       MOVE "UTP\GLPREC" TO WS-NEXT-PRG.
020250	     CALL WS-NEXT-PRG
		  USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY.
	     CANCEL WS-NEXT-PRG.
	     CLOSE APACFIDS.

       AK999.
	     EXIT.
      /    *************************************************************
      *    *****	     A P A C   MARKETING SCREEN		    ****
      *    *************************************************************
020260 AL000	     SECTION 58.
020270 AL00.
020280       ACCEPT WS-START FROM TIME.
020290	     MOVE 223		 TO W40-DEC.
020300	     MOVE 1		 TO WS-S1.

020310 AL05.
020320	     MOVE W40-CHAR	 TO WS-GCHAR (WS-S1).
020330     IF WS-S1 < 20
020340	       ADD 1		 TO WS-S1
020350         GO TO AL05.
014170	     MOVE 2		 TO WS-S1.

014180 AL05A.
014190	     MOVE WS-G1 	 TO WS-TCHAR (WS-S1)
				    WS-BCHAR (WS-S1).
	     MOVE WS-G8 	 TO WS-TCH   (WS-S1)
				    WS-BCH   (WS-S1).
014200     IF WS-S1 < 79
014210	       ADD 1		 TO WS-S1
014220         GO TO AL05A.
	     MOVE WS-G9 	 TO WS-TCH  (1).
	     MOVE WS-G10	 TO WS-TCH  (80).
	     MOVE WS-G11	 TO WS-BCH  (1).
	     MOVE WS-G12	 TO WS-BCH  (80).
014230	     MOVE WS-G15	 TO WS-TCHAR (1).
014240	     MOVE WS-G16	 TO WS-TCHAR (80).
014250	     MOVE WS-G17	 TO WS-BCHAR (1).
014260	     MOVE WS-G18	 TO WS-BCHAR (80).
	   IF NOT LS-INSTR = "X"
020360	       DISPLAY APAC.
021870	     MOVE ALL "ฐ"	 TO WS-MID-LINE.
	     MOVE WS-G3 	 TO WS-MCHR (1) WS-MCHR (80).
020510	     MOVE ZERO		 TO WS-S1 WS-S2.
	     MOVE L05-COMMAND	 TO W05-COMMAND.
020540	     MOVE 1		 TO WS-S1 WS-S2.
020550	     MOVE ZERO		 TO W05-DRAW.

020560 AL10.
020570     IF W05-CHAR (WS-S1) = "*"
020580         GO TO AL15.
020590     IF WS-S1 < 117
020600	       ADD 1		 TO WS-S1
020610         GO TO AL10.
020620       GO TO AL30.

020630 AL15.
020640	     ADD 2		 TO WS-S1.

020650 AL20.
020660     IF W05-CHAR (WS-S1) = "," OR " "
020670         GO TO AL25.
020680	     MOVE W05-CHAR (WS-S1)
				 TO W05-DC (WS-S2).
           IF WS-S2 < 2
	       ADD 1		 TO WS-S2
           ELSE
020690         GO TO AL30.

020700 AL25.
020710     IF WS-S1 < 128
020720	       ADD 1		 TO WS-S1
020730         GO TO AL20.

020740 AL30.
020750     IF W05-DRW NOT NUMERIC
020760	       MOVE 0		 TO W05-DRAW
020770     ELSE
020780     IF W05-DRAW > 39
020790	       MOVE 40		 TO W05-DRAW.
020800	     MOVE ZERO		 TO WS-S1.

020810 AL35.
020820       CALL X"D9" USING WS-CONSOLE.
020830     IF WS-CONSOLE NOT = ZERO
020840	       ACCEPT WS-OPTION WITH AUTO
020850         GO TO AL40.
020860	     ADD 1		 TO WS-S1 WS-S2.
020870     ACCEPT WS-END FROM TIME.
020880	   SUBTRACT WS-START	 FROM WS-END.
	   IF LS-INSTR = "X"
	       GO TO AL999.
020890	   IF WS-END < 400
020900         GO TO AL35.

020910 AL40.
020920       DISPLAY SPACE AT 0101.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ D O   N O T   D I S P L A Y   E R R O R   M E S S A G E S ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 44		 TO USER-NUMBER.
	     MOVE 1		 TO USER-SETTING.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	   S e t   u p	 t h e	 F U N C T I O N   k e y s     ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 1		 TO USER-ACTION
				    USER-SETTING.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		       ESC, F1 to F10 keys		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE ZERO		 TO USER-NUMBER.
	     MOVE 11		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		    PAGE-UP and PAGE-DOWN keys		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 53		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		   A C T I V A T E   M O U S E		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 64		 TO MOUSE-FUNC.
	     MOVE 1		 TO MOUSE-PARAM.
	     CALL X"AF" USING MOUSE-FUNC
			      MOUSE-PARAM.
	   IF MOUSE-FUNC NOT = 255
	       MOVE "Y"		 TO MOUSE-ATTACHED
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 0		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM
	   ELSE
	       GO TO AL999.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	       Set MOUSE key to act as FUNCTION key	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 3		 TO USER-ACTION.
	     MOVE 27		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.

020930 AL999.
020940     EXIT.
      /    *************************************************************
      *    *****		CLEAR THE USER LOG		   *****
      *    *************************************************************
020950 AM000                   SECTION 59.
020960 AM00.
020970       DISPLAY CLR-SCREEN.
020980     IF WS-INIT NOT = 2
020990         GO TO AM999.
021000	     DISPLAY "Clear the Work Station Log" AT 0329
021010		      WITH FOREGROUND-COLOR 7 HIGHLIGHT .
021020	     MOVE SPACES	 TO W40-CSHPASS.
021030       DISPLAY S06.
021040       DISPLAY "Do you wish to continue Y/N > <" AT 2512
021050		      WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 14.

021060 AM02.
021070	     ACCEPT WS-OPTION AT 2541
		    WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 15 AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
021130	   IF NOT (WS-OPTION = "N" OR "Y")
021140         GO TO AM02.
021150	   IF WS-OPTION = "N"
021160         GO TO AM999.

021170 AM05.
021180       ACCEPT S07.
021190	     MOVE 6		 TO WS-LENGTH.
	     CALL "CBL_TOUPPER" USING W40-CSHPASS
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
021250	     MOVE 1		 TO WS-LENGTH.
021260	     MOVE 5		 TO WS-PARKEY.

021270 AM06.
021280       READ PARAM.
021290     IF RUNTIME-ERROR
021300         IF RECORD-LOCKED
021310             GO TO AM06.
021320     IF WS-STATUS NOT = "00"
021330	       MOVE "Disk error - AM05 (PARAM)"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
021340         STOP RUN.
	     MOVE 1		 TO WS-S1.

       AM07.
	     MOVE PAR-SUPER (WS-S1)
				 TO W85-SUPER (WS-S1).
           IF WS-S1 < 9
	       ADD 1		 TO WS-S1
               GO TO AM07.
021360     IF NOT (W40-CSHPASS = W85-SUPER (1) OR
021370                           W85-SUPER (2) OR
021380                           W85-SUPER (3) OR
021390                           W85-SUPER (4) OR
021400                           W85-SUPER (5) OR
021410                           W85-SUPER (6) OR
021420                           W85-SUPER (7) OR
021430                           W85-SUPER (8) OR
021440                           W85-SUPER (9) OR
021450                           "!@#$%^")
021460         DISPLAY (14, 12) "Invalid password - press any key"
021470                           WITH FOREGROUND-COLOR 14
	       CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS
021490	       GO TO AM999.
021500	     MOVE 4		 TO WS-PARKEY.

021510 AM08.
021520       READ PARAM LOCK.
021530     IF RUNTIME-ERROR
021540         IF RECORD-LOCKED
021550             GO TO AM08.
021560	     MOVE 1		 TO WS-S1.
021570	     MOVE 0		 TO WS-S2.
021580     IF PAR-USERS = 0
021590         GO TO AM20.
021610	     DISPLAY "Recoveries required for W/St" AT 1212.
021620	     MOVE 1241		 TO CPOS.

021630 AM10.
021640     IF PAR-USR (WS-S1) = WS-USER
021650	       ADD 1		 TO PAR-USERS
021660         GO TO AM15.
021670     IF PAR-USR (WS-S1) = SPACES
021680         GO TO AM15.
021690     IF PAR-PROG (WS-S1) NOT = SPACES
021700	       ADD 1		 TO PAR-USERS
021710         DISPLAY PAR-USR (WS-S1) AT CPOS WITH FOREGROUND-COLOR 14
021720	       ADD 4		 TO CCOL
021730     ELSE
021740	       MOVE SPACES	 TO PAR-USR (WS-S1).

021750 AM15.
021760     IF WS-S1 < 24
021770	       ADD 1		 TO WS-S1
021780         GO TO AM10.

       AM18.
021850       DISPLAY "Recoveries must be done before continuing - Press 
021860-              "ENTER" AT 2312 WITH FOREGROUND-COLOR 14.
021880	     ACCEPT WS-OPTION AT 2368 WITH FOREGROUND-COLOR 15 AUTO.
	     DISPLAY WS-BLNK78 AT 2302 WITH FOREGROUND-COLOR 3.
021890	     MOVE SPACES	 TO PAR-USR (WS-USUB).
021900	     SUBTRACT 1 	 FROM PAR-USERS.
021910	     MOVE ZERO		 TO PAR-LOGON.
             GO TO AM25.

021790 AM20.
021810	     DISPLAY "W/St Log cleared - Press ENTER" AT 2312
021820                WITH FOREGROUND-COLOR 14.
021830	     ACCEPT WS-OPTION AT 2344 WITH FOREGROUND-COLOR 15 AUTO.
	     DISPLAY WS-BLNK78 AT 2302 WITH FOREGROUND-COLOR 3.

002192 AM25.
021930       REWRITE PAR-RECORD4.
021940     IF PAR-LOGON = ZERO
021950         STOP RUN.

021960 AM999.
021970       EXIT.
      /    *************************************************************
      *    *****	    AMEND NUMBER OF W/STATIONS		   *****
      *    *************************************************************
011610 AN000		       SECTION 60.
011620 AN00.
011630       DISPLAY CLR-SCREEN.
011640	     DISPLAY S17B.
014560     IF (WS0-DTP NOT = 2) AND (WS0-STP NOT = 2) AND
014570        (WS0-CRP NOT = 2) AND (WS0-GLP NOT = 2) AND
014580        (WS0-HPD NOT = 2) AND (WS0-POS NOT = 2) AND
014590        (WS0-JCP NOT = 2) AND (WS0-VHP NOT = 2)
014600	       MOVE "Files not yet initialized"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
014640	       GO TO AN999.
011790	     MOVE 2		 TO WS-SECKEY.

011800 AN02.
011810       READ SECUR LOCK.
011820     IF RUNTIME-ERROR
011830         IF RECORD-LOCKED
011840		   GO TO AN02.
011850     IF WS-STATUS NOT = "00"
011860	       MOVE "Disk error - AN00"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
011870         STOP RUN.
	   IF SEC-DEM > ZERO
014600	       MOVE "System is not registered"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
014640	       GO TO AN999.
	   IF WS0-LEV < 2
	       MOVE 2		 TO WS-S2
	   ELSE
	   IF WS0-LEV < 3
	       MOVE 4		 TO WS-S2
	   ELSE
	   IF WS0-LEV < 4
	       MOVE 10		 TO WS-S2
	   ELSE
	       MOVE 100		 TO WS-S2.
	   IF NOT (SEC-TERMS < WS-S2)
	       MOVE "Maximum W/Stations already installed - ENTER"
				 TO WS-ERR-MES
	       PERFORM ERROR-LENGTH THRU ERROR-EXIT
	       GO TO AN999.
011650	     MOVE "N"		 TO WS-OPTION.

011660 AN03.
011670	     ACCEPT WS-OPTION AT 0524 WITH FOREGROUND-COLOR 15
011680                               UPDATE AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
011740	   IF NOT (WS-OPTION = "N" OR "Y")
011750	       GO TO AN03.
011760	   IF WS-OPTION = "N"
011770	       GO TO AN999.
011780	     DISPLAY (5, 4) "Key in date (DDMMCCYY)"
		     WITH FOREGROUND-COLOR 6 HIGHLIGHT.

011880 AN05.
011890       ACCEPT S10.
011900	     MOVE SEC-DATE	 TO W20-DTE.
011910	     DISPLAY WS-BLNK78 AT 2302 WITH FOREGROUND-COLOR 3.
011920       PERFORM AB000-DATE.
011930     IF WS-ERROR = 1
011940	       MOVE "Invalid date"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
011950	       GO TO AN05.
	     PERFORM SAVE-SCREEN-3.
	     MOVE 12		 TO SHADE-ROW.
	     MOVE 26		 TO SHADE-COL.
	     MOVE 29		 TO SHADE-WIDTH.
	     MOVE 2		 TO SHADE-LINES.
	     DISPLAY "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ" AT 1124
		      WITH FOREGROUND-COLOR 0 BACKGROUND-COLOR 7.
	     DISPLAY "ณ Number of Work Stations     ณ" AT 1224
		      WITH FOREGROUND-COLOR 0 BACKGROUND-COLOR 7.
	     DISPLAY "ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู" AT 1324
		      WITH FOREGROUND-COLOR 0 BACKGROUND-COLOR 7.
	     PERFORM SCREEN-SHADOW.
	     MOVE SEC-TERMS	 TO WS-TERMS.

       AN08.
	     ACCEPT S30.
	   IF WS-TERMS > WS-S2
	       MOVE WS-S2	 TO WS-TERMS.
	   IF WS0-LEV = 0
	       MOVE "JUNIOR"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 1
	       MOVE "ENTRY"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 2
	       MOVE "BASIC"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 3
	       MOVE "STANDARD"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 4
	       MOVE "PREMIUM"	 TO WS-PACK
	   ELSE
	   IF WS0-LEV = 5
	       MOVE "G O L D"	 TO WS-PACK
	   ELSE
	       MOVE "S.MANAG."	 TO WS-PACK.
	     PERFORM RESTORE-SCREEN-3.
	     DISPLAY S25.

012390 AN10.
	     MOVE 3		 TO WS-PARKEY.
006950	     READ PARAM.
006960     IF RUNTIME-ERROR
006970         IF RECORD-LOCKED
006980		   GO TO AN10.
	     MOVE SEC-NUM	 TO PAR-SERIAL WS-SERIAL.
	     MOVE SEC-LEV	 TO PAR-LEV    WS-LEV.
007540	     REWRITE PAR-RECORD3.
	     MOVE WS-TERMS	  TO SEC-TERMS.
012890       REWRITE SEC-REC2.
012900       UNLOCK SECUR.
012910     IF WS-STATUS NOT = "00"
012920	       MOVE "Disk error - AN10"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
012930         STOP RUN.
	     GO TO AN999.

013190 AN999.
013200       EXIT.

       COMPANY-LOOKUP  SECTION 70.
012520 COMPANY-LUP-SCREEN.
011050	     PERFORM SAVE-SCREEN.
	     DISPLAY S-COM.

       COMPANY-LUP-CLR-SCREEN.
	     MOVE 0928		 TO CPOS.
	     PERFORM COMPANY-CRT-EDGE UNTIL CLIN = 21.
	     MOVE 7		 TO SHADE-ROW.
	     MOVE 30		 TO SHADE-COL.
	     MOVE 46		 TO SHADE-WIDTH.
	     MOVE 16		 TO SHADE-LINES.
	     PERFORM SCREEN-SHADOW.
000340	     DISPLAY CLEAR-L25.
000350	     MOVE 9		 TO CLIN.
000360	     MOVE 1		 TO W75-S W75-S1.

       COMPANY-LUP-TAB-LOOP.
	     MOVE SPACES	 TO W75-COM (W75-S1).
           IF W75-S1 < 18
               ADD 1             TO W75-S1
	       GO TO COMPANY-LUP-TAB-LOOP.
             MOVE ZERO           TO W75-S1.
	     MOVE "  !" 	 TO COM-CODE.
006850	     START APCCOM
	       KEY >= COM-CODE.
006860	   IF NOT (WS-STATUS = "00")
	       GO TO COMPANY-NO-RECORD.

       COMPANY-GET-COM-RECORD.
	   IF WS-OPTION = "J"
	       MOVE SPACE	 TO WS-OPTION
	       GO TO COMPANY-SKIP-COM-READ.
006850	     READ APCCOM NEXT	 WITH IGNORE LOCK.
009900	   IF NOT (WS-STATUS = "00")
	       SUBTRACT 1	 FROM W75-S
	       GO TO COMPANY-FULL-SCREEN.

       COMPANY-SKIP-COM-READ.
	     MOVE COM-CODE	 TO W75-COM (W75-S).
	     DISPLAY SD-COM AT LINE CLIN.
027700	   IF CLIN < 20
027710         ADD 1 TO CLIN W75-S
027720	       GO TO COMPANY-GET-COM-RECORD.

       COMPANY-FULL-SCREEN.
001020	     DISPLAY " " AT 2503 WITH FOREGROUND-COLOR 6 HIGHLIGHT
					BACKGROUND-COLOR 3
001030		     " highlight - " WITH FOREGROUND-COLOR 1
					  BACKGROUND-COLOR 3
		     "PgUp" WITH FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 3
		     "/" WITH FOREGROUND-COLOR 1 BACKGROUND-COLOR 3
		     "PgDn" WITH FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 3
		     " - " WITH FOREGROUND-COLOR 1 BACKGROUND-COLOR 3
001170		     "Esc" WITH FOREGROUND-COLOR 6 HIGHLIGHT
				BACKGROUND-COLOR 3
		     "ape" WITH FOREGROUND-COLOR 1 BACKGROUND-COLOR 3.

       COMPANY-SAVE-FULL-SCREEN.
	     PERFORM SAVE-SCREEN-2.
	     MOVE 0		 TO W75-S1.
	     MOVE 0930		 TO CPOS.

       COMPANY-CRT-ATTRIB.
             MOVE 1920           TO W41-LENGTH.
	     CALL "CBL_WRITE_SCR_ATTRS" USING SAVE-POS
					      W42-ATTRIB2
					      W41-LENGTH
					RETURNING WS-STATUS.
	     MOVE 2000		 TO W41-LENGTH.

       COMPANY-GET-USER-OPT.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.
	     DISPLAY CLEAR-L25.
	   IF ADIS-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN UP-KEY
		     GO TO COMPANY-ADJ-NO-KEYS
		 WHEN DOWN-KEY
001340		     GO TO COMPANY-CHK-NO-KEYS
		 WHEN ENTER-KEY
		 WHEN CR-KEY
		     GO TO COMPANY-RESTORE-SCREEN
		 WHEN OTHER	 CALL X"E5"
	       END-EVALUATE
	       GO TO COMPANY-GET-USER-OPT
	   ELSE
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		     GO TO COMPANY-RESTORE-SCREEN
		 WHEN PAGE-DOWN
001340		     GO TO COMPANY-GET-NEXT-PAGE
		 WHEN PAGE-UP
001340		     GO TO COMPANY-GET-PREV-PAGE
		 WHEN OTHER	 CALL X"E5"
	       END-EVALUATE
	       GO TO COMPANY-GET-USER-OPT.
	     CALL X"E5".
001280	     GO TO COMPANY-GET-USER-OPT.

001240 COMPANY-GET-NEXT-PAGE.
	   IF W75-S < 12
	       GO TO COMPANY-GET-USER-OPT.

       COMPANY-NEW-PAGE.
	     MOVE 0929		 TO CPOS.
	     PERFORM COMPANY-CRT-EDGE UNTIL CLIN = 21.
	     MOVE 9		 TO CLIN.
	     MOVE LOW-VALUES	 TO W75-KEYS.
	     MOVE 1		 TO W75-S W75-S1.
	     PERFORM COMPANY-LUP-TAB-LOOP.
027830	     GO TO COMPANY-GET-COM-RECORD.

       COMPANY-GET-PREV-PAGE.
             MOVE 1              TO WS-IXS1.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		SET OPTION TO BYPASS THE READ NEXT	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE "J"		 TO WS-OPTION.

       COMPANY-GET-PREV-LOOP.
006850	     READ APCCOM PREVIOUS
				 WITH IGNORE LOCK.
009900	   IF NOT (WS-STATUS = "00")
	       MOVE SPACE	 TO WS-OPTION
	       GO TO COMPANY-NEW-PAGE.
	   IF WS-IXS1 < 24
               ADD 1             TO WS-IXS1
	       GO TO COMPANY-GET-PREV-LOOP.
	     GO TO COMPANY-NEW-PAGE.

027970 COMPANY-NO-RECORD.
027730	     MOVE "No company codes"
				 TO WS-ERR-STRING.
003260	     PERFORM ERROR-MESSAGE.
	     GO TO COMPANY-RESTORE-SCREEN.

       COMPANY-ADJ-NO-KEYS.
           IF W75-S1 > 1
               SUBTRACT 1 FROM W75-S1 CLIN.
	     GO TO COMPANY-HIGHLIGHT.

       COMPANY-CHK-NO-KEYS.
	   IF W75-S1 = ZERO
	       MOVE 1		 TO W75-S1
	       GO TO COMPANY-HIGHLIGHT.
           IF W75-S1 < W75-S
	       ADD 1		 TO W75-S1 CLIN.

       COMPANY-HIGHLIGHT.
	     PERFORM COMPANY-CRT-ATTRIB.
	     DISPLAY W43-DET3 (CLIN) AT CPOS
		     WITH BACKGROUND-COLOR 5
			  FOREGROUND-COLOR 7.
	     GO TO COMPANY-GET-USER-OPT.

       COMPANY-CRT-EDGE.
	     DISPLAY "ณ" AT CPOS
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT
			   BACKGROUND-COLOR 7
012890		     "ณ   ณ                                        ณ"
		      WITH BACKGROUND-COLOR 7 FOREGROUND-COLOR 5
		     "ณ" WITH BACKGROUND-COLOR 7 FOREGROUND-COLOR 0.
019260	     ADD 1		 TO CLIN.

       COMPANY-RESTORE-SCREEN.
	   IF NOT (W75-S1 = ZERO)
	       MOVE W75-COM (W75-S1) TO WS-SYS-ID.
011320	     PERFORM RESTORE-SCREEN.

       COMPANY-LOOKUP-EXIT.
             EXIT.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ Set the DEFAULT file PATHS as if  they are present on the ณ
      *    ณ same hard drive as  the  programs.	 This will allow for a ณ
      *    ณ single USER system  or  for  a  network system, where the ณ
      *    ณ programs are run from  the Network drive.	Where programs ณ
      *    ณ are run from a local  drive  on  network  use the program ณ
      *    ณ FILEUTIL to change the paths.			       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
       APACFILES       SECTION 71.
       APAC-FILES-INIT.
	     MOVE WS-SYS-ID	 TO W02-SYSPTH W02-CHK-ID.
	     MOVE ZERO		 TO WS-ERROR.
	     OPEN I-O APACFILE.
	   IF NOT (WS-STATUS = "00")
	       MOVE W02-CHECK-SYS
				 TO W02-SYSTEM
	       OPEN I-O SECUR
	       IF NOT (WS-STATUS = "00")
		   MOVE 9	 TO WS-ERROR
		   GO TO APACFILES-EXIT
	       ELSE
		   CLOSE SECUR
	       END-IF
	       OPEN OUTPUT APACFILE
	       CLOSE APACFILE
	       PERFORM APAC-CREATE-NEW THRU APAC-CREATE-NEW-EXIT
	       GO TO APAC-FILES-INIT.
	     MOVE "SYSTEM"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       GO TO APAC-ERROR-MESSAGE.
	     MOVE SPACES	 TO W02-SYSTEM.
	     STRING APAC-PATH DELIMITED BY " "
		    APAC-NAME DELIMITED BY " "
		    INTO W02-SYSTEM.
	     MOVE "PARAM"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       GO TO APAC-ERROR-MESSAGE.
	     MOVE SPACES	 TO W02-PARAM.
	     STRING APAC-PATH DELIMITED BY " "
		    APAC-NAME DELIMITED BY " "
		    INTO W02-PARAM.
	     MOVE "SHARED"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "SHARED"	 TO APAC-KEY
	       MOVE "SHARED.DAT" TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "LEDTRG"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
		  KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "LEDTRG"	 TO APAC-KEY
	       MOVE "LTRG_XXX.DAT"
				 TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "TRFOUT"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
		  KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "TRFOUT"	 TO APAC-KEY
	       MOVE "TRFOUT.DAT" TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "TRFRIN"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
		  KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "TRFRIN"	 TO APAC-KEY
	       MOVE "TRFRIN.DAT" TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "TERMINAL"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "TERMINAL"	 TO APAC-KEY
	       MOVE "TRMNAL.DAT" TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "PICSLIP"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "PICSLIP"	 TO APAC-KEY
	       MOVE "PICSLP.DAT" TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "DEBPRF"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "DEBPRF"	 TO APAC-KEY
	       MOVE "DEBPRF.DAT" TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "RECEIPTS"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "RECEIPTS"	 TO APAC-KEY
	       MOVE "RECP_XXX.WRK"
				 TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_WORK\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     MOVE "STXOLD"	 TO APAC-KEY.
000030	     READ APACFILE WITH IGNORE LOCK
	       KEY IS APAC-KEY.
	   IF NOT (WS-STATUS = "00")
	       MOVE "STXOLD"	 TO APAC-KEY
	       MOVE "IN_ADJ.OLD" TO APAC-NAME
	       MOVE SPACES	 TO APAC-PATH
	       STRING WS-SYS-ID DELIMITED SIZE
		      "_DATA\" DELIMITED SIZE
		      INTO APAC-PATH
	       WRITE APAC-RECORD1
	       MOVE WS-SYS-ID	 TO W02-SYSID
	       OPEN I-O APACFIDS
	       MOVE APAC-KEY	 TO AFID-KEY
	       MOVE SPACES	 TO AFID-PATH
	       STRING APAC-PATH DELIMITED BY " "
		      APAC-NAME DELIMITED BY " "
		      INTO AFID-PATH
	       WRITE AFID-RECORD1
	       CLOSE APACFIDS.
	     CLOSE APACFILE.
	     GO TO APACFILES-EXIT.

       APAC-ERROR-MESSAGE.
006260	     STRING "Missing " DELIMITED SIZE
		     APAC-KEY DELIMITED BY " "
		     " file ID - Status " DELIMITED SIZE
		     WS-STATUS DELIMITED SIZE
		     INTO WS-ERR-MES.
	     PERFORM ERROR-LENGTH THRU ERROR-EXIT.
006370	     STOP RUN.

       APAC-CREATE-NEW.
	     OPEN I-O APACFILE.
	     MOVE "ASSETT"	 TO APAC-KEY.
	     MOVE "ASSETT.DAT"	 TO APAC-NAME.
	     MOVE 11		 TO APAC-FILE.
	     MOVE SPACES	 TO APAC-PATH.
	     STRING WS-SYS-ID DELIMITED SIZE
		    "_DATA\" DELIMITED SIZE
		    INTO APAC-PATH.

       APAC-WRITE-APACFILE.
	     WRITE APAC-RECORD1.

       APAC-DATA-FILES.
	     MOVE "AUDITF"	 TO APAC-KEY.
	     MOVE "AUDIT.DAT"	 TO APAC-NAME.
	     MOVE 16		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "BARCOD"	 TO APAC-KEY.
	     MOVE "BARCODE.DAT"	 TO APAC-NAME.
	     MOVE 57		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PURDEX"	 TO APAC-KEY.
	     MOVE "CARDEXPR.DAT" TO APAC-NAME.
	     MOVE 56		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CARDEX"	 TO APAC-KEY.
	     MOVE "CARDEXSL.DAT" TO APAC-NAME.
	     MOVE 43		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CATITM"	 TO APAC-KEY.
	     MOVE "CATITM.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CATLOG"	 TO APAC-KEY.
	     MOVE "CATLOG.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CHEQUE"	 TO APAC-KEY.
	     MOVE "CHEQUE.DAT"	 TO APAC-NAME.
	     MOVE 36		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CHQBATCH"	 TO APAC-KEY.
	     MOVE "CHQBCH.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CHQBCH"	 TO APAC-KEY.
	     MOVE "CHQBCH_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "NETWORK"	 TO APAC-KEY.
	     MOVE "CONTROL.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CRDMEM"	 TO APAC-KEY.
	     MOVE "AP_MEMO.DAT"	 TO APAC-NAME.
	     MOVE 6		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "CRDMEM.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AP_MEMO.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "CRDMEM.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AP_MEMO.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "CREDIT"	 TO APAC-KEY.
	     MOVE "AP_ACNT.DAT"	 TO APAC-NAME.
	     MOVE 7		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "CREDIT.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AP_ACNT.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "CREDIT.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AP_ACNT.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "CRTRAN"	 TO APAC-KEY.
	     MOVE "AP_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 8		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "CRTRAN.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AP_TRAN.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "CRTRAN.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AP_TRAN.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "CSBOOK"	 TO APAC-KEY.
	     MOVE "CSBOOK.DAT"	 TO APAC-NAME.
	     MOVE 29		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CSTRAN"	 TO APAC-KEY.
	     MOVE "CSTRAN.DAT"	 TO APAC-NAME.
	     MOVE 30		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DBFOTO"	 TO APAC-KEY.
	     MOVE "AR_CONT.DAT"	 TO APAC-NAME.
	     MOVE 3		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DBFOTO.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_CONT.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DBFOTO.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_CONT.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "DBTRAN"	 TO APAC-KEY.
	     MOVE "AR_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 4		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DBTRAN.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_TRAN.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DBTRAN.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_TRAN.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "DEBCOL"	 TO APAC-KEY.
	     MOVE "AR_COL.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBCOL.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_COL.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBCOL.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_COL.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "DEBHIS"	 TO APAC-KEY.
	     MOVE "AR_HIST.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBHIS.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_HIST.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBHIS.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_HIST.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "DEBMEM"	 TO APAC-KEY.
	     MOVE "AR_MEMO.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBMEM.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_MEMO.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBMEM.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_MEMO.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "DEBORD"	 TO APAC-KEY.
	     MOVE "AR_ORD.DAT"	 TO APAC-NAME.
	     MOVE 53		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBORD.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_ORD.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBORD.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_ORD.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "DEBTOR"	 TO APAC-KEY.
	     MOVE "AR_ACNT.DAT"	 TO APAC-NAME.
	     MOVE 2		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBTOR.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_ACNT.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "DEBTOR.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "AR_ACNT.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "DEPART"	 TO APAC-KEY.
	     MOVE "DEPART.DAT"	 TO APAC-NAME.
	     MOVE 38		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "EGGSLE"	 TO APAC-KEY.
	     MOVE "EGGSLE.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GACCNT"	 TO APAC-KEY.
	     MOVE "GL_ACNT.DAT"	 TO APAC-NAME.
	     MOVE 12		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GACCNT.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_ACNT.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GACCNT.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_ACNT.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "GARTEE"	 TO APAC-KEY.
	     MOVE "GARTEE.DAT"	 TO APAC-NAME.
	     MOVE 9		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLBHDR"	 TO APAC-KEY.
	     MOVE "GL_BHDR.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GLBHDR.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_BHDR.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GLBHDR.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_BHDR.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "GLBTCH"	 TO APAC-KEY.
	     MOVE "GLBTCH_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLCHEQ"	 TO APAC-KEY.
	     MOVE "GLCHEQ_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLDEPO"	 TO APAC-KEY.
	     MOVE "GLDEPO_1.DAT" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLINST"	 TO APAC-KEY.
	     MOVE "GL_INST.DAT"	 TO APAC-NAME.
	     MOVE 15		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GLINST.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_INST.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GLINST.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_INST.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "GLTRAN"	 TO APAC-KEY.
	     MOVE "GL_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 13		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GLTRAN.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_TRAN.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GLTRAN.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_TRAN.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "GPDCHQ"	 TO APAC-KEY.
	     MOVE "GL_PDCHQ.DAT" TO APAC-NAME.
	     MOVE 45		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GPDCHQ.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_PDCHQ.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GPDCHQ.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "GL_PDCHQ.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "INVOIC"	 TO APAC-KEY.
	     MOVE "INVOICE.DAT"	 TO APAC-NAME.
	     MOVE 22		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "ITEMS"	 TO APAC-KEY.
	     MOVE "ITEMS.DAT"	 TO APAC-NAME.
	     MOVE 57		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JCHIST"	 TO APAC-KEY.
	     MOVE "JCHIST.DAT"	 TO APAC-NAME.
	     MOVE 58		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JCLINE"	 TO APAC-KEY.
	     MOVE "JCLINE.DAT"	 TO APAC-NAME.
	     MOVE 59		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBCST"	 TO APAC-KEY.
	     MOVE "JOBLIN.DAT"	 TO APAC-NAME.
	     MOVE 25		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBAUD"	 TO APAC-KEY.
	     MOVE "JOBAUD.DAT"	 TO APAC-NAME.
	     MOVE 24		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBHDR"	 TO APAC-KEY.
	     MOVE "JOBHDR.DAT"	 TO APAC-NAME.
	     MOVE 21		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBREQ"	 TO APAC-KEY.
	     MOVE "JOBREQ.DAT"	 TO APAC-NAME.
	     MOVE 26		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBRMK"	 TO APAC-KEY.
	     MOVE "JOBRMK.DAT"	 TO APAC-NAME.
	     MOVE 27		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBSTAT"	 TO APAC-KEY.
	     MOVE "JOBSTAT.DAT"	 TO APAC-NAME.
	     MOVE 60		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBTECH"	 TO APAC-KEY.
	     MOVE "JOBTECH.DAT"	 TO APAC-NAME.
	     MOVE 61		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBWAR"	 TO APAC-KEY.
	     MOVE "JOBWAR.DAT"	 TO APAC-NAME.
	     MOVE 28		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "LEDTRF"	 TO APAC-KEY.
	     MOVE "LEDTRF.DAT"	 TO APAC-NAME.
	     MOVE 40		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "LEDTRG"	 TO APAC-KEY.
	     MOVE "LTRG_XXX.DAT" TO APAC-NAME.
	     MOVE 40		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PARAM"	 TO APAC-KEY.
	     MOVE "PARAM.DAT"	 TO APAC-NAME.
	     MOVE 1		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PDCHEQ"	 TO APAC-KEY.
	     MOVE "PDCHEQ.DAT"	 TO APAC-NAME.
	     MOVE 44		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PORDER"	 TO APAC-KEY.
	     MOVE "PORDER.DAT"	 TO APAC-NAME.
	     MOVE 10		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "POSPLU"	 TO APAC-KEY.
	     MOVE "POSPLU.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "ROUTE"	 TO APAC-KEY.
	     MOVE "ROUTE.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PSLIPS"	 TO APAC-KEY.
	     MOVE "PSLIPS.DAT"	 TO APAC-NAME.
	     MOVE 35		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SORDER"	 TO APAC-KEY.
	     MOVE "SORDER.DAT"	 TO APAC-NAME.
	     MOVE 17		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SPARTS"	 TO APAC-KEY.
	     MOVE "IN_PARTS.DAT" TO APAC-NAME.
	     MOVE 20		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "SPARTS.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "IN_PARTS.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "SPARTS.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "IN_PARTS.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "STKDEX"	 TO APAC-KEY.
	     MOVE "IN_ADJ.DAT"	 TO APAC-NAME.
	     MOVE 46		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "STOCKADJ.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "IN_ADJ.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "STOCKADJ.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "IN_ADJ.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "STKMEM"	 TO APAC-KEY.
	     MOVE "IN_MEMO.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "STKMEM.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "IN_MEMO.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "STKMEM.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "IN_MEMO.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "STOCKF"	 TO APAC-KEY.
	     MOVE "INVENT.DAT"	 TO APAC-NAME.
	     MOVE 5		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "STOCKF.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "INVENT.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "STOCKF.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "INVENT.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "SYSTEM"	 TO APAC-KEY.
	     MOVE "SYSTEM.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SYSUSE"	 TO APAC-KEY.
	     MOVE "USERS.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "SYSUSE.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "USERS.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "SYSUSE.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "USERS.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "TRFOUT"	 TO APAC-KEY.
	     MOVE "TRF_OUT.DAT"	 TO APAC-NAME.
	     MOVE 14		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "TRFRIN"	 TO APAC-KEY.
	     MOVE "TRFR_IN.DAT"	 TO APAC-NAME.
	     MOVE 18		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "TXTRAN"	 TO APAC-KEY.
	     MOVE "TX_TRAN.DAT"	 TO APAC-NAME.
	     MOVE 19		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "TXTRAN.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "TX_TRAN.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "TXTRAN.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "TX_TRAN.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "UNTSLE"	 TO APAC-KEY.
	     MOVE "UNTSLE.DAT"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "VEHICLE"	 TO APAC-KEY.
	     MOVE "VEHICLE.DAT"	 TO APAC-NAME.
	     MOVE 54		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "VSTOCK"	 TO APAC-KEY.
	     MOVE "V_INVENT.DAT" TO APAC-NAME.
	     MOVE 55		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "VSTOCK.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "V_INVENT.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "VSTOCK.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "V_INVENT.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE "WARHSE"	 TO APAC-KEY.
	     MOVE "WARHSE.DAT"	 TO APAC-NAME.
	     MOVE 51		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "WSTOCK"	 TO APAC-KEY.
	     MOVE "W_INVENT.DAT" TO APAC-NAME.
	     MOVE 52		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "WSTOCK.DAT" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "W_INVENT.DAT" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.
	     MOVE SPACES	 TO W02-RENAME-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "WSTOCK.IDX" DELIMITED BY SIZE
		    INTO W02-RENAME-FILE.
	     MOVE SPACES	 TO W02-NEW-FILE.
	     STRING APAC-PATH DELIMITED BY " "
		    "W_INVENT.IDX" DELIMITED BY SIZE
		    INTO W02-NEW-FILE.
004990	     CALL "CBL_RENAME_FILE" USING W02-RENAME-FILE
005000					  W02-NEW-FILE
005030				    RETURNING WS-STATUS.

       APAC-WORK-FILES.
	     MOVE "BULKST"	 TO APAC-KEY.
	     MOVE "BULK_XXX.WRK" TO APAC-NAME.
	     MOVE 59		 TO APAC-FILE.
	     MOVE SPACES	 TO APAC-PATH.
	     STRING WS-SYS-ID DELIMITED SIZE
		    "_WORK\" DELIMITED SIZE
		    INTO APAC-PATH.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CORDER"	 TO APAC-KEY.
	     MOVE "CORD_XXX.WRK" TO APAC-NAME.
	     MOVE 48		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CRETRN"	 TO APAC-KEY.
	     MOVE "CTRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DBTCON"	 TO APAC-KEY.
	     MOVE "DCON_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DPTSALES"	 TO APAC-KEY.
	     MOVE "DSAL_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DEBTEX"	 TO APAC-KEY.
	     MOVE "DBEX_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DEBTOT"	 TO APAC-KEY.
	     MOVE "DTOT_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DEBTRN"	 TO APAC-KEY.
	     MOVE "DTRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DRBTCH"	 TO APAC-KEY.
	     MOVE "DBCH_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLBATCH"	 TO APAC-KEY.
	     MOVE "GBAL_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLJRN"	 TO APAC-KEY.
	     MOVE "GJRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLTRNB"	 TO APAC-KEY.
	     MOVE "GTRB_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "INVSAL"	 TO APAC-KEY.
	     MOVE "INVS_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "LEDTRN"	 TO APAC-KEY.
	     MOVE "LTRN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "MEMDEB"	 TO APAC-KEY.
	     MOVE "DEBM_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "MOVEMT"	 TO APAC-KEY.
	     MOVE "MOVM_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PERFRM"	 TO APAC-KEY.
	     MOVE "PERF_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PRCLAB"	 TO APAC-KEY.
	     MOVE "PLAB_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PRNDISK"	 TO APAC-KEY.
	     MOVE "PRNT_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PURCH"	 TO APAC-KEY.
	     MOVE "PURC_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "RECEIPTS"	 TO APAC-KEY.
	     MOVE "RECP_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "RECOVER"	 TO APAC-KEY.
	     MOVE "RECV_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SALE"	 TO APAC-KEY.
	     MOVE "SALE_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SALEJ"	 TO APAC-KEY.
	     MOVE "SALJ_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SALESMAN"	 TO APAC-KEY.
	     MOVE "SMAN_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SALESTRK"	 TO APAC-KEY.
	     MOVE "STRK_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "STKORD"	 TO APAC-KEY.
	     MOVE "STKO_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "STKSEL"	 TO APAC-KEY.
	     MOVE "STKS_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "STKWRK"	 TO APAC-KEY.
	     MOVE "STOT_XXX.WRK" TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.

       APAC-OLD-FILES.
	     MOVE SPACES	 TO APAC-PATH.
	     STRING WS-SYS-ID DELIMITED SIZE
		    "_DATA\" DELIMITED SIZE
		    INTO APAC-PATH.
	     MOVE "ASSOLD"	 TO APAC-KEY.
	     MOVE "ASSETT.OLD"	 TO APAC-NAME.
	     MOVE ZERO		 TO APAC-FILE.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CAROLD"	 TO APAC-KEY.
	     MOVE "CARDEXSL.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CHQBHOLD"	 TO APAC-KEY.
	     MOVE "CHQBCH_1.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CHQOLD"	 TO APAC-KEY.
	     MOVE "CHEQUE.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CREOLD"	 TO APAC-KEY.
	     MOVE "AP_ACNT.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CRMOLD"	 TO APAC-KEY.
	     MOVE "AP_MEMO.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "CRTOLD"	 TO APAC-KEY.
	     MOVE "AP_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DBFOLD"	 TO APAC-KEY.
	     MOVE "AR_CONT.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DBMOLD"	 TO APAC-KEY.
	     MOVE "AR_MEMO.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DBTOLD"	 TO APAC-KEY.
	     MOVE "AR_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DEBOLD"	 TO APAC-KEY.
	     MOVE "AR_ACNT.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "DEPOLD"	 TO APAC-KEY.
	     MOVE "DEPART.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GACOLD"	 TO APAC-KEY.
	     MOVE "GL_ACNT.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GAROLD"	 TO APAC-KEY.
	     MOVE "GARTEE.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GBHOLD"	 TO APAC-KEY.
	     MOVE "GL_BHDR.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GLBOLD"	 TO APAC-KEY.
	     MOVE "GLBTCH_1.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GPDOLD"	 TO APAC-KEY.
	     MOVE "GL_PDCHQ.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "GTROLD"	 TO APAC-KEY.
	     MOVE "GL_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "INVOLD"	 TO APAC-KEY.
	     MOVE "INVOICE.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "ITMOLD"	 TO APAC-KEY.
	     MOVE "ITEMS.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JAUOLD"	 TO APAC-KEY.
	     MOVE "JOBAUD.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JHDOLD"	 TO APAC-KEY.
	     MOVE "JOBHDR.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JHSOLD"	 TO APAC-KEY.
	     MOVE "JCHIST.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JOBOLD"	 TO APAC-KEY.
	     MOVE "JOBLIN.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JRMOLD"	 TO APAC-KEY.
	     MOVE "JOBRMK.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JRQOLD"	 TO APAC-KEY.
	     MOVE "JOBREQ.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JSTOLD"	 TO APAC-KEY.
	     MOVE "JOBSTAT.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JTCOLD"	 TO APAC-KEY.
	     MOVE "JOBTECH.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "JWAOLD"	 TO APAC-KEY.
	     MOVE "JOBWAR.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "LEDOLD"	 TO APAC-KEY.
	     MOVE "LEDTRF.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PDCOLD"	 TO APAC-KEY.
	     MOVE "PDCHEQ.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PRDOLD"	 TO APAC-KEY.
	     MOVE "CARDEXPR.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "PUROLD"	 TO APAC-KEY.
	     MOVE "PORDER.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SLPOLD"	 TO APAC-KEY.
	     MOVE "PSLIPS.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SOROLD"	 TO APAC-KEY.
	     MOVE "SORDER.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "SPAOLD"	 TO APAC-KEY.
	     MOVE "IN_PARTS.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "STKOLD"	 TO APAC-KEY.
	     MOVE "INVENT.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "STMOLD"	 TO APAC-KEY.
	     MOVE "IN_MEMO.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "STXOLD"	 TO APAC-KEY.
	     MOVE "IN_ADJ.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "TXTOLD"	 TO APAC-KEY.
	     MOVE "TX_TRAN.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "UNTOLD"	 TO APAC-KEY.
	     MOVE "UNTSLE.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "VEHOLD"	 TO APAC-KEY.
	     MOVE "VEHICLE.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "VSTOLD"	 TO APAC-KEY.
	     MOVE "V_INVENT.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "WAROLD"	 TO APAC-KEY.
	     MOVE "WARHSE.OLD"	 TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     MOVE "WSTOLD"	 TO APAC-KEY.
	     MOVE "W_INVENT.OLD" TO APAC-NAME.
	     PERFORM APAC-WRITE-APACFILE.
	     CLOSE APACFILE.

       APAC-CREATE-NEW-EXIT.
	     EXIT.

       APACFILES-EXIT.
	     EXIT.

       APAC-SETUP-PATHS        SECTION 72.
       APAC-SETUP.
	     MOVE WS-SYS-ID	 TO W02-SYSPTH
				    W02-SYSID
				    W02-COMP.
	     CALL "CBL_CREATE_DIR" USING W02-WORK-PTH
				   RETURNING WS-STATUS.
	     OPEN INPUT APACFILE.
	     OPEN OUTPUT APACFIDS.
	     CLOSE APACFIDS.
	     OPEN I-O APACFIDS.
	     MOVE SPACES	 TO APAC-KEY.
000030	     START APACFILE
	       KEY >= APAC-KEY.

       APAC-GET-NEXT-FILE-ID.
000320	     READ APACFILE NEXT WITH IGNORE LOCK.
000350	   IF NOT (WS-STAT1 = "0")
000370	       GO TO APAC-SETUP-END.
	     MOVE APAC-KEY	 TO AFID-KEY.
	     MOVE SPACES	 TO AFID-PATH.
	     STRING APAC-PATH DELIMITED BY " "
		    APAC-NAME DELIMITED BY " "
		    INTO AFID-PATH.
	     WRITE AFID-RECORD1.
	     GO TO APAC-GET-NEXT-FILE-ID.

       APAC-SETUP-END.
	     CLOSE APACFILE
		   APACFIDS.

       APAC-SETUP-EXIT.
	     EXIT.
