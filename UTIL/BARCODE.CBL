       IDENTIFICATION DIVISION.

       PROGRAM-ID. BARCODE.

       DATE-WRITTEN.  January, 1997.

	   This program is used to calculate the check digit for a bar
	   code EAN-13, ITF-14 OR EAN-8.


		   COPYRIGHT NOTICE: COPYRIGHT (C) 1997 - 2008
				     by James William Lemmon.
				       (Id No. 4412165050082).

		   All rights reserved.

		   e-mail jwlemmon@gmail.com.

000050 SECURITY.
		   This program is free software; you can redistribute
		   it and/or modify it under the terms of the GNU General
		   Public License as published by the Free Software
		   Foundation; either version 2 of the License, or (at
		   your option) any later version.

		   This program is distributed in the hope that it will
		   be useful, but WITHOUT ANY WARRANTY; without even the
		   implied warranty of MERCHANTABILITY or FITNESS FOR A
		   PARTICULAR PURPOSE.	See the GNU General Public License
		   for more details.

		   You should have received a copy of the GNU General
		   Public License along with this program; if not, write
		   to the Free Software Foundation, Inc., 59 Temple Place
		   - Suite 330, Boston, MA 02111-1307, USA.

       ENVIRONMENT DIVISION.

       CONFIGURATION SECTION.

000070 SPECIAL-NAMES.
000080		       CURSOR IS CSTART
000090		       CONSOLE IS CRT
		       CRT STATUS IS KEY-STATUS.

000090 INPUT-OUTPUT SECTION.
000100 FILE-CONTROL.

000480	   SELECT PRNREP  ASSIGN W02-PRINTER
                          ORGANIZATION LINE SEQUENTIAL.

      / *** DATA DIVISION ***

       DATA DIVISION.

       FILE SECTION.

000640 FD  PRNREP    LABEL RECORD OMITTED
000430		     LINAGE WS-PGE-LENGTH.

000660 01  R-L1.
000670	   03  R-DETAIL        PIC  X(80).

000680 01  R-L2.
000690     03  R-PGE           PIC X(06).
000700     03  R-PNO           PIC Z(03)9.
000710     03  FILLER          PIC X(10).
000720     03  R-CPY           PIC X(40).
000730     03  FILLER          PIC X(06).
000740     03  R-DATE          PIC X(06).
000750     03  R-DTE           PIC Z9/99/99.

       01  R-L3.
	   03  R-BCODE OCCURS 2.
	       05  R-H1.
		   07  R-BAR-CODE PIC  Z(13)9 BLANK WHEN ZERO.
	       05  FILLER      PIC  X(01).
	       05  R-H2        PIC  X(23).
	       05  FILLER      PIC  X(01).
	   03  FILLER	       PIC  X(02).

       WORKING-STORAGE SECTION.
       77  WS-CHECK	   PIC	X(18)	 VALUE
			   "aeWlimemnomLalismJ".
001710 77  WS-SUB	    PIC  9(04)	  COMP-5.
001710 77  WS-S1	    PIC  9(04)	  COMP-5.
001720 77  WS-S2	    PIC  9(04)	  COMP-5.
001730 77  WS-S3	    PIC  9(04)	  COMP-5.
001740 77  WS-S4	    PIC  9(04)	  COMP-5.
001750 77  WS-S5	    PIC  9(04)	  COMP-5.
001760 77  WS-S6	    PIC  9(04)	  COMP-5.
001770 77  WS-S7	    PIC  9(04)	  COMP-5.
001780 77  WS-S8	    PIC  9(04)	  COMP-5.
       77  WS-PAGE	    PIC  9(04)	  COMP-5.
002570 77  WS-PGE-LENGTH    PIC  9(02)	  VALUE 66.
002020 77  WS-OPEN	    PIC  X(01)	  VALUE "N".
002020 77  WS-OPTION	    PIC  X(01).
002020 77  WS-PRNNO	    PIC  9(01)	  VALUE 1.
003150 77  WS-PRN-NO	    PIC	 X(01)	  COMP-X VALUE 9.
003160 77  WS-PRN-STAT	    PIC	 X(01)	  COMP-X.
002070 77  WS-ERROR	    PIC  9(01)	  VALUE ZERO.

       COPY WS.WS.

       COPY FUNCTION.WS.

003660 01  W02-FID.
003910	   03  W02-PRINTER.
	       05  W02-REPORT PIC X(07) VALUE "PRN".
      *	       "BARCODE".

       COPY W40.WS.

      /
002420 01  WS-DB-LINE.
002430     03  WS-TOP-LNE.
002440         05  WS-TCHR PIC X(01) OCCURS 80.
           03  WS-T-LINE REDEFINES WS-TOP-LNE.
               05  FILLER  PIC X(01).
               05  WS-H-LINE
                           PIC X(78).
               05  FILLER  PIC X(01).
002430     03  WS-TOP-LNE2.
001390	       05  WS-TCR   PIC  X(80) VALUE "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -        "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿".
	   03  WS-TP-LINE2 REDEFINES WS-TOP-LNE2.
               05  FILLER      PIC  X(01).
               05  WS-TOP-COMP PIC  X(40).
001430	       05  FILLER      PIC  X(23).
	       05  WS-WRKHD    PIC  X(11).
001430	       05  FILLER      PIC  X(01).
	       05  WS-WRKST    PIC  X(03).
001430	       05  FILLER      PIC  X(01).
002450	   03  WS-MID-LNE.
002460         05  WS-MCHR PIC X(01) OCCURS 80.
	   03  WS-MST-LNE REDEFINES WS-MID-LNE.
	       05  WS-MST1     PIC  X(01).
	       05  WS-MST78    PIC  X(78).
	       05  WS-MST80    PIC  X(01).
002450	   03  WS-MID-LNE2.
	       05  FILLER      PIC  X(01) VALUE "³".
	       05  WS-BLNK78   PIC  X(78) VALUE ALL "°".
	       05  FILLER      PIC  X(01) VALUE "³".
002470	   03  WS-BOT-LNE.
002480         05  WS-BCHR PIC X(01) OCCURS 80.
           03  WS-B-LINE REDEFINES WS-BOT-LNE.
               05  FILLER  PIC X(01).
               05  WS-F-LINE
                           PIC X(78).
               05  FILLER  PIC X(01).
002470     03  WS-BOT-LNE2.
002480         05  WS-BCH  PIC X(01) OCCURS 80.
003240	   03  WS-B-LINE2 REDEFINES WS-BOT-LNE2.
003250         05  FILLER  PIC X(01).
               05  WS-MEM-LINE.
003260            07  WS-SRT-LINE
003270                     PIC X(50).
                  07  FILLER
                           PIC X(10).
003280         05  FILLER  PIC X(19).
           03  WS-MM-LINE.
               05  FILLER  PIC  X(01) VALUE X"B3".
               05  FILLER  PIC  X(60) VALUE SPACES.
               05  FILLER  PIC  X(01) VALUE X"B3".
           03  WS-HME-LINE PIC  X(60) VALUE ALL X"CD".

       01  BAR-CODE-WORK.
	   03  BAR-CODE-TYPE	 PIC  X(01).
	   03  BAR-CODE 	 PIC  9(14) COMP VALUE ZERO.
	   03  BAR-CODE-CH REDEFINES BAR-CODE
				 PIC  9(01) COMP OCCURS 14.
	   03  BAR-CODE-ITF14 REDEFINES BAR-CODE.
	       05  BAR-CODE-13	 PIC  9(13) COMP.
	       05  BAR-CODE-CHK-DIG  PIC 9(01) COMP.
	   03  BAR-CODE-EAN13 REDEFINES BAR-CODE.
	       05  FILLER	 PIC  9(01) COMP.
	       05  BAR-CODE-12	 PIC  9(12) COMP.
	       05  FILLER	 PIC  9(01) COMP.
	   03  BAR-CODE-EAN8 REDEFINES BAR-CODE.
	       05  FILLER	 PIC  9(06) COMP.
	       05  BAR-CODE-7	 PIC  9(07) COMP.
	       05  FILLER	 PIC  9(01) COMP.
	   03  BAR-CODE-RESULT-1 PIC  9(04) COMP.
	   03  BAR-CODE-RESULT-2 PIC  9(04) COMP.
	   03  BAR-CODE-RESULT-3 PIC  9(04) COMP.
	   03  BAR-CODE-CALC REDEFINES BAR-CODE-RESULT-3.
	       05  BAR-CODE-TEN  PIC  9(03) COMP.
	       05  BAR-CODE-UNIT PIC  9(01) COMP.
	   03  BAR-CODE-COUNT	 PIC  9(06) COMP.
	   03  BAR-CODE-OUT	 PIC  X(01).
	   03  BAR-CODE-COL	 PIC  9(04) COMP-5.
	   03  BAR-CODE-LIN	 PIC  9(04) COMP-5.

       01  BAR-CODE-LIST.
	   03  BAR-CODE-COLUMN OCCURS 2.
	       05  BAR-CODE-LINE OCCURS 60.
		   07  BAR-CODE-NUMB PIC 9(14) COMP.

      / *** SCREEN SECTION ***

       SCREEN SECTION.
      *
      *    ****  THIS SCREEN - CLEARS THE DISPLAY AND SETS THE DEFAULT
      *          COLOUR TO 3 (LIGHT BLUE).
      *
001950 01  CLR-SCREEN.
003170     03  BLANK SCREEN FOREGROUND-COLOR 3
                            BACKGROUND-COLOR 1.
	   03  CLR-L1-2.
003860	   05  LINE  1 COLUMN  1 BACKGROUND-COLOR 0
				 PIC X(80) USING WS-TOP-LNE2.
003870	   05  LINE  2 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
004160	   05	       COLUMN  2 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 4
004170				 VALUE "APAC Utilities".
	   05	       COLUMN 16 PIC  X(51) FROM WS-BACKGROUND.
004180	   05	       COLUMN 66 BACKGROUND-COLOR 7
				 FOREGROUND-COLOR 4
004190				 VALUE "Version - 3.1 ".
003920	   05	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
003930	   03  LINE  3 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
003940	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
003950	   03  LINE  4 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
003960	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
003970	   03  LINE  5 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
003980	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
003990	   03  LINE  6 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004000	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004010	   03  LINE  7 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004020	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004030	   03  LINE  8 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004040	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004050	   03  LINE  9 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004060	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004070	   03  LINE 10 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004080	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004090	   03  LINE 11 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004100	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004110	   03  LINE 12 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004120	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004130	   03  LINE 13 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004140	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004150	   03  LINE 14 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004160	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004170	   03  LINE 15 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004180	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004190	   03  LINE 16 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004200	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004210	   03  LINE 17 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004220	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004230	   03  LINE 18 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004240	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004250	   03  LINE 19 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004260	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004270	   03  LINE 20 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004280	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004290	   03  LINE 21 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004300	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004310	   03  LINE 22 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004320	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
004330	   03  LINE 23 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "³".
	   03	       COLUMN  2 PIC  X(78) FROM WS-BACKGROUND.
004340	   03	       COLUMN 80 BACKGROUND-COLOR 0
				 VALUE "³".
006550	   03  LINE 24 COLUMN  1 BACKGROUND-COLOR 0
				 VALUE "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      - 	     "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ".
	   03  CLEAR-L25.
	   05  LINE 25 BLANK LINE BACKGROUND-COLOR 3
				  FOREGROUND-COLOR 1.

       01  S-TYPE.
	   03  LINE  4 COLUMN 22 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿".
	   03  LINE  5 COLUMN 22 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "³   CALCULATE BAR CODE CHECK DIGIT  ³".
	   03  LINE  6 COLUMN 22 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´".
	   03  LINE  7 COLUMN 22 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "³ (".
	   03	       COLUMN 25 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "1".
	   03	       COLUMN 26 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE ")=EAN-13, (".
	   03	       COLUMN 37 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "2".
	   03	       COLUMN 38 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE ")=ITF-14, (".
	   03	       COLUMN 49 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE "3".
	   03	       COLUMN 50 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE ")=EAN-8 ³".
	   03  LINE  8 COLUMN 22 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "³      Select BAR CODE type  	    ³".
	   03  LINE  9 COLUMN 22 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 7 VALUE
	       "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ".

       01   S-BCODE.
	   03  LINE  4 COLUMN  9 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE
	       "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -	       "ÄÄÄÄÄÄ¿".

	   03  LINE  5 COLUMN  9 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE "³".
	   03	       COLUMN 10 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE
	       "CALCULATE CHECK DIGITS FOR A RANGE OF BAR CODES AND LIST
      -	       " THEM".
	   03	       COLUMN 71 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE "³".
	   03  LINE  6 COLUMN  9 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE
	       "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -	       "ÄÄÄÄÄÄ´".
	   03  LINE  7 COLUMN  9 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE
	       "³ Starting Number                 Number Required
      -	       "      ³".
	   03  LINE  8 COLUMN  9 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE "³ ".
	   03	       COLUMN 11 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE "P".
	   03	       COLUMN 12 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE "rinter or ".
	   03	       COLUMN 22 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE "S".
	   03	       COLUMN 23 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE
	       "creen                                           ³".

	   03  LINE  9 COLUMN  9 FOREGROUND-COLOR 6 HIGHLIGHT
				 BACKGROUND-COLOR 6 VALUE
	       "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -	       "ÄÄÄÄÄÄÙ".

       01  SA-COUNT.
	   03  LINE  7 COLUMN 59 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 5
				 PIC ZZZZZ9 USING BAR-CODE-COUNT AUTO.

       01  S-BCODE-NUMB.
	   03  LINE 18 COLUMN 24 FOREGROUND-COLOR 3 HIGHLIGHT
				 "Bar code including Check Digit".
	   03  LINE 19 COLUMN 32 FOREGROUND-COLOR 3 HIGHLIGHT
				 PIC Z(13)9 FROM BAR-CODE.

       01  S-PRINTER.
	   03  LINE  6 COLUMN 29 FOREGROUND-COLOR 2 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE
				 "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ".
	   03	       COLUMN 52 FOREGROUND-COLOR 0 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "¿".
	   03  LINE  7 COLUMN 29 FOREGROUND-COLOR 2 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³".
	   03	       COLUMN 30 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE
				 "SELECT PRINTER NUMBER ".
	   03	       COLUMN 52 FOREGROUND-COLOR 0 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³".
	   03  LINE  8 COLUMN 29 FOREGROUND-COLOR 2 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³  ".
	   03	       COLUMN 32 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "1".
	   03	       COLUMN 33 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = LPT1  ".
	   03	       COLUMN 42 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "5".
	   03	       COLUMN 43 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = COM1  ".
	   03	       COLUMN 52 FOREGROUND-COLOR 0 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³".
	   03  LINE  9 COLUMN 29 FOREGROUND-COLOR 2 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³  ".
	   03	       COLUMN 32 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "2".
	   03	       COLUMN 33 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = LPT2  ".
	   03	       COLUMN 42 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "6".
	   03	       COLUMN 43 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = COM2  ".
	   03	       COLUMN 52 FOREGROUND-COLOR 0 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³".
	   03  LINE 10 COLUMN 29 FOREGROUND-COLOR 2 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³  ".
	   03	       COLUMN 32 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "3".
	   03	       COLUMN 33 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = LPT3  ".
	   03	       COLUMN 42 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "7".
	   03	       COLUMN 43 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = COM3  ".
	   03	       COLUMN 52 FOREGROUND-COLOR 0 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³".
	   03  LINE 11 COLUMN 29 FOREGROUND-COLOR 2 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³  ".
	   03	       COLUMN 32 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "4".
	   03	       COLUMN 33 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = LPT4  ".
	   03	       COLUMN 42 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "8".
	   03	       COLUMN 43 FOREGROUND-COLOR 0
				 BACKGROUND-COLOR 2 VALUE " = COM4  ".
	   03	       COLUMN 52 FOREGROUND-COLOR 0 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "³".
	   03  LINE 12 COLUMN 29 FOREGROUND-COLOR 2 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE "À".
	   03	       COLUMN 30 FOREGROUND-COLOR 0 HIGHLIGHT
				 BACKGROUND-COLOR 2 VALUE
				 "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ".

       COPY S99.CRT.

       COPY ERROR.CRT.

       COPY OPT.CRT.

      / *** PROCEDURE DIVISION ***

       PROCEDURE DIVISION.
       AA000	       SECTION.
       AA00.
	     DISPLAY CLR-SCREEN.
      *
      *    ****    S E T   U P   T H E   F U N C T I O N   K E Y S
      *
	     MOVE 1		 TO USER-ACTION
				    USER-SETTING.
      *
      *    ESC, F1 to F10 keys
      *
	     MOVE ZERO		 TO USER-NUMBER.
	     MOVE 11		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *
      *    PAGE-UP AND PAGE-DOWN KEYS
      *
	     MOVE 53		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *
      *    ****    A C T I V A T E   M O U S E
      *
	     MOVE 64		 TO MOUSE-FUNC.
	     MOVE 1		 TO MOUSE-PARAM.
	     CALL X"AF" USING MOUSE-FUNC
			      MOUSE-PARAM.
	   IF MOUSE-FUNC NOT = 255
	       MOVE "Y"		 TO MOUSE-ATTACHED
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 0		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM
	   ELSE
	       GO TO AA00A.
      *
      *    ****    S E T   M O U S E   K E Y   T O   A C T
      * 	   A S	 F U N C T I O N   K E Y
      *
	     MOVE 3		 TO USER-ACTION.
	     MOVE 27		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.

       AA00A.
	     MOVE 5		 TO SHADE-ROW.
	     MOVE 24		 TO SHADE-COL.
	     MOVE 35		 TO SHADE-WIDTH.
	     MOVE 5		 TO SHADE-LINES.
	     DISPLAY S-TYPE.
	     PERFORM SCREEN-SHADOW.
	     MOVE "1"		 TO BAR-CODE-TYPE.

       AA05.
	     DISPLAY "Press " AT 2502
		      WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 1
		     "Esc" WITH BACKGROUND-COLOR 3
				FOREGROUND-COLOR 6 HIGHLIGHT
		     "ape to exit"
		      WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 1.
	     ACCEPT BAR-CODE-TYPE AT 0850
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 5 UPDATE AUTO.
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		     GO TO AA999
	       END-EVALUATE.
	     DISPLAY CLEAR-L25.
	   IF BAR-CODE-TYPE < "1" OR > "3"
	       GO TO AA05.
	     DISPLAY CLR-SCREEN.
	     PERFORM SAVE-SCREEN.
	     MOVE 5		 TO SHADE-ROW.
	     MOVE 11		 TO SHADE-COL.
	     MOVE 61		 TO SHADE-WIDTH.
	     MOVE 5		 TO SHADE-LINES.
	     DISPLAY S-BCODE.
	     PERFORM SCREEN-SHADOW.
	     MOVE ZERO		 TO BAR-CODE.

       AA10.
	     DISPLAY "Press " AT 2502
		      WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 1
		     "Esc" WITH BACKGROUND-COLOR 3
				FOREGROUND-COLOR 6 HIGHLIGHT
		     "ape for previous field"
		      WITH BACKGROUND-COLOR 3 FOREGROUND-COLOR 1.
	   IF BAR-CODE-TYPE = "1"
	       ACCEPT BAR-CODE-12 AT 0727
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT
			   BACKGROUND-COLOR 5 UPDATE AUTO
	   ELSE
	   IF BAR-CODE-TYPE = "2"
	       ACCEPT BAR-CODE-13 AT 0727
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT
			   BACKGROUND-COLOR 5 UPDATE AUTO
	   ELSE
	       ACCEPT BAR-CODE-7 AT 0727
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT
			   BACKGROUND-COLOR 5 UPDATE AUTO.
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		     DISPLAY CLR-SCREEN
		     GO TO AA00A
	       END-EVALUATE.
	   IF BAR-CODE < 1
	       GO TO AA10.
	     MOVE 1		 TO BAR-CODE-COUNT.

       AA15.
	     ACCEPT SA-COUNT.
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		     GO TO AA10
	       END-EVALUATE.
	   IF BAR-CODE-COUNT < 1
	       GO TO AA15.
	     MOVE 1		 TO WS-SUB.
	     MOVE "P"		 TO BAR-CODE-OUT.

       AA18.
	     ACCEPT BAR-CODE-OUT AT 0829
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 5 UPDATE AUTO.
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		     GO TO AA15
	       END-EVALUATE.
	     CALL "CBL_TOUPPER" USING BAR-CODE-OUT
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	     DISPLAY CLEAR-L25.
	   IF NOT (BAR-CODE-OUT = "S" OR "P")
	      GO TO AA18.
	   IF BAR-CODE-OUT = "P"
	       PERFORM AA60 THRU AA75
	       IF WS-ERROR = 1
		   MOVE ZERO	 TO WS-ERROR
		   GO TO AA18.
	     MOVE 1		 TO BAR-CODE-COL BAR-CODE-LIN.
	     MOVE ZERO		 TO WS-PAGE.
	     PERFORM AA45 THRU AA50.

       AA20.
	     ADD BAR-CODE-CH (1),
		 BAR-CODE-CH (3),
		 BAR-CODE-CH (5),
		 BAR-CODE-CH (7),
		 BAR-CODE-CH (9),
		 BAR-CODE-CH (11),
		 BAR-CODE-CH (13)
				 GIVING BAR-CODE-RESULT-1.
	     ADD BAR-CODE-CH (2),
		 BAR-CODE-CH (4),
		 BAR-CODE-CH (6),
		 BAR-CODE-CH (8),
		 BAR-CODE-CH (10),
		 BAR-CODE-CH (12)
				 GIVING BAR-CODE-RESULT-2.
	     MULTIPLY 3 	 BY BAR-CODE-RESULT-1.
	     ADD BAR-CODE-RESULT-1
		 BAR-CODE-RESULT-2
				 GIVING BAR-CODE-RESULT-3.
	     SUBTRACT BAR-CODE-UNIT FROM 10
				 GIVING BAR-CODE-CHK-DIG.
	   IF BAR-CODE-OUT = "P"
	       GO TO AA30.
	     DISPLAY S-BCODE-NUMB.

       AA25.
036900	     MOVE "'N'ext, 'C'hange or 'E'nd  [ ]"
				 TO WS-ERR-MES.
	     MOVE SPACE 	 TO WS-OPTION.
	     PERFORM OPT-MESSAGE.
024110	   IF NOT (WS-OPTION = "N" OR "C" OR "E")
024120	       GO TO AA25.
024140	   IF WS-OPTION = "N"
	       IF WS-SUB < BAR-CODE-COUNT
024150		   ADD 1	 TO WS-SUB
				    BAR-CODE-13
024160		   GO TO AA20
	       ELSE
		   DISPLAY CLR-SCREEN
		   GO TO AA00A.
	   IF WS-OPTION = "C"
	       DISPLAY CLR-SCREEN
	       GO TO AA00A.
	     GO TO AA999.

       AA30.
	     MOVE BAR-CODE	 TO BAR-CODE-NUMB
				   (BAR-CODE-COL, BAR-CODE-LIN).
	   IF BAR-CODE-LIN > 59
	       IF BAR-CODE-COL > 1
		   PERFORM AA35 THRU AA50
		   MOVE 1	 TO BAR-CODE-COL BAR-CODE-LIN
	       ELSE
		   MOVE 1	 TO BAR-CODE-LIN
		   MOVE 2	 TO BAR-CODE-COL
	   ELSE
	       ADD 1		 TO BAR-CODE-LIN.
	   IF WS-SUB < BAR-CODE-COUNT
024150	       ADD 1		 TO WS-SUB
				    BAR-CODE-13
024160	       GO TO AA20.
	     PERFORM AA35 THRU AA50.
	     CLOSE PRNREP.
	     MOVE "N"		 TO WS-OPEN.
	     DISPLAY CLR-SCREEN.
	     GO TO AA00A.

       AA35.
	   IF WS-OPEN = "N"
	       MOVE "Y" 	 TO WS-OPEN
	       OPEN OUTPUT PRNREP
	       CALL X"91" USING X91-RES X91-FUN PRNREP.
	     ADD 1		 TO WS-PAGE.
	     MOVE SPACES	 TO R-DETAIL.
	     MOVE "Page:"	 TO R-PGE.
	     MOVE WS-PAGE	 TO R-PNO.
	     MOVE "BAR CODE NUMBERS ALLOCATION LISTING"
				 TO R-CPY.
	     WRITE R-L1 BEFORE 1 LINES.
	     MOVE SPACES	 TO R-DETAIL.
	     MOVE "   Bar code"  TO R-H1 (1) R-H1 (2).
	     MOVE "Description"  TO R-H2 (1) R-H2 (2).
	     WRITE R-L1 BEFORE 2 LINES.
	     MOVE SPACES	 TO R-DETAIL.
	     MOVE 1		 TO WS-S5.

       AA40.
	   IF BAR-CODE-NUMB (1, WS-S5) NOT = ZERO
	       MOVE BAR-CODE-NUMB (1, WS-S5)
				 TO R-BAR-CODE (1)
	       MOVE ALL "_"	 TO R-H2 (1).
	   IF BAR-CODE-NUMB (2, WS-S5) NOT = ZERO
	       MOVE BAR-CODE-NUMB (2, WS-S5)
				 TO R-BAR-CODE (2)
	       MOVE ALL "_"	 TO R-H2 (2).
	     WRITE R-L1 BEFORE 1 LINES.
	     MOVE SPACES	 TO R-DETAIL.
	   IF WS-S5 < 60
	       ADD 1		 TO WS-S5
	       GO TO AA40.
	     WRITE R-L1 BEFORE PAGE.

       AA45.
	     MOVE 1		 TO WS-S5.

       AA50.
	     MOVE ZERO		 TO BAR-CODE-NUMB (1, WS-S5)
				    BAR-CODE-NUMB (2, WS-S5).
	   IF WS-S5 < 60
	       ADD 1		TO WS-S5
	       GO TO AA50.

       AA55.
	     EXIT.

       AA60.
	     PERFORM SAVE-SCREEN-2.
	     MOVE 7		 TO SHADE-ROW.
	     MOVE 31		 TO SHADE-COL.
	     MOVE 22		 TO SHADE-WIDTH.
	     MOVE 6		 TO SHADE-LINES.
	     DISPLAY S-PRINTER.
	     PERFORM SCREEN-SHADOW.

       AA65.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.

       AA70.
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		   GO TO AA75
		 WHEN OTHER	 CALL X"E5"
	       END-EVALUATE
	       GO TO AA65
	   ELSE
	   IF DATA-8BIT
	       MOVE KEY-CODE-1X  TO WS-OPTION
	       IF WS-OPTION < 1 OR > 8
		   CALL X"E5"
		   GO TO AA65
	       END-IF
	   ELSE
	       CALL X"E5"
	       GO TO AA65.
	     MOVE WS-OPTION	 TO WS-PRNNO.
	   IF WS-PRNNO = "1"
	       MOVE ZERO	 TO WS-PRN-NO
	       MOVE "LPT1"	 TO W02-PRINTER
	   ELSE
	   IF WS-PRNNO = "2"
	       MOVE 1		 TO WS-PRN-NO
	       MOVE "LPT2"	 TO W02-PRINTER
	   ELSE
	   IF WS-PRNNO = "3"
	       MOVE 2		 TO WS-PRN-NO
	       MOVE "LPT3"	 TO W02-PRINTER
	   ELSE
	   IF WS-PRNNO = "4"
	       MOVE "LPT4"	 TO W02-PRINTER
	   ELSE
	   IF WS-PRNNO = "5"
	       MOVE "COM1"	 TO W02-PRINTER
	   ELSE
	   IF WS-PRNNO = "6"
	       MOVE "COM2"	 TO W02-PRINTER
	   ELSE
	   IF WS-PRNNO = "7"
	       MOVE "COM3"	 TO W02-PRINTER
	   ELSE
	   IF WS-PRNNO = "8"
	       MOVE "COM4"	 TO W02-PRINTER.
	   IF WS-PRN-NO < 3
	       PERFORM CHECK-FOR-PRINTER
	       IF WS-ERROR = 1
		   GO TO AA75
	       END-IF
	   ELSE
	       MOVE "Waiting for printer response"
				 TO WS-ERR-MES
	       PERFORM OPT-CURSOR THRU OPT-REPLY.
019890	     OPEN OUTPUT PRNREP.
	     CALL X"91" USING X91-RES X91-FUN PRNREP.
	     MOVE "Y"		 TO WS-OPEN.

       AA75.
	     PERFORM RESTORE-SCREEN-2.

       AA999.
	     STOP RUN.

       COPY FUNCTION.CRT.

       COPY OPTION.CRT.

       CHECK-FOR-PRINTER       SECTION 89.
       CHECK-PRINTER.
	     MOVE ZERO		 TO WS-ERROR
				    WS-S1 WS-S2 WS-S3 WS-S4
				    WS-S5 WS-S6 WS-S7 WS-S8.
	     CALL "PC_TEST_PRINTER" USING WS-PRN-NO
					  WS-PRN-STAT
				    RETURNING WS-STATUS.
	   IF WS-PRN-STAT > 127
	       MOVE 1		 TO WS-S1
	       SUBTRACT 128	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 63
	       MOVE 1		 TO WS-S2
	       SUBTRACT 64	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 31
	       MOVE 1		 TO WS-S3
	       SUBTRACT 32	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 15
	       MOVE 1		 TO WS-S4
	       SUBTRACT 16	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 7
	       MOVE 1		 TO WS-S5
	       SUBTRACT 8	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 3
	       MOVE 1		 TO WS-S6
	       SUBTRACT 4	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 1
	       MOVE 1		 TO WS-S7
	       SUBTRACT 2	 FROM WS-PRN-STAT.
	     MOVE WS-PRN-STAT	 TO WS-S8.
	   IF WS-S3 = 0 AND
	      WS-S5 = 0 AND
	      WS-S8 = 0
	       GO TO CHECK-PRINTER-EXIT.

       PRINTER-NOT-READY.
	     MOVE "Check printer! - 'R'etry or 'A'bort  [ ] "
				 TO WS-ERR-MES.
	     PERFORM OPT-MESSAGE.
	   IF NOT (WS-OPTION = "R" OR "A")
	       GO TO PRINTER-NOT-READY.
	     IF WS-OPTION = "A"
		 MOVE 1 	 TO WS-ERROR
		 GO TO CHECK-PRINTER-EXIT.
	       GO TO CHECK-PRINTER.

       CHECK-PRINTER-EXIT.
	     EXIT.
