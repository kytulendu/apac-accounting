      $SET LINKCOUNT"320"
      ******************************************************************
      *                                                                *
      *   *******   *******   *******	  ****	   ******     ****     *
      *   **	**  **	  **  **    **	 **  **   **	**   **  **    *
      *   **	**  **	  **  **    **	**    **       **   **	  **   *
      *   *******   ******    *******	**    **     **     **	  **   *
      *   **	    **	 **   **	**    **   **	    **	  **   *
      *   **	    **	  **  **	 **  **   **	     **  **    *
      *   **	    **	  **  **	  ****	  ********    ****     *
      *                                                                *
      *     ENGLISH                                                    *
      *                                                                *
      *     P R I N T E R   S P E C I F I C A T I O N S 	       *
      *                                                                *
      *     VERSION 8.15.00 - November 2010			       *
      * 							       *
      ******************************************************************
000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.     PRP020.
000030 AUTHOR.         J.W.LEMMON (APAC).
000040 DATE-WRITTEN.   JANUARY 1983.

		   COPYRIGHT NOTICE: COPYRIGHT (C) 1983 - 2010
				     by James William Lemmon.
				       (Id No. 4412165050082).

		   All rights reserved.

		   e-mail jwlemmon@gmail.com.

000050 SECURITY.
		   This program is free software; you can redistribute
		   it and/or modify it under the terms of the GNU General
		   Public License as published by the Free Software
		   Foundation; either version 2 of the License, or (at
		   your option) any later version.

		   This program is distributed in the hope that it will
		   be useful, but WITHOUT ANY WARRANTY; without even the
		   implied warranty of MERCHANTABILITY or FITNESS FOR A
		   PARTICULAR PURPOSE.	See the GNU General Public License
		   for more details.

		   You should have received a copy of the GNU General
		   Public License along with this program; if not, write
		   to the Free Software Foundation, Inc., 59 Temple Place
		   - Suite 330, Boston, MA 02111-1307, USA.

000050 ENVIRONMENT DIVISION.
000060 CONFIGURATION SECTION.
000070 SPECIAL-NAMES.  
000080		       CURSOR IS CSTART
000090		       CONSOLE IS CRT
		       CRT STATUS IS KEY-STATUS.
000090 INPUT-OUTPUT SECTION.
000100 FILE-CONTROL.

       COPY APACFIDS.SL.

000120 COPY CONTROL.SL.

000120 COPY SYSTEM.SL.

000140 COPY PARAM.SL.

000140 COPY PRNTCONT.SL.

000170 DATA DIVISION.
000180 FILE SECTION.

       COPY APACFIDS.FDE.

000120 COPY CONTROL.FDE.

000200 COPY SYSTEM.FD.

000220 COPY PARAM.FDE.

000140 COPY PRNTCONT.FD.

      /
      *         **         **    ******    *******    **    **
      *         **         **   **    **   **    **   **   ** 
      *         **    *    **   **    **   **   **    **  **  
      *         **   ***   **   **    **   ******     *****   
      *          ** ** ** **    **    **   **   **    **  **  
      *           ***   ***     **    **   **    **   **   ** 
      *            *     *       ******    **    **   **    **
      *
000940 WORKING-STORAGE SECTION.
       77  WS-CHECK	   PIC	X(18)	 VALUE
			   "aeWlimemnomLalismJ".
000950 77  WS-S1	       PIC 9(04)     COMP-5.
000960 77  WS-S2               PIC 9(04)     COMP-5.
000970 77  WS-S3               PIC 9(04)     COMP-5.
000980 77  WS-S4               PIC 9(04)     COMP-5.
000990 77  WS-S5               PIC 9(04)     COMP-5.
001000 77  WS-S6               PIC 9(04)     COMP-5.
001000 77  WS-S7	       PIC 9(04)     COMP-5.
001000 77  WS-S8	       PIC 9(04)     COMP-5.
001010 77  WS-PARKEY           PIC 9(04)     COMP-5.
001010 77  WS-PRNKEY           PIC 9(04)     COMP-5.
001010 77  WS-DEPKEY           PIC 9(04)     COMP-5.
001010 77  WS-NETKEY           PIC 9(04)     COMP-5.
001020 77  WS-SECKEY           PIC 9(04)     COMP-5.
001070 77  WS-NUM              PIC Z9.
001070 77  WS-SNO              PIC 9(02).
       77  WS-ADV-RATE         PIC S9(03)V99 COMP-3.
001090 77  WS-PAGE             PIC 9(04)     COMP-5.
001100 77  WS-OPTION	       PIC X(01).
001100 77  WS-VAT-GST          PIC X(01).
001120 77  WS-ERROR            PIC 9(01).
003150 77  WS-PRN-NO	   PIC X(01)	 COMP-X VALUE 9.
003160 77  WS-PRN-STAT	   PIC X(01)	 COMP-X.
001140 77  WS-CHAR1	       PIC X(01).
001150 77  WS-CHAR2            PIC X(01).
001160 77  WS-COMP             PIC 9(01).
001170 77  WS-TYPE             PIC X(01).
001200 77  WS-INDEX-STORE      PIC X(04).
001210 77  WS-INDEX-NAME       PIC X(04).
001220 77  WS-BATCH		PIC 9(05).
       77  TODAY-DDMMYY	   PIC	9(08) COMP-5.
       77  WS-USUB	   PIC	9(04) COMP-5.
      /
002420 01  WS-DB-LINE.
002430     03  WS-TOP-LNE.
002440         05  WS-TCHR PIC X(01) OCCURS 80.
           03  WS-T-LINE REDEFINES WS-TOP-LNE.
               05  FILLER  PIC X(01).
               05  WS-H-LINE
                           PIC X(78).
               05  FILLER  PIC X(01).
002430     03  WS-TOP-LNE2.
002440         05  WS-TCH  PIC X(01) OCCURS 80.
           03  WS-TP-LINE2 REDEFINES WS-TOP-LNE2.
               05  FILLER      PIC  X(01).
               05  WS-TOP-COMP PIC  X(40).
001430	       05  FILLER      PIC  X(23).
	       05  WS-WRKHD    PIC  X(11).
001430	       05  FILLER      PIC  X(01).
	       05  WS-WRKST    PIC  X(03).
001430	       05  FILLER      PIC  X(01).
002450	   03  WS-MID-LNE.
002460         05  WS-MCHR PIC X(01) OCCURS 80.
002450     03  WS-MID-LNE2.
	       05  FILLER      PIC  X(01) VALUE "³".
	       05  WS-BLNK78   PIC  X(78) VALUE ALL "°".
	       05  FILLER      PIC  X(01) VALUE "³".
002470	   03  WS-BOT-LNE.
002480         05  WS-BCHR PIC X(01) OCCURS 80.
           03  WS-B-LINE REDEFINES WS-BOT-LNE.
               05  FILLER  PIC X(01).
               05  WS-F-LINE
                           PIC X(78).
               05  FILLER  PIC X(01).
002470     03  WS-BOT-LNE2.
002480         05  WS-BCH  PIC X(01) OCCURS 80.

001260 COPY WS.WS.

000290 01  WS-PARID.
000020	   03  WS-SYS-ID       PIC  X(03).

       01  W02-FILE-IDS.

       COPY APACFIDS.ID.

       COPY CONTROL.ID.

       COPY PARAM.ID.

       COPY SYSTEM.ID.

           03  W02-PRINTER.
	       05  W02-REPORT PIC X(07) VALUE "PRP020.".
               05  W02-USER   PIC X(05) VALUE SPACES.
               
001340 01  W05-PRINT.
001350     03  W05-ESC        PIC 9(02) COMP-X.
001360     03  W05-ESCR REDEFINES W05-ESC.
001370         05  W05-E      PIC X(01).
001380     03  W05-DBL        PIC 9(02) COMP-X.
001390     03  W05-DBLR REDEFINES W05-DBL.
001400         05  W05-D      PIC X(01).
001410     03  W05-CDBL       PIC 9(02) COMP-X.
001420     03  W05-CDBLR REDEFINES W05-CDBL.
001430         05  W05-CD     PIC X(01).
001440     03  W05-SI         PIC 9(02) COMP-X.
001450     03  W05-SIR REDEFINES W05-SI.
001460         05  W05-I      PIC X(01).
001470     03  W05-CSI        PIC 9(02) COMP-X.
001480     03  W05-CSIR REDEFINES W05-CSI.
001490         05  W05-CI     PIC X(01).
001500     03  W05-SO         PIC 9(02) COMP-X.
001510     03  W05-SOR REDEFINES W05-SO.
001520         05  W05-O      PIC X(01).
001530     03  W05-CSO        PIC 9(02) COMP-X.
001540     03  W05-CSOR REDEFINES W05-CSO.
001550         05  W05-CO     PIC X(01).
001560     03  W05-6LPI       PIC 9(02) COMP-X.
001570     03  W05-6LPIR REDEFINES W05-6LPI.
001580         05  W05-6      PIC X(01).
001590     03  W05-8LPI       PIC 9(02) COMP-X.
001600     03  W05-8LPIR REDEFINES W05-8LPI.
001610         05  W05-8      PIC X(01).
001590     03  W05-NUL        PIC 9(02) COMP-X.
001600     03  W05-NULR REDEFINES W05-NUL.
001610         05  W05-N      PIC X(01).
001620     03  W05-CSHDRW     PIC 9(02).

001230 01  W06-COND.
001240	   03  W06-DEC	       PIC 9(03) OCCURS 6.
001250 01  W07-NORM.
001260	   03  W07-DEC	       PIC 9(03) OCCURS 6.
001270 01  W08-EXPD.
001280	   03  W08-DEC	       PIC 9(03) OCCURS 6.
001290 01  W09-ECAN.
001300	   03  W09-DEC	       PIC 9(03) OCCURS 6.
001310 01  W10-PGEL48.
001320	   03  W10-DEC	       PIC 9(03) OCCURS 6.
001330 01  W11-PGEL66.
001340	   03  W11-DEC	       PIC 9(03) OCCURS 6.
001330 01  W12-10CPI.
001340	   03  W12-DEC	       PIC 9(03) OCCURS 6.
001330 01  W13-CPI12.
001340	   03  W13-DEC	       PIC 9(03) OCCURS 6.
001330 01  W14-CPI17.
001340	   03  W14-DEC	       PIC 9(03) OCCURS 6.
001330*01  W15-DBLP.
001340*    03  W15-DEC	       PIC 9(03) OCCURS 4.
001330*01  W16-DCAN.
001340*    03  W16-DEC	       PIC 9(03) OCCURS 4.
001660 01  W10-INPUT.
001670     03  W10-LEDG       PIC 9(03).
001680	   03  W10-DATE       PIC X(10).
002520	   03  W10-EDTE REDEFINES W10-DATE PIC 99/99/9999.

       COPY W12.WS.

       01  W15-CONTROL.
           03  W15-DEBINV     PIC  9(08)    COMP-3.
           03  W15-DEBREC     PIC  9(08)    COMP-3.
           03  W15-DEBORD     PIC  9(08)    COMP-3.
           03  W15-DEBJOB     PIC  9(08)    COMP-3.
           03  W15-CRDORD     PIC  9(08)    COMP-3.
001490 01  W15-HEX.
001500     03  W15-ASCII       PIC X(01) OCCURS 256.

       COPY W20.WS.

001890 01  W25-CALCS.
001900     03  W25-RESULT     PIC 9(07)V99.
001910     03  W25-RESULT1 REDEFINES W25-RESULT.
001920         05  FILLER      PIC 9(01).
001930         05  W25-WHOLE  PIC 9(06).
001940         05  W25-DECIMAL PIC 9(02).
           03  W25-RESULT2 REDEFINES W25-RESULT.
               05  W25-KEY    PIC 9(06).
               05  W25-SUB    PIC 9(01).
               05  FILLER     PIC 9(02).
001950     03  W25-PASS.
001960         05  W25-PASS1  PIC 9(03).
001970         05  W25-PASS2  PIC 9(03).
001980     03  W25-TIME       PIC 9(08).
001990     03  W25-TRED REDEFINES W25-TIME.
002000         05  FILLER      PIC 9(02).
002010         05  W25-FACT   PIC 9(06).
002020     03  W25-TOTAL      PIC S9(07)V99  COMP-3.
002030     03  W25-VALUE      PIC S9(07)V99  COMP-3.
002040 01  W30-MONTHS.
002050     03  W30-MONTH-NAMES.
002060         05  W30-ENG    PIC X(36)     VALUE
002070                         "JanFebMarAprMayJunJulAugSepOctNovDec".
002080     03  W30-MONTH REDEFINES W30-MONTH-NAMES
002090                         PIC X(03)     OCCURS 12.
002100 01  W35-PASSWORD.
002100     02  W35-PASS.
002110     03  W35-PASS1      PIC 9(03).
002120     03  W35-PASS2      PIC 9(03).
002130     02  W35-PASSW REDEFINES W35-PASS.
002140     03  W35-PNUM       PIC 9(06).
002150 01  W40-COMPANY.
002160     02  W40-NAME1.
002170         03  W40-NAME   PIC X(40).
002180         03  FILLER      PIC X(32).
002190     02  W40-NAME2 REDEFINES W40-NAME1.
002200         03  W40-SURNAME PIC X(24).
002210         03  W40-FNAME  PIC X(24).
002220         03  W40-SNAME  PIC X(24).
002230     02  W40-NAME3 REDEFINES W40-NAME1.
002240         03  W40-NCHAR OCCURS 72 PIC X(01).
002250     02  W40-ADDRESS1.
002260         03  W40-ADD1   PIC X(30).
002270         03  W40-ADD2   PIC X(30).
002280         03  W40-ADD3   PIC X(30).
002290         03  W40-ADD4   PIC X(30).
002300     02  W40-ADDRESS2 REDEFINES W40-ADDRESS1.
002310         03  W40-ACHAR OCCURS 120 PIC X(01).
002320     02  W40-POST       PIC 9(04).
002330     02  W40-TEL        PIC X(14).
002340     02  W40-COST-CODE  PIC X(10).
           02  W40-VATNO      PIC X(14).

       COPY W40.WS.

002370 01  W45-TRAN.
002380     03  W45-CODE       PIC  9(02).
002390     03  W45-ENG        PIC  X(12).
002400     03  W45-AFR        PIC  X(12).
002410     03  W45-ACT        PIC  X(01).
      *    03  W45-E-ABRV     PIC  X(03).
      *    03  W45-A-ABRV     PIC  X(03).
           03  W45-T-GL       PIC  9(06).
002370 01  W46-TRAN.
002380     03  W46-CODE       PIC  9(02).
002390     03  W46-DESC       PIC  X(15).
           03  W46-ABRV       PIC  X(03).
002410     03  W46-ACT        PIC  X(01).
           03  W46-T-GL       PIC  9(06).
       01  W50-PRINTERS.
           03  W50-TRM-PRINTER.
000470         05  W50-PICP    PIC  9(01).
               05  W50-PRN1    PIC  9(01).
000480         05  W50-INVP    PIC  9(01).
               05  W50-PRN2    PIC  9(01).
000490         05  W50-STDP    PIC  9(01).
               05  W50-PRN3    PIC  9(01).
000500         05  W50-STMP    PIC  9(01).
               05  W50-PRN4    PIC  9(01).
000510         05  W50-CSHP    PIC  9(01).
               05  W50-PRN5    PIC  9(01).
000520         05  W50-POS     PIC  9(01).
               05  W50-PRN6    PIC  9(01).
           03  W50-TRM-PRN-CONT.
      *                                     CONDENSED PRINT
000230         05  W50-CONP.
		 07  W50-CHAR1	PIC  X(01) OCCURS 6.
      *                                     CANCEL CONDENSED PRINT
000240         05  W50-NORP.
		 07  W50-CHAR2	PIC  X(01) OCCURS 6.
      *                                     EXPANDED PRINT
000250         05  W50-EXPP.
		 07  W50-CHAR3	PIC  X(01) OCCURS 6.
      *                                     CANCEL EXPANDED PRINT
000260         05  W50-ECAN.
		 07  W50-CHAR4	PIC  X(01) OCCURS 6.
      *                                     SET PAGE LENGTH TO 48
000270         05  W50-8LPI.
		 07  W50-CHAR5	PIC  X(01) OCCURS 6.
      *                                     SET PAGE LENGTH TO 66
000280         05  W50-6LPI.
		 07  W50-CHAR6	PIC  X(01) OCCURS 6.
      *                                     PRINT 10 CHARS PER INCH
000290         05  W50-10CPI.
		 07  W50-CHAR7	PIC  X(01) OCCURS 6.
      *                                     PRINT 12 CHARS PER INCH
000300         05  W50-12CPI.
		 07  W50-CHAR8	PIC  X(01) OCCURS 6.
      *                                     PRINT 17 CHARS PER INCH
000310         05  W50-17CPI.
		 07  W50-CHAR9	PIC  X(01) OCCURS 6.
      *                                     SET DOUBLE PRINT
000320*        05  W50-DBLP.
      * 	 07  W50-CHAR10 PIC  X(01) OCCURS 4.
      *                                     RELEASE DOUBLE PRINT
000330*        05  W50-DCAN.
      * 	 07  W50-CHAR11 PIC  X(01) OCCURS 4.
	       05  W50-PRN-TYPE PIC  X(01).
	       05  W50-LENGTH	PIC  9(02)  COMP-5.
	       05  W50-PAGE	PIC  9(02)  COMP-5.
	   03  W50-PRINTER	PIC  9(01).
	   03  W50-TERMINAL	PIC  9(03).
	   03  W50-SINGLE	PIC  X(01).

       COPY FUNCTION.WS.

002420 01  W60-NME-ADD.
002430     03  W60-CSHEAD     PIC  X(32).
002440 01  W65-ENTRY.
002450     03  W65-FOUR.
002460         05  W65-CHAR OCCURS 4 PIC X(01).
002670 01  W75-TITLES.
002680     03  W75-DESCRIP.
002690        05  FILLER       PIC X(28)       VALUE
002700                     "Mr     Mnr    Mrs    Mev    ".
002710         05  FILLER      PIC X(28)       VALUE
002720                     "Miss   Mej    Ms     Ms     ".
002730         05  FILLER      PIC X(28)       VALUE
002740                     "Dr     Dr     Rev    Ds     ".
002750         05  FILLER      PIC X(28)       VALUE
002760                     "Prof   Prof   The HonSy Edel".
002770         05  FILLER      PIC X(28)       VALUE
002780                     "                            ".
002790     03  W75-CODES REDEFINES W75-DESCRIP.
002800         05  W75-TITLE  OCCURS 10.
002810             07  W75-ETITLE PIC X(07).
002820             07  W75-ATITLE PIC X(07).
002830 01  W80-ACCOUNT.
002840     03  W80-ACNO       PIC X(06).
002850     03  W80-NUMD REDEFINES W80-ACNO.
002860         05  W80-COMP   PIC 9(01).
002870         05  W80-TYPE   PIC 9(01).
002880         05  W80-SERIAL PIC 9(04).
           03  W80-CASH-GL    PIC 9(06).
       01  W90-CALC-KEYS.
004020     03  W90-RESULT      PIC  9(04)    COMP-5.
004020     03  W90-TRNKEY      PIC  9(04)    COMP-5.
004020     03  W90-TS          PIC  9(02)    COMP-5.
004020     03  W90-CATKEY      PIC  9(04)    COMP-5.
004020     03  W90-CS          PIC  9(02)    COMP-5.

       LINKAGE SECTION.

       COPY CHAIN.LS.

      /
      *   ******    ******   *******   ********  ********  **     ** 
      *  **    **  **    **  **    **  **        **        ***    ** 
      *  **        **        **    **  **        **        ** *   ** 
      *   ******   **        ******    *****     *****     **  *  ** 
      *        **  **        **   **   **        **        **   * ** 
      *  **    **  **    **  **    **  **        **        **    *** 
      *   ******    ******   **    **  ********  ********  **     ** 
      *                                                              
003150 SCREEN SECTION.

       COPY BLANK.CRT.

004660 01  S45.
004670     03  LINE  2 COLUMN 26 VALUE "SET PRINTER CONTROL CHARACTERS".
004680	   03  LINE  4 COLUMN  4 VALUE "Printer Number 1-8?".

004690 01  S46.
004700     03  LINE  5 COLUMN  4 VALUE "The decimal codes must be used".
004710     03  LINE  6 COLUMN  4 VALUE 
004720               "Each function allows for 4 control characters".
004730     03  LINE  8 COLUMN  4 VALUE "Contracted print".
004740	   03  LINE  9 COLUMN  4 VALUE "Normal print    ".
004750	   03  LINE 10 COLUMN  4 VALUE "Expanded print  ".
004760	   03  LINE 11 COLUMN  4 VALUE "Cancel expanded ".
004770	   03  LINE 12 COLUMN  4 VALUE "8 Lines - inch  ".
004780	   03  LINE 13 COLUMN  4 VALUE "6 Lines - inch  ".
004780	   03  LINE 14 COLUMN  4 VALUE "12 C.P.I.       ".
004780	   03  LINE 15 COLUMN  4 VALUE "Cancel 12 C.P.I ".
004780	   03  LINE 16 COLUMN  4 VALUE "17 C.P.I.       ".
004780*   03  LINE 17 COLUMN  4 VALUE "Double print    ".
004780*   03  LINE 18 COLUMN  4 VALUE "Cancel Double   ".
	   03  LINE 17 COLUMN  4 VALUE "Page Length     ".
	   03  LINE 18 COLUMN  4 VALUE "Single Sheet    ".

       COPY S99.CRT.

       COPY ERROR.CRT.

      /
      *        *******    *******     ******     ****** 
      *        **    **   **    **   **    **   **    **
      *        **    **   **   **    **    **   **
      *        *******    ******     **    **   **
      *        **         **   **    **    **   **
      *        **         **    **   **    **   **    **
      *        **         **    **    ******     ****** 
      *
001230 PROCEDURE DIVISION
		 USING LS-PARID LS-USER-ID LS0-PROGRAMS LS0-SECURITY.
006220 AA000-MAIN	       SECTION.
006230 AA000-INIT.
003240	   IF LS0-PALEV < 2
	       MOVE "Not Authorised"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
	       GO TO AA49.
006250	     PERFORM ZA000-INIT.
	     PERFORM YC000.
       AA49.
             EXIT PROGRAM.

       COPY LOCKED.RC2.

       COPY FUNCTION.CRT.

       AA200              SECTION.
       AA201.
002130	     DISPLAY "³" AT CPOS WITH BACKGROUND-COLOR 0
				      FOREGROUND-COLOR 3
		     WS-BLNK78 WITH FOREGROUND-COLOR 3
		     "³" WITH BACKGROUND-COLOR 0
			      FOREGROUND-COLOR 3.
019260	     ADD 1 TO CLIN.
       AA205.
             EXIT.
      /
      *    ****    READ FILES ROUTINES
      *
006630 AC000-READ              SECTION.

       COPY CONTROL.RD.

       COPY PARAM.RD.

      *
      *    ****    REWRITE AND WRITE FILES ROUTINES
      *
006940 AD000-WRITE             SECTION.

       COPY CONTROL.WR.

       COPY PARAM.WR.

      /
      *    *****    PRINTER CONTROL CHARACTERS    *****
      *
008640 YC000		       SECTION 5.
008650 YC00.
008660       DISPLAY CLR-SCREEN.
008670       MOVE "N"            TO WS-OPTION.
008680       DISPLAY S45.
             MOVE 0              TO W50-PRINTER.
008690 YC02.
008700	     ACCEPT W50-PRINTER AT 0424
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
008710			 BACKGROUND-COLOR 4 UPDATE AUTO.
008770     IF W50-PRINTER > 8
008780         GO TO YC02.
008790     IF W50-PRINTER = 0
008800         GO TO YC99.
             ADD 501 W50-PRINTER GIVING W25-RESULT.
             DIVIDE W25-RESULT BY 2
                                 GIVING WS-PARKEY
                                 REMAINDER WS-S6.
             ADD 1               TO WS-S6.
             DISPLAY "C" AT 0704 WITH FOREGROUND-COLOR 14 
                     "itoh" WITH FOREGROUND-COLOR 7.
             DISPLAY "E" AT 0804 WITH FOREGROUND-COLOR 14 
             "pson RX/LX/LQ, Panasonic, Star, Seikosha or compatables"
                      WITH FOREGROUND-COLOR 7.
	     DISPLAY "H" AT 0904 WITH FOREGROUND-COLOR 14
		     ".P. Deskjet or Laserjet"
                      WITH FOREGROUND-COLOR 7.
	     DISPLAY "I" AT 1004 WITH FOREGROUND-COLOR 14
                     "BM/IBMPRO or compatable" 
                      WITH FOREGROUND-COLOR 7.
	     DISPLAY "M" AT 1104 WITH FOREGROUND-COLOR 14
                     "anually enter control characters" 
                      WITH FOREGROUND-COLOR 7.
	     DISPLAY "O" AT 1204 WITH FOREGROUND-COLOR 14
                     "KI - Microline" WITH FOREGROUND-COLOR 7.
	     DISPLAY "Select option required" AT 1406
                      WITH FOREGROUND-COLOR 7.
008840	     PERFORM READ-PARAM-LOCK THRU READ-PARAM-EXIT.
	     MOVE TRM-PRN-TYPE(WS-S6)
				 TO WS-OPTION.
       YC02A.
	     ACCEPT WS-OPTION AT 1404
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
008770	   IF NOT(WS-OPTION = "C" OR "E" OR "H" OR "I" OR "M" OR "O")
	       GO TO YC02A.

008830 YC03.
           IF WS-OPTION NOT = "M"
	       GO TO YC85.

       YC03-MANUAL.
	     MOVE TRM-PRN-CONT(WS-S6)
                                 TO W50-TRM-PRN-CONT.
	     MOVE TRM-LENGTH(WS-S6)
				 TO W50-LENGTH.
	     MOVE TRM-SINGLE(WS-S6)
				 TO W50-SINGLE.
             MOVE 06             TO CLIN.
	     MOVE 01		 TO CCOL.

       YC03A.
002130	     DISPLAY "³" AT CPOS WITH BACKGROUND-COLOR 0
				      FOREGROUND-COLOR 3
		     WS-BLNK78 WITH FOREGROUND-COLOR 3
		     "³" WITH BACKGROUND-COLOR 0
			      FOREGROUND-COLOR 3.
	   IF CLIN < 23
               ADD 1             TO CLIN
               GO TO YC03A.
008810       DISPLAY S46.
008910	     MOVE 1		 TO WS-S1.
008920 YC05.
008930	     MOVE W50-CHAR1(WS-S1)
				 TO W40-CHAR.
008940	     MOVE W40-DEC	 TO W06-DEC(WS-S1)
008950	   IF WS-S1 < 6
008960	       ADD 1		 TO WS-S1
008970         GO TO YC05.
008980	     MOVE 1		 TO WS-S1.
008990 YC10.
009000	     MOVE W50-CHAR2(WS-S1)
				 TO W40-CHAR.
009010	     MOVE W40-DEC	 TO W07-DEC(WS-S1)
009020	   IF WS-S1 < 6
009030	       ADD 1		 TO WS-S1
009040         GO TO YC10.
009050	     MOVE 1		 TO WS-S1.
009060 YC15.
009070	     MOVE W50-CHAR3(WS-S1)
				 TO W40-CHAR.
009080	     MOVE W40-DEC	 TO W08-DEC(WS-S1)
009090	   IF WS-S1 < 6
009100	       ADD 1		 TO WS-S1
009110         GO TO YC15.
009120	     MOVE 1		 TO WS-S1.
009130 YC20.
009140	     MOVE W50-CHAR4(WS-S1)
				 TO W40-CHAR.
009150	     MOVE W40-DEC	 TO W09-DEC(WS-S1)
009160	   IF WS-S1 < 6
009170	       ADD 1		 TO WS-S1
009180         GO TO YC20.
009190	     MOVE 1		 TO WS-S1.
009200 YC22.
009210	     MOVE W50-CHAR5(WS-S1)
				 TO W40-CHAR.
009220	     MOVE W40-DEC	 TO W10-DEC(WS-S1)
009230	   IF WS-S1 < 6
009240	       ADD 1		 TO WS-S1
009250         GO TO YC22.
009260	     MOVE 1		 TO WS-S1.
009270 YC24.
009280	     MOVE W50-CHAR6(WS-S1)
				 TO W40-CHAR.
009290	     MOVE W40-DEC	 TO W11-DEC(WS-S1)
009300	   IF WS-S1 < 6
009310	       ADD 1		 TO WS-S1
009320         GO TO YC24.
009260	     MOVE 1		 TO WS-S1.
009270 YC26.
009280	     MOVE W50-CHAR7(WS-S1)
				 TO W40-CHAR.
009290	     MOVE W40-DEC	 TO W12-DEC(WS-S1)
009300	   IF WS-S1 < 6
009310	       ADD 1		 TO WS-S1
009320         GO TO YC26.
009260	     MOVE 1		 TO WS-S1.
009270 YC28.
009280	     MOVE W50-CHAR8(WS-S1)
				 TO W40-CHAR.
009290	     MOVE W40-DEC	 TO W13-DEC(WS-S1)
009300	   IF WS-S1 < 6
009310	       ADD 1		 TO WS-S1
009320         GO TO YC28.
009260	     MOVE 1		 TO WS-S1.
009270 YC30.
009280	     MOVE W50-CHAR9(WS-S1)
				 TO W40-CHAR.
009290	     MOVE W40-DEC	 TO W14-DEC(WS-S1)
009300	   IF WS-S1 < 6
009310	       ADD 1		 TO WS-S1
009320         GO TO YC30.
009260*      MOVE 1		 TO WS-S1.
009270*YC32.
009280*      MOVE W50-CHAR10(WS-S1)
      *				 TO W40-CHAR.
009290*      MOVE W40-DEC	 TO W15-DEC(WS-S1)
009300*    IF WS-S1 < 4
009310*        ADD 1		 TO WS-S1
009320*        GO TO YC32.
009260*      MOVE 1		 TO WS-S1.
009270*YC34.
009280*      MOVE W50-CHAR11(WS-S1)
      *				 TO W40-CHAR.
009290*      MOVE W40-DEC	 TO W16-DEC(WS-S1)
009300*    IF WS-S1 < 4
009310*        ADD 1		 TO WS-S1
009320*        GO TO YC34.
009330 YC35.
009340	     ACCEPT W06-DEC(1) AT 0821
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009360	   IF W06-DEC(1) > 256
009370         GO TO YC35.
009380 YC40.
009390	     ACCEPT W06-DEC(2) AT 0825
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009410	   IF W06-DEC(2) > 256
009420         GO TO YC40.
009430 YC45.
009440	     ACCEPT W06-DEC(3) AT 0829
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009460	   IF W06-DEC(3) > 256
009470         GO TO YC45.
009480 YC50.
009490	     ACCEPT W06-DEC(4) AT 0833
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W06-DEC(4) > 256
009520         GO TO YC50.
009480 YC51.
009490	     ACCEPT W06-DEC(5) AT 0837
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W06-DEC(5) > 256
009520	       GO TO YC51.
009480 YC52.
009490	     ACCEPT W06-DEC(6) AT 0841
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W06-DEC(6) > 256
009520	       GO TO YC52.
009530 YC55.
009540	     ACCEPT W07-DEC(1) AT 0921
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009560	   IF W07-DEC(1) > 256
009570         GO TO YC55.
009580 YC60.
009590	     ACCEPT W07-DEC(2) AT 0925
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009610	   IF W07-DEC(2) > 256
009620         GO TO YC60.
009630 YC65.
009640	     ACCEPT W07-DEC(3) AT 0929
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009660	   IF W07-DEC(3) > 256
009670         GO TO YC65.
009680 YC70.
009690	     ACCEPT W07-DEC(4) AT 0933
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009710	   IF W07-DEC(4) > 256
009720         GO TO YC70.
009480 YC70-1.
009490	     ACCEPT W07-DEC(5) AT 0937
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W07-DEC(5) > 256
009520	       GO TO YC70-1.
009480 YC70-2.
009490	     ACCEPT W07-DEC(6) AT 0941
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W07-DEC(6) > 256
009520	       GO TO YC70-2.
009730 YC70A.
009740	     ACCEPT W08-DEC(1) AT 1021
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009760	   IF W08-DEC(1) > 256
009770         GO TO YC70A.
009780 YC70B.
009790	     ACCEPT W08-DEC(2) AT 1025
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009810	   IF W08-DEC(2) > 256
009820         GO TO YC70B.
009830 YC70C.
009840	     ACCEPT W08-DEC(3) AT 1029
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009860	   IF W08-DEC(3) > 256
009870         GO TO YC70C.
009880 YC70D.
009890	     ACCEPT W08-DEC(4) AT 1033
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009910	   IF W08-DEC(4) > 256
009920         GO TO YC70D.
009480 YC70D-1.
009490	     ACCEPT W08-DEC(5) AT 1037
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W08-DEC(5) > 256
009520	       GO TO YC70D-1.
009480 YC70D-2.
009490	     ACCEPT W08-DEC(6) AT 1041
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W08-DEC(6) > 256
009520	       GO TO YC70D-2.
009930 YC70E.
009940	     ACCEPT W09-DEC(1) AT 1121
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009960	   IF W09-DEC(1) > 256
009970         GO TO YC70E.
009980 YC70F.
009990	     ACCEPT W09-DEC(2) AT 1125
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010010	   IF W09-DEC(2) > 256
010020         GO TO YC70F.
010030 YC70G.
010040	     ACCEPT W09-DEC(3) AT 1129
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010060	   IF W09-DEC(3) > 256
010070         GO TO YC70G.
010080 YC70H.
010090	     ACCEPT W09-DEC(4) AT 1133
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010110	   IF W09-DEC(4) > 256
010120         GO TO YC70H.
009480 YC70H-1.
009490	     ACCEPT W09-DEC(5) AT 1137
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W09-DEC(5) > 256
009520	       GO TO YC70H-1.
009480 YC70H-2.
009490	     ACCEPT W09-DEC(6) AT 1141
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W09-DEC(6) > 256
009520	       GO TO YC70H-2.
010130 YC70I.
010140	     ACCEPT W10-DEC(1) AT 1221
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010160	   IF W10-DEC(1) > 256
010170         GO TO YC70I.
010180 YC70J.
010190	     ACCEPT W10-DEC(2) AT 1225
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010210	   IF W10-DEC(2) > 256
010220         GO TO YC70J.
010230 YC70K.
010240	     ACCEPT W10-DEC(3) AT 1229
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010260	   IF W10-DEC(3) > 256
010270         GO TO YC70K.
010280 YC70L.
010290	     ACCEPT W10-DEC(4) AT 1233
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010310	   IF W10-DEC(4) > 256
010320         GO TO YC70L.
009480 YC70L-1.
009490	     ACCEPT W10-DEC(5) AT 1237
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W10-DEC(5) > 256
009520	       GO TO YC70L-1.
009480 YC70L-2.
009490	     ACCEPT W10-DEC(6) AT 1241
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W10-DEC(6) > 256
009520	       GO TO YC70L-2.
010330 YC70M.
010340	     ACCEPT W11-DEC(1) AT 1321
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010360	   IF W11-DEC(1) > 256
010370         GO TO YC70M.
010380 YC70N.
010390	     ACCEPT W11-DEC(2) AT 1325
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010410	   IF W11-DEC(2) > 256
010420         GO TO YC70N.
010430 YC70O.
010440	     ACCEPT W11-DEC(3) AT 1329
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010460	   IF W11-DEC(3) > 256
010470         GO TO YC70O.
010480 YC70P.
010490	     ACCEPT W11-DEC(4) AT 1333
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010510	   IF W11-DEC(4) > 256
010520         GO TO YC70P.
009480 YC70P-1.
009490	     ACCEPT W11-DEC(5) AT 1337
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W11-DEC(5) > 256
009520	       GO TO YC70P-1.
009480 YC70P-2.
009490	     ACCEPT W11-DEC(6) AT 1341
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W11-DEC(6) > 256
009520	       GO TO YC70P-2.
010330 YC72A.
010340	     ACCEPT W13-DEC(1) AT 1421
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010360	   IF W13-DEC(1) > 256
010370         GO TO YC72A.
010380 YC72B.
010390	     ACCEPT W13-DEC(2) AT 1425
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010410	   IF W13-DEC(2) > 256
010420         GO TO YC72B.
010430 YC72C.
010440	     ACCEPT W13-DEC(3) AT 1429
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010460	   IF W13-DEC(3) > 256
010470         GO TO YC72C.
010480 YC72D.
010490	     ACCEPT W13-DEC(4) AT 1433
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010510	   IF W13-DEC(4) > 256
010520         GO TO YC72D.
009480 YC72D-1.
009490	     ACCEPT W13-DEC(5) AT 1437
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W13-DEC(5) > 256
009520	       GO TO YC72D-1.
009480 YC72D-2.
009490	     ACCEPT W13-DEC(6) AT 1441
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W13-DEC(6) > 256
009520	       GO TO YC72D-2.
010330 YC72E.
010340	     ACCEPT W12-DEC(1) AT 1521
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010360	   IF W12-DEC(1) > 256
010370         GO TO YC72E.
010380 YC72F.
010390	     ACCEPT W12-DEC(2) AT 1525
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010410	   IF W12-DEC(2) > 256
010420         GO TO YC72F.
010430 YC72G.
010440	     ACCEPT W12-DEC(3) AT 1529
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010460	   IF W12-DEC(3) > 256
010470         GO TO YC72G.
010480 YC72H.
010490	     ACCEPT W12-DEC(4) AT 1533
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010510	   IF W12-DEC(4) > 256
010520         GO TO YC72H.
009480 YC72H-1.
009490	     ACCEPT W12-DEC(5) AT 1537
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W12-DEC(5) > 256
009520	       GO TO YC72H-1.
009480 YC72H-2.
009490	     ACCEPT W12-DEC(6) AT 1541
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W12-DEC(6) > 256
009520	       GO TO YC72H-2.
010330 YC72I.
010340	     ACCEPT W14-DEC(1) AT 1621
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010360	   IF W14-DEC(1) > 256
010370         GO TO YC72I.
010380 YC72J.
010390	     ACCEPT W14-DEC(2) AT 1625
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010410	   IF W14-DEC(2) > 256
010420         GO TO YC72J.
010430 YC72K.
010440	     ACCEPT W14-DEC(3) AT 1629
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010460	   IF W14-DEC(3) > 256
010470         GO TO YC72K.
010480 YC72L.
010490	     ACCEPT W14-DEC(4) AT 1633
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
010510	   IF W14-DEC(4) > 256
010520         GO TO YC72L.
009480 YC72L-1.
009490	     ACCEPT W14-DEC(5) AT 1637
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W14-DEC(5) > 256
009520	       GO TO YC72L-1.
009480 YC72L-2.
009490	     ACCEPT W14-DEC(6) AT 1641
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
009510	   IF W14-DEC(6) > 256
009520	       GO TO YC72L-2.
       YC74.
	     ACCEPT W50-PAGE AT 1721
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
	   IF W50-PAGE > 96 OR < 30
	       GO TO YC74.
	   IF W50-PAGE > 66
	       SUBTRACT 5 FROM W50-PAGE
				 GIVING W50-LENGTH
	   ELSE
	       SUBTRACT 4 FROM W50-PAGE
				 GIVING W50-LENGTH.
       YC74A.
	     ACCEPT W50-SINGLE AT 1821
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
	     CALL "CBL_TOUPPER" USING W50-SINGLE
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	   IF NOT(W50-SINGLE = "N" OR "Y")
	       GO TO YC74A.
	     PERFORM CHECK-CORRECT.
010600	   IF WS-OPTION = "N"
010610         GO TO YC35.
010620	     MOVE 1		 TO WS-S1.
010630 YC75.
010640	     ADD 1 W06-DEC(WS-S1)
				 GIVING WS-S2.
010650	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR1(WS-S1).
010660	   IF WS-S1 < 6
010670	       ADD 1		 TO WS-S1
010680         GO TO YC75.
010690	     MOVE 1		 TO WS-S1.
010700 YC80.
010710	     ADD 1 W07-DEC(WS-S1)
				 GIVING WS-S2.
010720	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR2(WS-S1).
010730	   IF WS-S1 < 6
010740	       ADD 1		 TO WS-S1
010750         GO TO YC80.
010760	     MOVE 1		 TO WS-S1.
010770 YC80A.
010780	     ADD 1 W08-DEC(WS-S1)
				 GIVING WS-S2.
010790	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR3(WS-S1).
010800	   IF WS-S1 < 6
010810	       ADD 1		 TO WS-S1
010820         GO TO YC80A.
010830	     MOVE 1		 TO WS-S1.
010840 YC80B.
010850	     ADD 1 W09-DEC(WS-S1)
				 GIVING WS-S2.
010860	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR4(WS-S1).
010870	   IF WS-S1 < 6
010880	       ADD 1		 TO WS-S1
010890         GO TO YC80B.
010900	     MOVE 1		 TO WS-S1.
010910 YC80C.
010920	     ADD 1 W10-DEC(WS-S1)
				 GIVING WS-S2.
010930	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR5(WS-S1).
010940	   IF WS-S1 < 6
010950	       ADD 1		 TO WS-S1
010960         GO TO YC80C.
010970	     MOVE 1		 TO WS-S1.
010980 YC80D.
010990	     ADD 1 W11-DEC(WS-S1)
				 GIVING WS-S2.
011000	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR6(WS-S1).
011010	   IF WS-S1 < 6
011020	       ADD 1		 TO WS-S1
011030         GO TO YC80D.
010970	     MOVE 1		 TO WS-S1.
010980 YC80E.
010990	     ADD 1 W12-DEC(WS-S1)
				 GIVING WS-S2.
011000	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR7(WS-S1).
011010	   IF WS-S1 < 6
011020	       ADD 1		 TO WS-S1
011030         GO TO YC80E.
010970	     MOVE 1		 TO WS-S1.
010980 YC80F.
010990	     ADD 1 W13-DEC(WS-S1)
				 GIVING WS-S2.
011000	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR8(WS-S1).
011010	   IF WS-S1 < 6
011020	       ADD 1		 TO WS-S1
011030         GO TO YC80F.
010970	     MOVE 1		 TO WS-S1.
010980 YC80G.
010990	     ADD 1 W14-DEC(WS-S1)
				 GIVING WS-S2.
011000	     MOVE W15-ASCII(WS-S2)
				 TO W50-CHAR9(WS-S1).
011010	   IF WS-S1 < 6
011020	       ADD 1		 TO WS-S1
011030         GO TO YC80G.
010970	     MOVE 1		 TO WS-S1.
010980*YC80H.
010990*      ADD 1 W15-DEC(WS-S1)
      *				 GIVING WS-S2.
011000*      MOVE W15-ASCII(WS-S2)
      *				 TO W50-CHAR10(WS-S1).
011010*    IF WS-S1 < 4
011020*        ADD 1		 TO WS-S1
011030*        GO TO YC80H.
010970*      MOVE 1		 TO WS-S1.
010980*YC80I.
010990*      ADD 1 W16-DEC (WS-S1)
      *				 GIVING WS-S2.
011000*      MOVE W15-ASCII (WS-S2)
      *				 TO W50-CHAR11 (WS-S1).
011010*    IF WS-S1 < 4
011020*        ADD 1 TO WS-S1
011030*        GO TO YC80I.
             GO TO YC88.
       YC85.
             OPEN INPUT PRNTCONT.
           IF WS-STATUS NOT = ZERO
               GO TO YC87.
           IF WS-OPTION = "C"
               MOVE 1            TO WS-PRNKEY
           ELSE
           IF WS-OPTION = "E"
               MOVE 2            TO WS-PRNKEY
           ELSE
           IF WS-OPTION = "I"
               MOVE 3            TO WS-PRNKEY
           ELSE
           IF WS-OPTION = "O"
	       MOVE 4		 TO WS-PRNKEY
           ELSE
	   IF WS-OPTION = "H"
	       MOVE 5		 TO WS-PRNKEY.
             READ PRNTCONT.
           IF WS-STATUS NOT = ZERO
               GO TO YC87.
	     MOVE 66		 TO W50-PAGE.
	     MOVE "N"		 TO W50-SINGLE.
000880       MOVE PRN-COND       TO W50-CONP.
000900       MOVE PRN-NORM       TO W50-NORP.
000740       MOVE PRN-EXPD       TO W50-EXPP.
000760       MOVE PRN-ECAN       TO W50-ECAN.
             MOVE PRN-8LPI       TO W50-8LPI.
             MOVE PRN-6LPI       TO W50-6LPI.
             MOVE PRN-10CPI      TO W50-10CPI.
             MOVE PRN-12CPI      TO W50-12CPI.
             MOVE PRN-17CPI      TO W50-17CPI.
	     MOVE WS-OPTION	 TO W50-PRN-TYPE.
      *      MOVE PRN-DBLP	 TO W50-DBLP.
      *      MOVE PRN-DCAN	 TO W50-DCAN.
             CLOSE PRNTCONT.
	     DISPLAY "Page Length " AT 1606.
	     DISPLAY "Single Sheet" AT 1706.

       YC86.
	     ACCEPT W50-PAGE AT 1619
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
	   IF W50-PAGE > 96 OR < 30
	       GO TO YC86.
	   IF W50-PAGE > 66
	       SUBTRACT 5 FROM W50-PAGE
				 GIVING W50-LENGTH
	   ELSE
	       SUBTRACT 4 FROM W50-PAGE
				 GIVING W50-LENGTH.

       YC86A.
	     ACCEPT W50-SINGLE AT 1719
		    WITH FOREGROUND-COLOR 7 HIGHLIGHT
			 BACKGROUND-COLOR 4 UPDATE AUTO.
	     CALL "CBL_TOUPPER" USING W50-SINGLE
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	   IF NOT(W50-SINGLE = "N" OR "Y")
	       GO TO YC86A.
	     GO TO YC88.
       YC87.
	     MOVE "Printer control file error"
				 TO WS-ERR-STRING.
003260	     PERFORM ERROR-MESSAGE.
             GO TO YC03-MANUAL.
       YC88.
             MOVE W50-TRM-PRN-CONT
				 TO TRM-PRN-CONT (WS-S6).
	     MOVE W50-SINGLE	 TO TRM-SINGLE(WS-S6).
011040       PERFORM REWRITE-PARAM-UNLOCK THRU WRITE-PARAM-EXIT.
011590 YC99.
011600       EXIT.
      /
015920 ZA000-INIT	       SECTION 8.
015930 ZA000-OPEN.
             PERFORM ZA55 THRU ZA60.
	     MOVE LS-PARID	 TO WS-PARID.
	     MOVE LS-L-OR-N	 TO W02-L-OR-N.
	     MOVE WS-SYS-ID	 TO W02-SYSID.
	     MOVE LS-TODAY-DDMMYY
				 TO TODAY-DDMMYY.
	     MOVE LS-USUB	 TO WS-USUB.
	     DISPLAY CLR-SCREEN.
      *    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      *    ³	   S e t   u p	 t h e	 F U N C T I O N   k e y s     ³
      *    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	     MOVE 1		 TO USER-ACTION
				    USER-SETTING.
      *    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      *    ³		       ESC, F1 to F10 keys		       ³
      *    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	     MOVE ZERO		 TO USER-NUMBER.
	     MOVE 11		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      *    ³		    PAGE-UP and PAGE-DOWN keys		       ³
      *    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	     MOVE 53		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      *    ³		   A C T I V A T E   M O U S E		       ³
      *    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	     MOVE 64		 TO MOUSE-FUNC.
	     MOVE 1		 TO MOUSE-PARAM.
	     CALL X"AF" USING MOUSE-FUNC
			      MOUSE-PARAM.
	   IF MOUSE-FUNC NOT = 255
	       MOVE "Y"		 TO MOUSE-ATTACHED
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 0		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM
	   ELSE
	       GO TO ZA00A.
      *    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      *    ³	       Set MOUSE key to act as FUNCTION key	       ³
      *    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	     MOVE 3		 TO USER-ACTION.
	     MOVE 27		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      *    ³	    Setup the file ID's including path names           ³
      *    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
      *    *************************************************************
      *    **** 	  P A R A M E T E R   F I L E		    ****
      *    *************************************************************
       ZA00A.
	     MOVE "PARAM"	 TO AFID-KEY.

       ZA00-READ-APACFIDS.
000030	     READ APACFIDS WITH IGNORE LOCK
	       KEY IS AFID-KEY.
	   IF WS-STATUS = "00"
	       GO TO ZA00-READ-APACFIDS-EXIT.
006260	     STRING "Missing " DELIMITED SIZE
		     AFID-KEY DELIMITED BY " "
		     " file ID - Status " DELIMITED SIZE
		     WS-STATUS DELIMITED SIZE
		     INTO WS-ERR-MES.
	     PERFORM ERROR-LENGTH THRU ERROR-EXIT.
006370	     STOP RUN.

       ZA00-READ-APACFIDS-EXIT.
	     EXIT.

       ZA00A-CONTINUE.
	     MOVE AFID-PATH	 TO W02-PARAM.
      *    *************************************************************
      *    **** 	    C O N T R O L   F I L E		    ****
      *    *************************************************************
	     MOVE "NETWORK"	 TO AFID-KEY.
	     PERFORM ZA00-READ-APACFIDS THRU ZA00-READ-APACFIDS-EXIT.
	     MOVE AFID-PATH	 TO W02-NETWORK.
      *    *************************************************************
      *    **** 	     S Y S T E M   F I L E		    ****
      *    *************************************************************
	     MOVE "SYSTEM"	 TO AFID-KEY.
	     PERFORM ZA00-READ-APACFIDS THRU ZA00-READ-APACFIDS-EXIT.
	     MOVE AFID-PATH	 TO W02-SYSTEM.
	     MOVE 9		 TO WS-PARKEY.
016220       PERFORM READ-PARAM THRU READ-PARAM-EXIT.
             MOVE PAR-VAT-GST    TO WS-VAT-GST.
       ZA27.
016210       MOVE 1              TO WS-PARKEY.
016220       PERFORM READ-PARAM THRU READ-PARAM-EXIT.
016230       MOVE PAR-DMY        TO W12-TODAY.
016240       MOVE PAR-YMD        TO W12-T-YMD.
008740	     OPEN INPUT SECUR.
007570	     MOVE 1		 TO WS-SECKEY.
       ZA28.
007580       READ SECUR.
007590     IF RUNTIME-ERROR
007600         IF RECORD-LOCKED
007610             GO TO ZA28.
007620     IF WS-STATUS NOT = "00"
007630         DISPLAY "Disk error - ZA30" AT 2312
                        WITH FOREGROUND-COLOR 14
007640         STOP RUN.
007650	     MOVE 1		 TO WS-S1.
007660 ZA30.
007670	     MOVE SEC-ASCII(WS-S1)
				 TO W15-ASCII(WS-S1).
007680     IF WS-S1 < 256
007690	       ADD 1		 TO WS-S1
007700         GO TO ZA30.
             CLOSE SECUR.
044780       GO TO ZA999-EXIT.
       ZA49.
             DISPLAY "Too many files OPEN" AT 0812
                      WITH FOREGROUND-COLOR 14.
             DISPLAY "Check the FILES option in CONFIG.SYS" AT 1012.
             DISPLAY "Press any key to continue" AT 1212.
             ACCEPT WS-OPTION AT 1238 WITH FOREGROUND-COLOR 15.
             GO TO ZA205.
       ZA55.
041220       MOVE 1              TO WS-S1.
021870	     MOVE SPACES	 TO WS-MID-LNE.
041240 ZA60.
041250	     MOVE WS-G1 	 TO WS-TCHR(WS-S1) WS-BCHR(WS-S1).
	     MOVE WS-G8 	 TO WS-TCH(WS-S1)  WS-BCH(WS-S1).
041260     IF WS-S1 < 80
041270         ADD 1             TO WS-S1
041280         GO TO ZA60.
	     MOVE WS-G9 	 TO WS-TCH(1).
	     MOVE WS-G10	 TO WS-TCH(80).
	     MOVE WS-G11	 TO WS-BCH(1).
	     MOVE WS-G12	 TO WS-BCH(80).
	     MOVE WS-G14	 TO WS-TCHR(1)	WS-BCHR(1).
	     MOVE WS-G13	 TO WS-TCHR(80) WS-BCHR(80).
021930	     MOVE WS-G2 	 TO WS-TCHR(16) WS-TCHR(41)
021940				    WS-TCHR(64) WS-TCHR(71).
021950	     MOVE WS-G3 	 TO WS-MCHR(16) WS-MCHR(41)
021960				    WS-MCHR(64) WS-MCHR(71)
				    WS-MCHR(1)	WS-MCHR(80).
021970	     MOVE WS-G4 	 TO WS-BCHR(16) WS-BCHR(41)
021980				    WS-BCHR(64) WS-BCHR(71).
	     MOVE LS-COMPANY	 TO WS-TOP-COMP.
	   IF LS-USER = LS-SYS-ID
	       MOVE "SupervisorÄ"
				 TO WS-WRKHD
	   ELSE
	       MOVE "Workstation"
				 TO WS-WRKHD
	       MOVE LS-USER	 TO WS-WRKST.
020110 ZA200.
020120       DISPLAY "Files locked - Try later" AT 2312
020130                WITH FOREGROUND-COLOR 14
                     " " WS-STATUS WITH FOREGROUND-COLOR 15.
020140       DISPLAY "Press any key" AT 2512 
020150                WITH FOREGROUND-COLOR 14.
020160       ACCEPT WS-OPTION AT 2526 WITH FOREGROUND-COLOR 15 AUTO.
       ZA205.
             EXIT PROGRAM.
016260 ZA999-EXIT.
016270       EXIT.
      /
016280 ZB000-ERROR	     SECTION 8.
      
041480 OPEN-ERROR.
041490       DISPLAY CLR-SCREEN.
041500       DISPLAY "Open error" AT 0812 WITH FOREGROUND-COLOR 14.
041510       GO TO DISPLAY-FILE-NAME.
      
041480 READ-ERROR.
041490       DISPLAY CLR-SCREEN.
041500       DISPLAY "Read error" AT 0812 WITH FOREGROUND-COLOR 14.
041510       GO TO DISPLAY-FILE-NAME.
      
041520 WRITE-ERROR.
041530       DISPLAY CLR-SCREEN.
041540       DISPLAY "Write error" AT 0812 WITH FOREGROUND-COLOR 14.
      
041560 DISPLAY-FILE-NAME.
041850     IF WS-F-ERROR = 15
041860	       MOVE WS-PARID	 TO WS-FILE
041870	       MOVE WS-PARKEY	 TO WS-KEY.
041880     IF WS-STATUS = "10"
041890	       MOVE "End of FILE"
				 TO WS-STAT-MESSAGE
041900     ELSE
041910     IF WS-STATUS = "22"
041920	       MOVE "Duplicate record number"
				 TO WS-STAT-MESSAGE
041930     ELSE
041940     IF WS-STATUS = "23"
041950	       MOVE "Invalid record number"
				 TO WS-STAT-MESSAGE
041960     ELSE
041970     IF WS-STATUS = "24"
041980	       MOVE "DISK full"  TO WS-STAT-MESSAGE
041990     ELSE
042000     IF WS-STATUS = "30"
042010         MOVE "DISK error" TO WS-STAT-MESSAGE
042020     ELSE
042030     IF WS-STATUS = "94"
042040	       MOVE "FILE locked"
				 TO WS-STAT-MESSAGE.
045380       DISPLAY "File - " AT 1012 WS-FILE WITH FOREGROUND-COLOR 11.
045390       DISPLAY "Status " AT 1212 
                      WS-STATUS WITH FOREGROUND-COLOR 11
                     ": " WS-STAT-MESSAGE WITH FOREGROUND-COLOR 14.
045400     IF WS-STATUS NOT = "94" 
045410         DISPLAY "Key    " AT 1412 
                        WS-KEY WITH FOREGROUND-COLOR 11
045420         DISPLAY "Reverse backup or contact program Support"
                        AT 1612.
045440         DISPLAY "Please make a note of these details" AT 1812.
042170       STOP RUN.
