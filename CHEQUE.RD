
012280 READ-CHEQUE.
12290	     READ CHEQUE	 WITH IGNORE LOCK
012300         KEY IS CHQ-TR-NUMBER.
012310     IF WS-STATUS = "00"
               MOVE ZERO         TO WS-F-ERROR
012330         GO TO READ-CHEQUE-EXIT.
012340     IF WS-STATUS = "23"
012350         MOVE 36           TO WS-F-ERROR
012360         GO TO READ-CHEQUE-EXIT.
012370     IF WS-STAT1 = "2" OR "3" OR "4"
012380         MOVE 36           TO WS-F-ERROR
012390         PERFORM READ-ERROR.
012430       GO TO READ-CHEQUE-EXIT.

012440 READ-CHEQUE-LOCK.
012450       READ CHEQUE WITH KEPT LOCK
012460         KEY IS CHQ-TR-NUMBER.
012470     IF WS-STATUS = "00"
012480         MOVE ZERO TO WS-F-ERROR
012490         GO TO READ-CHEQUE-EXIT.
012500     IF WS-STATUS = "23"
012510         MOVE 36           TO WS-F-ERROR
012520         GO TO READ-CHEQUE-EXIT.
012530     IF WS-STAT1 = "2" OR "3" OR "4"
012540         MOVE 36           TO WS-F-ERROR
012550         PERFORM READ-ERROR.
012560     IF RECORD-LOCKED
	       MOVE W02-CHEQUE	 TO WS-FILE
	       MOVE ZERO	 TO WS-KEY
000100         PERFORM LOCKED-RECORD
012580         GO TO READ-CHEQUE-LOCK.
012590       GO TO READ-CHEQUE-EXIT.

012600 READ-CHEQUE-NEXT.
012610	     READ CHEQUE NEXT	 WITH IGNORE LOCK.
012620     IF WS-STATUS = "00"
012630         MOVE ZERO         TO WS-F-ERROR
012640         GO TO READ-CHEQUE-EXIT.
012650     IF (WS-STATUS = "23") OR
012660        (WS-STAT1 = "1")
012670         MOVE 36           TO WS-F-ERROR
012680         GO TO READ-CHEQUE-EXIT.
012690     IF WS-STAT1 = "2" OR "3" OR "4"
012700         MOVE 36           TO WS-F-ERROR
012710         PERFORM READ-ERROR.
012750       GO TO READ-CHEQUE-EXIT.

012760 START-CHEQUE-AT-TR-NO.
012770       START CHEQUE
012780         KEY >= CHQ-TR-NUMBER.
012790     IF WS-STATUS = "00"
012800         MOVE ZERO         TO WS-F-ERROR
012810         GO TO READ-CHEQUE-EXIT.
012820     IF WS-STATUS = "23"
012830         MOVE 36           TO WS-F-ERROR
012840         GO TO READ-CHEQUE-EXIT.
012850     IF WS-STAT1 = "2" OR "3" OR "4"
012860         MOVE 36           TO WS-F-ERROR
012870         PERFORM READ-ERROR.
             GO TO READ-CHEQUE-EXIT.

012280 READ-CHEQUE-DATE.
012290       READ CHEQUE
012300         KEY IS CHQ-DKEY.
012310     IF WS-STATUS = "00"
012320         MOVE ZERO         TO WS-F-ERROR
012330         GO TO READ-CHEQUE-EXIT.
012340     IF WS-STATUS = "23"
012350         MOVE 36           TO WS-F-ERROR
012360         GO TO READ-CHEQUE-EXIT.
012370     IF WS-STAT1 = "2" OR "3" OR "4"
012380         MOVE 36           TO WS-F-ERROR
012390         PERFORM READ-ERROR.
012400     IF RECORD-LOCKED
	       MOVE W02-CHEQUE	 TO WS-FILE
	       MOVE ZERO	 TO WS-KEY
000100	       PERFORM LOCKED-RECORD
012420         GO TO READ-CHEQUE-DATE.
012430       GO TO READ-CHEQUE-EXIT.

012760 START-CHEQUE-AT-DATE.
012770       START CHEQUE
012780         KEY >= CHQ-DKEY.
012790     IF WS-STATUS = "00"
012800         MOVE ZERO         TO WS-F-ERROR
012810         GO TO READ-CHEQUE-EXIT.
012820     IF WS-STATUS = "23"
012830         MOVE 36           TO WS-F-ERROR
012840         GO TO READ-CHEQUE-EXIT.
012850     IF WS-STAT1 = "2" OR "3" OR "4"
012860         MOVE 36           TO WS-F-ERROR
012870         PERFORM READ-ERROR.

012880 READ-CHEQUE-EXIT.
012890       EXIT.
