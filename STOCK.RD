      *
      *     ***  *****  ***   ***  *   *     ***** ***** *     *****
      *    *   *   *   *   * *   * *  *      *       *   *     *
      *    *       *   *   * *     * *       *       *   *     *
      *     ***    *   *   * *     **        ***     *   *     ***
      *        *   *   *   * *     * *       *       *   *     *
      *    *   *   *   *   * *   * *  *      *       *   *     *
      *     ***    *    ***   ***  *   *     *     ***** ***** *****
      *
000010 READ-STOCK.
000020	     READ STOCK 	 WITH IGNORE LOCK
000030         KEY IS STK-CODE.
000040	   IF WS-STATUS = "00"
	       IF STK-DISC NOT = 9
000050		   MOVE ZERO	 TO WS-F-ERROR
000060		   GO TO READ-STOCK-EXIT
	       ELSE
		   MOVE 22	 TO WS-F-ERROR
000060		   GO TO READ-STOCK-EXIT.
000070	   IF WS-STATUS = "23"
000080         MOVE 22           TO WS-F-ERROR
000090         GO TO READ-STOCK-EXIT.
000100     IF WS-STAT1 = "2" OR "3" OR "4"
000110         MOVE 22           TO WS-F-ERROR
000120         PERFORM READ-ERROR.
000160       GO TO READ-STOCK-EXIT.

000180 READ-STOCK-LOCK.
000190	     READ STOCK 	 WITH KEPT LOCK
000200         KEY IS STK-CODE.
000210     IF WS-STATUS = "00"
	       IF STK-DISC NOT = 9
000050		   MOVE ZERO	 TO WS-F-ERROR
000060		   GO TO READ-STOCK-EXIT
	       ELSE
		   MOVE 22	 TO WS-F-ERROR
000060		   GO TO READ-STOCK-EXIT.
000240	   IF WS-STATUS = "23"
000250         MOVE 22           TO WS-F-ERROR
000260         GO TO READ-STOCK-EXIT.
000270     IF WS-STAT1 = "2" OR "3" OR "4"
000280         MOVE 22           TO WS-F-ERROR
000290         PERFORM READ-ERROR.
000300     IF RECORD-LOCKED
	       MOVE W02-STOCKF	 TO WS-FILE
	       MOVE ZERO	 TO WS-KEY
000310         PERFORM LOCKED-RECORD
000320         GO TO READ-STOCK-LOCK.
000330     IF TOO-MANY-LOCKS
000340         UNLOCK STOCK
000350         GO TO READ-STOCK-LOCK.
000360       GO TO READ-STOCK-EXIT.

000380 READ-STOCK-NEXT.
000390	     READ STOCK NEXT	 WITH IGNORE LOCK.
000400     IF WS-STATUS = "00"
	       IF STK-DISC NOT = 9
000050		   MOVE ZERO	 TO WS-F-ERROR
000060		   GO TO READ-STOCK-EXIT
	       ELSE
000060		   GO TO READ-STOCK-NEXT.
000430	   IF (WS-STATUS = "23") OR
000440        (WS-STAT1 = "1")
000450         MOVE 22           TO WS-F-ERROR
000460         GO TO READ-STOCK-EXIT.
000470     IF WS-STAT1 = "2" OR "3" OR "4"
000480         MOVE 22           TO WS-F-ERROR
000490         PERFORM READ-ERROR.
000530       GO TO READ-STOCK-EXIT.

000550 READ-STOCK-NEXT-LOCK.
000560       READ STOCK NEXT WITH KEPT LOCK.
000570     IF WS-STATUS = "00"
	       IF STK-DISC NOT = 9
000050		   MOVE ZERO	 TO WS-F-ERROR
000060		   GO TO READ-STOCK-EXIT
	       ELSE
000060		   GO TO READ-STOCK-NEXT-LOCK.
000600	   IF (WS-STATUS = "23") OR
000610        (WS-STAT1 = "1")
000620         MOVE 22           TO WS-F-ERROR
000630         GO TO READ-STOCK-EXIT.
000640     IF WS-STAT1 = "2" OR "3" OR "4"
000650         MOVE 22           TO WS-F-ERROR
000660         PERFORM READ-ERROR.
000670     IF RECORD-LOCKED
	       MOVE W02-STOCKF	 TO WS-FILE
	       MOVE ZERO	 TO WS-KEY
000680         PERFORM LOCKED-RECORD
000690         GO TO READ-STOCK-NEXT-LOCK.
000700     IF TOO-MANY-LOCKS
000710         UNLOCK STOCK
000720         GO TO READ-STOCK-NEXT-LOCK.
000730       GO TO READ-STOCK-EXIT.

000380 READ-STOCK-PREV.
000390	     READ STOCK PREVIOUS WITH IGNORE LOCK.
000400     IF WS-STATUS = "00"
	       IF STK-DISC NOT = 9
000050		   MOVE ZERO	 TO WS-F-ERROR
000060		   GO TO READ-STOCK-EXIT
	       ELSE
000060		   GO TO READ-STOCK-PREV.
000430	   IF (WS-STATUS = "23") OR
000440        (WS-STAT1 = "1")
000450         MOVE 22           TO WS-F-ERROR
000460         GO TO READ-STOCK-EXIT.
000470     IF WS-STAT1 = "2" OR "3" OR "4"
000480         MOVE 22           TO WS-F-ERROR
000490         PERFORM READ-ERROR.
000530       GO TO READ-STOCK-EXIT.

000750 START-AT-STOCK-CODE.
000760       START STOCK 
000770	       KEY >= STK-CODE.
	     GO TO STOCK-CHECK-STATUS.

000890 START-AT-ALT-CODE.
000900       START STOCK
000910         KEY >= STK-ACODE.
	     GO TO STOCK-CHECK-STATUS.

001030 START-AT-STOCK-BIN.
001040       START STOCK
001050         KEY >= STK-BSEQ.
	     GO TO STOCK-CHECK-STATUS.

001170 START-AT-STOCK-LEDG.
001180       START STOCK
001190         KEY >= STK-LSEQ.
	     GO TO STOCK-CHECK-STATUS.

001310 START-AT-STOCK-DESC.
001320       START STOCK
001330         KEY >= STK-DKEY.
	     GO TO STOCK-CHECK-STATUS.

001310 START-AT-STOCK-DESC2.
001320       START STOCK
001330	       KEY >= STK-DKEY2.
	     GO TO STOCK-CHECK-STATUS.

001450 START-AT-STOCK-XREF.
001460       START STOCK
001470         KEY >= STK-XREF.

       STOCK-CHECK-STATUS.
001480	   IF WS-STATUS = "00"
001490         MOVE ZERO         TO WS-F-ERROR
001500         GO TO READ-STOCK-EXIT.
001510     IF WS-STATUS = "23"
001520         MOVE 22           TO WS-F-ERROR
001530         GO TO READ-STOCK-EXIT.
001540     IF WS-STAT1 = "2" OR "3" OR "4"
001550         MOVE 22           TO WS-F-ERROR
001560         PERFORM READ-ERROR.

001580 READ-STOCK-EXIT.
001590       EXIT.
