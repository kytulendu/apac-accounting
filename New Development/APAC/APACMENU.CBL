      $SET LINKCOUNT"256"
      ******************************************************************
      *                                                                *
      *    ****    *******    ******   **     **  ********  **	 **  *
      *   **  **   **	 **  **    **  ***   ***  **	      ***    **  *
      *  **    **  **    **  **        ** * * **  **        ** *   **  *
      *  ********  *******   **	   **  *  **  *****     **  *  **  *
      *  **    **  **	     **        **     **  **	      **   * **  *
      *  **    **  **	     **    **  **     **  **	      **    ***  *
      *  **    **  **	      ******   **     **  *******   **	 **  *
      *                                                                *
      *     ENGLISH                                                    *
      *                                                                *
      *     B U S I N E S S   S Y S T E M   M E N U   P R O G R A M    *
      *                                                                *
      *     VERSION 9.00.00 - November 2012                            *
      *                                                                *
      ******************************************************************
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		    VERSIONS OF THE APAC SYSTEM	           ณ
      *    ฦอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออต
      *    ณ While developing this system the requirements and budgets ณ
      *    ณ (originally this was a propriety package) for various     ณ
      *    ณ businesses necessitated that at least 4 separate systems  ณ
      *    ณ be produced. As the maintenance and amendments to the 4   ณ
      *    ณ different systems would require man hours that would not  ณ
      *    ณ enable me to do much development, it was decided to use   ณ
      *    ณ one system with the various requirements controlled by    ณ
      *    ณ the various menu programs using a version indicator. This ณ
      *    ณ indicator is located in the second record of the SYSTEM   ณ
      *    ณ file SEC-LEV, which is in the SEC-MODULES. This indicator ณ
      *    ณ together with all the other indicators in SEC-MODULES, is ณ
      *    ณ moved to WS0-MODULES in BUP000 or BUP001 and then passed  ณ
      *    ณ via the LINKAGE SECTION from program to program in  the   ณ
      *    ณ LS0-MODULES group. The other indicators in this group are ณ
      *    ณ used to show which modules of the system are installed.   ณ
      *    ฦอออออออออออออออออออัอออออออออออออออออออัอออออออออออออออออออต
      *    ณ    SYSTEM FILE    ณ      CHAIN.WS	   ณ	   CHAIN.LS      ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ  03  SEC-MODULES. ณ  03  WS0-MODULES. ณ  03  LS0-MODULES. ณ
      *    ณ      05  SEC-DTP  ณ      05  WS0-DTP  ณ	    05  LS0-DTP  ณ
      *    ณ      05  SEC-STP  ณ      05  WS0-STP  ณ	    05  LS0-STP  ณ
      *    ณ      05  SEC-HPD  ณ      05  WS0-HPD  ณ	    05  LS0-HPD  ณ
      *    ณ      05  SEC-CRP  ณ      05  WS0-CRP  ณ	    05  LS0-CRP  ณ
      *    ณ      05  SEC-GLP  ณ      05  WS0-GLP  ณ	    05  LS0-GLP  ณ
      *    ณ      05  SEC-POS  ณ      05  WS0-POS  ณ	    05  LS0-POS  ณ
      *    ณ      05  SEC-JCP  ณ      05  WS0-JCP  ณ	    05  LS0-JCP  ณ
      *    ณ      05  SEC-VHP  ณ      05  WS0-VHP  ณ	    05  LS0-VHP  ณ
      *    ณ      05  SEC-WAG  ณ      05  WS0-WAG  ณ	    05  LS0-WAG  ณ
      *    ณ      05  SEC-SAL  ณ      05  WS0-SAL  ณ	    05  LS0-SAL  ณ
      *    ณ      05  SEC-LEV  ณ      05  WS0-LEV  ณ	    05  LS0-LEV  ณ
      *    ณ      05  SEC-WHS  ณ      05  WS0-WHS  ณ	    05  LS0-WHS  ณ
      *    ณ      05  SEC-RTE  ณ      05  WS0-RTE  ณ	    05  LS0-RTE  ณ
      *    ณ      05  FILLER   ณ		         ณ		           ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
      *
000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.     APACMENU.
000030 AUTHOR.         J W LEMMON (APAC).
000040 DATE-WRITTEN.   APRIL 1993.

		   COPYRIGHT NOTICE: COPYRIGHT (C) 1993 - 2013
				     by James William Lemmon.
				       (Id No. 4412165050082).

		   All rights reserved.

		   e-mail jwlemmon@gmail.com.

000050 SECURITY.
		   This program is free software; you can redistribute
		   it and/or modify it under the terms of the GNU General
		   Public License as published by the Free Software
		   Foundation; either version 2 of the License, or (at
		   your option) any later version.

		   This program is distributed in the hope that it will
		   be useful, but WITHOUT ANY WARRANTY; without even the
		   implied warranty of MERCHANTABILITY or FITNESS FOR A
		   PARTICULAR PURPOSE. See the GNU General Public License
		   for more details.

		   You should have received a copy of the GNU General
		   Public License along with this program; if not, write
		   to the Free Software Foundation, Inc., 59 Temple Place
		   - Suite 330, Boston, MA 02111-1307, USA.

000050 ENVIRONMENT DIVISION.
000060 CONFIGURATION SECTION.
000070 SPECIAL-NAMES.
000080		       CURSOR IS CSTART
000090		       CONSOLE IS CRT
                         CRT STATUS IS KEY-STATUS.
000090 INPUT-OUTPUT SECTION.
000100 FILE-CONTROL.

       COPY "APACFIDS.SL".

000130 COPY "CONTROL.SL".

000190 COPY "DEPART.SL".

000210 COPY "PARAM.SL".

       COPY "SHARED.SL".

       COPY "TXTRAN.SL".

      /
000330 DATA DIVISION.
000340 FILE SECTION.

       COPY "APACFIDS.FDE".

000360 COPY "CONTROL.FDE".

000420 COPY "DEPART.FDE".

000440 COPY "PARAM.FDE".

       COPY "SHARED.FDE".

       COPY "TXTRAN.FDE".

      /
000560 WORKING-STORAGE SECTION.
       77  WS-CHECK	   PIC  X(18)    VALUE "aeWlimemnomLalismJ".
000610 77  WS-S1           PIC  9(04)    COMP-5.
000620 77  WS-S2           PIC  9(04)    COMP-5.
000630 77  WS-S3           PIC  9(04)    COMP-5.
000640 77  WS-S4           PIC  9(04)    COMP-5.
000820 77  WS-SHARED       PIC  9(04)    COMP-5 VALUE 1.
000820 77  WS-NETKEY       PIC  9(04)    COMP-5.
000750 77  WS-PARKEY       PIC  9(04)    COMP-5.
       77  WS-TEMP-LIN	   PIC  9(02)    COMP-5.
       77  WS-OPTION	   PIC  X(01).
       77  PRG-NAME	   PIC  X(12)    VALUE SPACES.
       77  WS-NUM          PIC  Z9.
       77  WS-CONV	   PIC  9(01).
       77  APAC-SYSTEM	   PIC  X(12).
       77  APAC-VERSION    PIC  X(04).

      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ Used by calling program (WORKING-STORAGE) and called program ณ
      *    ณ (LINKAGE SECTION) for Main screen layout and headings.	  ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
       01  CRT-HEADINGS.
      *
      *    TYPE:
      *	     C = Clear comment line (50)
      *	     E = Clear lines (any line or lines between 5 and 46)
      * 	     H = Change heading
      * 	     S = Clear the screen and display headings
      *
         03  CRT-TYPE                PIC  X(01).
      *
      *    The following two fields are used for clearing a portion of
      *    the screen. (Start line and end line)
      *
         03  CRT-START               PIC  9(02).
         03  CRT-END	             PIC  9(02).
      *
      *    Calling Program
      *
         03  CRT-PROGRAM             PIC  X(15) VALUE "APACMENU".
      *
      *    Screen Heading
      *
         03  CRT-HEADING             PIC  X(40) VALUE "SUPERVISOR MENU".
      *
      *    Company Name
      *
         03  CRT-COMPANY             PIC  X(40).
      *
      *    WorkStation / Supervisor
      *
         03  CRT-WRKHD               PIC  X(11).
         03  CRT-WRKST               PIC  X(03) VALUE "ฤฤฤ".

001350 01  WS-CRT-LINES.
001380     03  WS-TOP-LNE2.
001390         05  WS-TCR   PIC  X(80) VALUE "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ".
001400     03  WS-TP-LINE2 REDEFINES WS-TOP-LNE2.
001410         05  FILLER      PIC  X(01).
001420         05  WS-TOP-COMP PIC  X(40).
001430         05  FILLER      PIC  X(23).
               05  WS-WRKHD    PIC  X(11).
001430         05  FILLER      PIC  X(01).
               05  WS-WRKST    PIC  X(03).
001430         05  FILLER      PIC  X(01).
001460     03  WS-MID-LNE2.
               05  FILLER      PIC  X(01) VALUE "ณ".
               05  WS-BLNK78   PIC  X(78) VALUE ALL "ฐ".
               05  FILLER      PIC  X(01) VALUE "ณ".

001840 COPY "WS.WS".

       01  WS-HELP.
           03  WS-MODULE       PIC  X(03) VALUE "APC".
           03  WS-PROG	       PIC  X(03) VALUE "MEN".

001860 COPY "CHAIN.WS".

002040 01  W02-FID.

       COPY "APACFIDS.ID".

002060 COPY "CONTROL.ID".

002120 COPY "DEPART.ID".

       COPY "PARAM.ID".

       COPY "SHARED.ID".

       COPY "TXTRAN.ID".

001160 01  W05-COMMAND.
001170     03  W05-CHAR        PIC  X(128).

       COPY "W12.WS".

       COPY "W40.WS".

       COPY "FUNCTION.WS".

004540 COPY "W50.WS".

      /
000750 SCREEN SECTION.

       01  MENU-INSTRUCT.
	     03  BACKGROUND-COLOR Cyan.
	         05  LINE 50 COLUMN  2 FOREGROUND-COLOR Blue	          VALUE "Use ".
	         05          COLUMN  6 FOREGROUND-COLOR Brown HIGHLIGHT VALUE "".
	         05          COLUMN  7 FOREGROUND-COLOR Blue	          VALUE " or ".
	         05          COLUMN 11 FOREGROUND-COLOR Brown HIGHLIGHT VALUE "".
	         05          COLUMN 12 FOREGROUND-COLOR Blue	          VALUE " to point to an item, and ".
	         05          COLUMN 38 FOREGROUND-COLOR Brown HIGHLIGHT VALUE "<Enter>".
	         05          COLUMN 45 FOREGROUND-COLOR Blue	          VALUE " to Select ".

000850 01  S-PROG.
000860     03  LINE  2 COLUMN 34 BACKGROUND-COLOR Blue FOREGROUND-COLOR Grey HIGHLIGHT VALUE "APAC MAIN MENU".

       01  S-MENU.
           03  BACKGROUND-COLOR Magenta.
               05  LINE  6 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ".
               05          COLUMN 51 FOREGROUND-COLOR Black   HIGHLIGHT VALUE "ฟ".
               05  LINE  7 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ  ".
               05          COLUMN 33 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "PROGRAM  CONTROL".
               05          COLUMN 49 FOREGROUND-COLOR Black	            VALUE "  ณ".
               05  LINE  8 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "1".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Stock            ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE  9 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "2".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Creditors        ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
001470         05  LINE 10 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "3".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Debtors          ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
001570         05  LINE 11 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "4".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " General Ledger   ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
001500         05  LINE 12 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "5".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Sales / Orders   ".
               05          COLUMN 51 FOREGROUND-COLOR Black             VALUE "ณ".
               05  LINE 13 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "6".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Point-of-Sale    ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE 14 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "7".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Job Costing      ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE 15 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "8".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Period End/Dates ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE 16 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "A".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Utilities        ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE 17 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "B".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Add Bus/Company  ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE 18 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "C".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Switch Companies ".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE 19 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "D".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Print Spool File ".
               05          COLUMN 51 FOREGROUND-COLOR Black             VALUE "ณ".
               05  LINE 20 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "E".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Cheque Processing".
               05          COLUMN 51 FOREGROUND-COLOR Black	            VALUE "ณ".
               05  LINE 21 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "F".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Orders Spec.     ".
               05          COLUMN 51 FOREGROUND-COLOR Black             VALUE "ณ".
               05  LINE 22 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "L".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " Login/Logout     ".
               05          COLUMN 51 FOREGROUND-COLOR Black             VALUE "ณ".
               05  LINE 23 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ณ ".
               05          COLUMN 32 FOREGROUND-COLOR Grey	  HIGHLIGHT VALUE "9".
               05          COLUMN 33 FOREGROUND-COLOR Cyan	  HIGHLIGHT VALUE " End System       ".
               05          COLUMN 51 FOREGROUND-COLOR Black             VALUE "ณ".
               05  LINE 24 COLUMN 30 FOREGROUND-COLOR Magenta HIGHLIGHT VALUE "ภ".
               05          COLUMN 31 FOREGROUND-COLOR Black             VALUE "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".

002480 01  S98.
           03  BACKGROUND-COLOR Red.
               05  LINE 21 COLUMN 14 FOREGROUND-COLOR Red	HIGHLIGHT VALUE "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ".
               05          COLUMN 66 FOREGROUND-COLOR Black           VALUE "ฟ".
002490         05  LINE 22 COLUMN 14 FOREGROUND-COLOR Red	HIGHLIGHT VALUE "ณ".
               05          COLUMN 15 FOREGROUND-COLOR Grey	HIGHLIGHT VALUE "Do not forget to make security copies of your files".
               05          COLUMN 66 FOREGROUND-COLOR Black           VALUE "ณ".
               05  LINE 23 COLUMN 14 FOREGROUND-COLOR Red	HIGHLIGHT VALUE "ภ".
               05	         COLUMN 15 FOREGROUND-COLOR Black           VALUE "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".
               05  LINE 49 COLUMN 79 BACKGROUND-COLOR Blue  FOREGROUND-COLOR Cyan VALUE "ฤ".

002480 01  S98T.
           03  BACKGROUND-COLOR Red.
               05  LINE 21 COLUMN 22 FOREGROUND-COLOR Red	HIGHLIGHT VALUE "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ".
               05	         COLUMN 59 FOREGROUND-COLOR Black	          VALUE "ฟ".
002490	   05  LINE 22 COLUMN 22 FOREGROUND-COLOR Red	HIGHLIGHT VALUE "ณ".
002490	   05	         COLUMN 23 FOREGROUND-COLOR Grey	HIGHLIGHT VALUE "The terminal may now be switched off".
               05	         COLUMN 59 FOREGROUND-COLOR Black	          VALUE "ณ".
               05  LINE 23 COLUMN 22 FOREGROUND-COLOR Red	HIGHLIGHT VALUE "ภ".
               05	         COLUMN 23 FOREGROUND-COLOR Black	          VALUE "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู".
               05  LINE 49 COLUMN 79 BACKGROUND-COLOR Blue  FOREGROUND-COLOR Cyan VALUE "ฤ".

      /
010570 PROCEDURE DIVISION.
       AA000	       SECTION.
       AA00.
             ACCEPT W05-COMMAND FROM COMMAND-LINE.
             PERFORM ZA000-INIT.
           IF WS0-POS > 0
	         IF WS0-CRED = "N" AND WS0-STOCK = "N" AND WS0-DEBT = "N" AND WS0-JOBS = "N" AND WS0-PARM = "N" AND WS0-WAGES = "N" AND WS0-GL = "N"
                   GO TO AA10.
             DISPLAY S-PROG.
             PERFORM BA000.
           IF MOUSE-ATTACHED = "Y"
               MOVE 66               TO MOUSE-FUNC
               MOVE 0                TO MOUSE-PARAM
               CALL X"AF" USING MOUSE-FUNC MOUSE-PARAM.
             MOVE "S"                TO CRT-TYPE.
007750       CALL "UTP\CRTHEAD" USING CRT-HEADINGS LS-PARID LS-USER-ID LS0-PROGRAMS LS0-SECURITY.
           IF WS-USER NUMERIC
               MOVE 22               TO SHADE-ROW
               MOVE 24               TO SHADE-COL
               MOVE 36               TO SHADE-WIDTH
               MOVE 2                TO SHADE-LINES
007820         DISPLAY S98T
               PERFORM SCREEN-SHADOW
               STOP RUN.
       AA05.
      *    *************************************************************
      *    ****    P A R A M E T E R   F I L E
      *    *************************************************************
             PERFORM ZA00A THRU ZA00A-CONTINUE.
             OPEN I-O PARAM.
038210     IF RUNTIME-ERROR
038220         IF FLE-LOCKED OR FLE-LIMIT
                   DISPLAY "WAITING" AT 5002 WITH BACKGROUND-COLOR Cyan FOREGROUND-COLOR Brown HIGHLIGHT
038230             GO TO AA05.
038270     IF WS-STATUS NOT = "00" AND WS-STAT1 NOT = "4"
038280         MOVE 15               TO WS-F-ERROR
038290         PERFORM OPEN-ERROR.
               MOVE 4                TO WS-PARKEY.
007710       PERFORM READ-PARAM-LOCK THRU READ-PARAM-EXIT.
007780       MOVE ZERO               TO PAR-LOGON.
007790       REWRITE PAR-RECORD1.
             MOVE 3                  TO WS-PARKEY.
007710       PERFORM READ-PARAM-LOCK THRU READ-PARAM-EXIT.
007800       UNLOCK PARAM.
007810       CLOSE PARAM.
             MOVE 22                 TO SHADE-ROW.
             MOVE 16                 TO SHADE-COL.
             MOVE 51                 TO SHADE-WIDTH.
             MOVE 2                  TO SHADE-LINES.
007820       DISPLAY S98.
             PERFORM SCREEN-SHADOW.
             CLOSE APACFIDS.
007830       STOP RUN.

       AA10.
             MOVE "MNU\POSMENU"      TO PRG-NAME.
             PERFORM AA100.
           IF MOUSE-ATTACHED = "Y"
               MOVE 66               TO MOUSE-FUNC
               MOVE 0                TO MOUSE-PARAM
               CALL X"AF" USING MOUSE-FUNC MOUSE-PARAM.
             MOVE "S"                TO CRT-TYPE.
007750       CALL "UTP\CRTHEAD" USING CRT-HEADINGS LS-PARID LS-USER-ID LS0-PROGRAMS LS0-SECURITY.
             DISPLAY S98.
             STOP RUN.

       AA100	       SECTION.
       AA101.
             PERFORM ZA00A THRU ZA999.
           IF WS-OPTION = "Y"
               PERFORM CA000
               IF WS-OPTION = "8"
	             PERFORM CLEAR-BLOCK
                   MOVE 11           TO SCREEN-LIN
                   PERFORM SAVE-ATTR
                   PERFORM MARK-BLOCK
                   MOVE "Z"          TO WS-OK
                   MOVE "MNU\UTILMENU" TO PRG-NAME.
           IF MOUSE-ATTACHED = "Y"
               MOVE 66               TO MOUSE-FUNC
               MOVE 0                TO MOUSE-PARAM
               CALL X"AF" USING MOUSE-FUNC MOUSE-PARAM.
             PERFORM SAVE-SCREEN-3.

       AA102.
             MOVE SPACES             TO WS-NEXT-PRG.
             CALL PRG-NAME USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY
	            ON EXCEPTION GO TO AA110
             END-CALL.
            CANCEL PRG-NAME.
          IF NOT(WS-NEXT-PRG = SPACES)
              MOVE WS-NEXT-PRG       TO PRG-NAME
              GO TO AA102.

       AA105.
           IF WS-DEM = 1 AND WS-DAYS > 80
               CALL "UTP\SYS001" USING WS-PARID WS-USER-ID WS0-PROGRAMS
               CANCEL "UTP\SYS001".
             PERFORM RESTORE-SCREEN-3.
           IF MOUSE-ATTACHED = "Y"
               MOVE 66               TO MOUSE-FUNC
               MOVE 1                TO MOUSE-PARAM
               CALL X"AF" USING MOUSE-FUNC MOUSE-PARAM.
013040       CLOSE NETWORK DEPART PARAM SHARED TXTRAN.
             GO TO AA199.

       AA110.
             MOVE SPACE              TO WS-ERR-MES.
             STRING "Program- " DELIMITED SIZE PRG-NAME DELIMITED " " " not on disk, press ANY key" DELIMITED SIZE INTO WS-ERR-MES.
             PERFORM ERROR-LENGTH THRU ERROR-EXIT.
             GO TO AA105.

       AA199.
             EXIT.

      /    *************************************************************
      *    ****    ROUTINES TO HANDLE VARIOUS FUNCTIONS FOR THE
      *           S C R E E N ,   K E Y B O A R D   &  M O U S E
      *    *************************************************************
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ       SAVE-SCREEN /-2/-3  and  RESTORE-SCREEN /-2/-3      ณ
      *    ฦอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออต
      *    ณ			  SCREEN-SHADOW 		       ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ To routine is used to display a shadow down the right and ณ
      *    ณ along the bottom of a pop-up box. The parameters that are ณ
      *    ณ required:	                                               ณ
      *    ณ           SHADE-ROW   - Top line of the box + 1.          ณ
      *    ณ           SHADE-COL   - Left line of box + 2.             ณ
      *    ณ           SHADE-WIDTH - Width of the box - 2.             ณ
      *    ณ           SHADE-LINES - Hight of box - 1.                 ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

       COPY "FUNCTION.SCR".

      /    *************************************************************
      *    ****   T H I S   R O U T I N E   I S   U S E D   T O
      * 	  D I S P L A Y   E R R O R   M E S S A G E S
      *    *************************************************************
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ                      ERROR-MESSAGE                        ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ To display the error message higher or lower (default is  ณ
      *    ณ line 20) Move the line number which must be used as the   ณ
      *    ณ top line to WS-MES-LINE. The message to be displayed must ณ
      *    ณ be in WS-ERR-MES. PERFORM ERROR-MESSAGE.                  ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

       COPY "ERROR.SCR".

       COPY "LOCKED.RC2".

      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	      ERASE SCREEN FROM SPECIFIED LOCATION	       ณ
      *    รฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤด
      *    ณ Uses CPOS (CLIN,CCOL) as starting position and increases  ณ
      *    ณ CLIN by 1 until CLIN reaches the line allocated to exit.  ณ
      *    ณ The screen is cleared with Column 1 and 80 containing "ณ" ณ
      *    ณ and columns 2 to 79 containing spaces.		       ณ
      *    ณ  eg.						       ณ
      *    ณ	  MOVE 0801	 TO CPOS.			       ณ
      *    ณ	  PERFORM ERASE-SCREEN-LOOP UNTIL CLIN > 19.	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

011433 COPY CLEAR.CRT.

      /    *************************************************************
      *    ****    READ FILES ROUTINES
      *    *************************************************************
008680 AC000              SECTION.

011750 COPY PARAM.RD.

       COPY APAC.HLP.

       BA000	       SECTION 50.
       BA00.
             MOVE 8                  TO SHADE-ROW.
             MOVE 32                 TO SHADE-COL.
             MOVE 20                 TO SHADE-WIDTH.
             MOVE 18                 TO SHADE-LINES.
             DISPLAY S-MENU.
           IF WS0-POS < 2
               DISPLAY "(N/A)" AT 1046 WITH FOREGROUND-COLOR Cyan HIGHLIGHT BACKGROUND-COLOR Magenta.
           IF (WS0-LEV < 4) AND (WS0-JCP < 2)
               DISPLAY "(N/A)" AT 1146 WITH FOREGROUND-COLOR Cyan HIGHLIGHT BACKGROUND-COLOR Magenta.
           IF WS0-LEV < 3
              DISPLAY " Add Bus/Com (N/A)" AT 1433 WITH FOREGROUND-COLOR Cyan HIGHLIGHT BACKGROUND-COLOR Magenta
              DISPLAY " Switch Comp (N/A)" AT 1533 WITH FOREGROUND-COLOR Cyan HIGHLIGHT BACKGROUND-COLOR Magenta
              DISPLAY ".(N/A)" AT 1745 WITH FOREGROUND-COLOR Cyan HIGHLIGHT BACKGROUND-COLOR Magenta
              DISPLAY "(N/A)" AT 1846 WITH FOREGROUND-COLOR Cyan HIGHLIGHT BACKGROUND-COLOR Magenta.
      *    IF (DEB-ORD-SYS = "Y")
             DISPLAY MENU-INSTRUCT.
             PERFORM SCREEN-SHADOW.

       BA02.
             MOVE 8	             TO TOP-ROW.
             MOVE 23                 TO BOTTOM-ROW.
             MOVE 3                  TO SCREEN-LIN.
             MOVE 32                 TO SCREEN-COL.
             MOVE 18                 TO STRING-LENGTH.
	       PERFORM SAVE-ATTR.

       BA05.
             CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.

       BA10.
           IF USER-FUNC
               EVALUATE KEY-CODE-1
                 WHEN F1-KEY
                      PERFORM HELP-ROUTINE
                 WHEN OTHER CALL X"E5"
               END-EVALUATE
               GO TO BA05
           ELSE
           IF ADIS-FUNC
               EVALUATE KEY-CODE-1
                 WHEN UP-KEY
                      PERFORM MOVE-BLOCK-UP
                 WHEN DOWN-KEY
                      PERFORM MOVE-BLOCK-DOWN
                 WHEN MOUSE-KEY
                      PERFORM POSITION-MOUSE
                      IF MOUSE-ENTER = "Y"
                          MOVE "N"   TO MOUSE-ENTER
                          GO TO BA15
                      END-IF
                      IF MOUSE-Y = 24
                          IF MOUSE-X = 5
                              MOVE 5 TO KEY-CODE-1
                              GO TO BA10
                          ELSE
                          IF MOUSE-X = 10
                              MOVE 6 TO KEY-CODE-1
                              GO TO BA10
                          ELSE
                          IF MOUSE-X > 36 AND < 44
                              MOVE 0 TO KEY-CODE-1
                              GO TO BA10
                          ELSE
                          IF MOUSE-X > 54 AND < 60
                              MOVE 0 TO KEY-CODE-1
                              MOVE 1 TO KEY-TYPE
                              GO TO BA10
                          END-IF
                      END-IF
                 WHEN ENTER-KEY
                      GO TO BA15
                 WHEN OTHER
                      CALL X"E5"
               END-EVALUATE
               GO TO BA05
           ELSE
           IF DATA-8BIT
               MOVE KEY-CODE-1X  TO WS-OPTION
               CALL "CBL_TOUPPER" USING WS-OPTION BY VALUE WS-LENGTH RETURNING WS-STATUS
               IF (WS-OPTION < 1 OR > 9) AND (WS-OPTION < "A" OR > "F") AND (WS-OPTION NOT = "L")
	             CALL X"E5"
	             GO TO BA05
               END-IF
               GO TO BA16
           ELSE
               CALL X"E5"
               GO TO BA05.

       BA15.
             EVALUATE SCREEN-LIN
               WHEN 4
                    MOVE "1"	 TO WS-OPTION
               WHEN 5
                    MOVE "2"	 TO WS-OPTION
               WHEN 6
                    MOVE "3"	 TO WS-OPTION
               WHEN 7
	    MOVE "4"	 TO WS-OPTION
               WHEN 8
	    MOVE "5"	 TO WS-OPTION
               WHEN 9
	    MOVE "6"	 TO WS-OPTION
               WHEN 10
	    MOVE "7"	 TO WS-OPTION
               WHEN 11
	    MOVE "8"	 TO WS-OPTION
               WHEN 12
	    MOVE "A"	 TO WS-OPTION
               WHEN 13
	    MOVE "B"	 TO WS-OPTION
               WHEN 14
	    MOVE "C"	 TO WS-OPTION
               WHEN 15
	    MOVE "D"	 TO WS-OPTION
               WHEN 16
	    MOVE "E"	 TO WS-OPTION
               WHEN 17
	    MOVE "F"	 TO WS-OPTION
               WHEN 18
	    MOVE "L"	 TO WS-OPTION
               WHEN 19
	    MOVE "9"	 TO WS-OPTION
               WHEN OTHER
	   CALL X"E5" CALL X"E5" CALL X"E5"
	   GO TO BA05
             END-EVALUATE.
     GO TO BA18.

       BA16.
	     PERFORM CLEAR-BLOCK.
	     EVALUATE WS-OPTION
	       WHEN "9"
		    MOVE 19	 TO SCREEN-LIN
	       WHEN "1"
		    MOVE 4	 TO SCREEN-LIN
	       WHEN "2"
		    MOVE 5	 TO SCREEN-LIN
	       WHEN "3"
		    MOVE 6	 TO SCREEN-LIN
	       WHEN "4"
		    MOVE 7	 TO SCREEN-LIN
	       WHEN "5"
		    MOVE 8	 TO SCREEN-LIN
	       WHEN "6"
		    MOVE 9	 TO SCREEN-LIN
	       WHEN "7"
		    MOVE 10	 TO SCREEN-LIN
	       WHEN "8"
		    MOVE 11	 TO SCREEN-LIN
	       WHEN "A"
		    MOVE 12	 TO SCREEN-LIN
	       WHEN "B"
		    MOVE 13	 TO SCREEN-LIN
	       WHEN "C"
		    MOVE 14	 TO SCREEN-LIN
	       WHEN "D"
		    MOVE 15	 TO SCREEN-LIN
	       WHEN "E"
		    MOVE 16	 TO SCREEN-LIN
	       WHEN "F"
		    MOVE 17	 TO SCREEN-LIN
	       WHEN "L"
		    MOVE 18	 TO SCREEN-LIN
	     END-EVALUATE.
	     PERFORM SAVE-ATTR.
	     PERFORM MARK-BLOCK.

       BA18.
	   IF WS-DAYS > 91
	     DISPLAY "This package must be legalised - PHONE JW Lemmon - 082-566-3095" AT 2302 WITH FOREGROUND-COLOR Red HIGHLIGHT
	     GO TO BA05.
	     EVALUATE WS-OPTION
	       WHEN "9"
		    GO TO BA999
	       WHEN "1"
		    MOVE "MNU\STPMENU"	   TO PRG-NAME
	       WHEN "2"
		    MOVE "MNU\CRPMENU"	   TO PRG-NAME
	       WHEN "3"
		    MOVE "MNU\DTPMENU"	   TO PRG-NAME
	       WHEN "4"
		    MOVE "MNU\GLPMENU"	   TO PRG-NAME
	       WHEN "5"
		    MOVE "MNU\SLPMENU"	   TO PRG-NAME
	       WHEN "6"
		    IF WS0-POS = 0
			MOVE "MNU\NOPMENU" TO PRG-NAME
		    ELSE
			MOVE "MNU\SALMENU" TO PRG-NAME
	       WHEN "7"
		    IF (WS0-LEV < 4) AND (WS0-JCP < 2)
			MOVE "MNU\NOPMENU" TO PRG-NAME
		    ELSE
			MOVE "MNU\JCPMENU" TO PRG-NAME
	       WHEN "8"
		    MOVE "MNU\REPMENU"	   TO PRG-NAME
	       WHEN "A"
		    MOVE "MNU\UTILMENU"    TO PRG-NAME
	       WHEN "B"
		    IF WS0-LEV < 3
			MOVE "MNU\NOPMENU" TO PRG-NAME
		    ELSE
			MOVE "UTP\SYSNEW"  TO PRG-NAME
	       WHEN "D"
		    MOVE "UTP\SPOOLPRN"    TO PRG-NAME
	       WHEN "E"
		    IF WS0-LEV < 3
			MOVE "MNU\NOPMENU" TO PRG-NAME
		    ELSE
			MOVE "UTP\PRNCHQ"  TO PRG-NAME
	       WHEN "F"
		    IF WS0-LEV < 3
			MOVE "MNU\NOPMENU" TO PRG-NAME
		    ELSE
			MOVE "SLP\ORDSPC"  TO PRG-NAME
	       WHEN "L"
		    MOVE "UTP\USR001"	   TO PRG-NAME
	     END-EVALUATE.
      *	   ELSE
      *	   IF WS0-LEV < 3
      *	       MOVE "MNU\NOPMENU"
      *				 TO PRG-NAME
      *	   ELSE
      *	   IF (WS0-DBLEV < 3) AND (WS0-STLEV < 3) AND
      *	      (WS0-GLLEV < 3) AND (WS0-CRLEV < 3)
      *	       MOVE "MNU\NOPMENU" TO PRG-NAME
      *	   ELSE
      *	       GO TO BA20.
	     PERFORM AA100.
	     DISPLAY MENU-INSTRUCT.
	     GO TO BA05.

       BA20.
           IF MOUSE-ATTACHED = "Y"
               MOVE 66		 TO MOUSE-FUNC
               MOVE 0		 TO MOUSE-PARAM
               CALL X"AF" USING MOUSE-FUNC MOUSE-PARAM.
             MOVE "S"                TO CRT-TYPE.
007750       CALL "UTP\CRTHEAD" USING CRT-HEADINGS LS-PARID LS-USER-ID LS0-PROGRAMS LS0-SECURITY.

       BA25.
      *    *************************************************************
      *    ****    P A R A M E T E R   F I L E
      *    *************************************************************
             OPEN I-O PARAM.
038210     IF RUNTIME-ERROR
038220         IF FLE-LOCKED OR FLE-LIMIT
                   DISPLAY "WAITING" AT 5002 WITH BACKGROUND-COLOR Cyan FOREGROUND-COLOR Brown HIGHLIGHT
038230             GO TO AA05.
038270     IF WS-STATUS NOT = "00"
038280         MOVE 15           TO WS-F-ERROR
038290         PERFORM OPEN-ERROR.
	     MOVE 4		 TO WS-PARKEY.
007710	     PERFORM READ-PARAM-LOCK THRU READ-PARAM-EXIT.
007780	     MOVE ZERO		 TO PAR-LOGON.
007790       REWRITE PAR-RECORD1.
	     MOVE 3		 TO WS-PARKEY.
007710	     PERFORM READ-PARAM-LOCK THRU READ-PARAM-EXIT.
007800	     UNLOCK PARAM.
007810	     CLOSE PARAM.
	     CLOSE APACFIDS.
	     MOVE "ANYBODY"	 TO WS0-NAME.
	     MOVE "X"		 TO WS-INSTR.
	     PERFORM ZA000-INIT.
	     DISPLAY S-PROG.
	     GO TO BA00.

       BA999.
	     EXIT.

       CA000	       SECTION 51.
       CA00.
	     PERFORM SAVE-SCREEN-3.
007630	     DISPLAY CLR-SCREEN.
	     DISPLAY "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ" AT 0413 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red "ฟ" WITH BACKGROUND-COLOR Red FOREGROUND-COLOR Black.
	     DISPLAY "ณ"						       AT 0513 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " The System parameters, Company details, Departments, "  AT 0514 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0568 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0613 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     Divisions, Hardware configurations, Integration, "  AT 0614 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0668 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0713 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     Rate structures & Stationery choices need to be  "  AT 0714 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0768 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0813 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     set up!                                          "  AT 0814 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0868 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0913 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " These details include:                               "  AT 0914 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 0968 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1013 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     Address, Telephone, VAT registration number,     "  AT 1014 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1068 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1113 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     Sales staff, Technicians, Debtor Categories,     "  AT 1114 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1168 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1213 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     Sales Ledgers, Printers, Cash Drawer/s, Interest "  AT 1214 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1268 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1313 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     rates, Price rounding, Stationery choices, User  "  AT 1314 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1368 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1413 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "     codes, Passwords and Integration account numbers."  AT 1414 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1468 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1513 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " If you are not sure of the above, please read pages  "  AT 1514 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1568 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1613 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " 30 to 36 of the manual and then select the Demonstra-"  AT 1614 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1668 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1713 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " tion system and selecting option 8 from the PROGRAM  "  AT 1714 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1768 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1813 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " CONTROL menu study the various PARAMETER options to  "  AT 1814 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1868 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1913 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " familiarise yourself with the requirements.          "  AT 1914 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 1968 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 2013 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "                                                      "  AT 2014 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 2068 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 2113 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY " DO THE SETUP NOW ?                                   "  AT 2114 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ณ"						       AT 2168 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     DISPLAY "ภ"						       AT 2213 WITH FOREGROUND-COLOR Red HIGHLIGHT BACKGROUND-COLOR Red.
	     DISPLAY "ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู" AT 2214 WITH FOREGROUND-COLOR Black BACKGROUND-COLOR Red.
	     MOVE 5		 TO SHADE-ROW.
	     MOVE 15		 TO SHADE-COL.
	     MOVE 54		 TO SHADE-WIDTH.
	     MOVE 18		 TO SHADE-LINES.
	     PERFORM SCREEN-SHADOW.
	     ACCEPT WS-OPTION AT 2134 WITH FOREGROUND-COLOR Brown HIGHLIGHT BACKGROUND-COLOR Red AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	   IF WS-OPTION = "Y"
	       GO TO CA05.
	     DISPLAY " SWITCH THIS MESSAGE OFF ?                            " AT 2114 WITH FOREGROUND-COLOR Grey HIGHLIGHT BACKGROUND-COLOR Red.
	     ACCEPT WS-OPTION AT 2141 WITH FOREGROUND-COLOR Brown HIGHLIGHT BACKGROUND-COLOR Red AUTO.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	   IF NOT (WS-OPTION = "Y")
	       PERFORM RESTORE-SCREEN-3
	       GO TO CA999.
	     GO TO CA10.

       CA05.
	     MOVE "8"		 TO WS-OPTION.

       CA10.
038300	     MOVE 3		 TO WS-PARKEY.
038310       PERFORM READ-PARAM THRU READ-PARAM-EXIT.
	     MOVE "N"		 TO PAR-NEW-SYS.
010190	     REWRITE PAR-RECORD1.
	     PERFORM RESTORE-SCREEN-3.

       CA999.
	     EXIT.
      /    *************************************************************
      * 		I N I T I A L I S E   P R O G R A M
      *    *************************************************************
038140 ZA000-INIT	       SECTION 90.
038150 ZA000-OPEN.
	     MOVE "APACMENU"	 TO CRT-PROGRAM.
	     MOVE "S"		 TO CRT-TYPE.
	     CALL "MNU\BUP000"
		   USING WS-PARID WS-USER-ID WS0-PROGRAMS W05-COMMAND.
	     CANCEL "MNU\BUP000".
	     MOVE WS-APAC-VERSION
				 TO APAC-VERSION.
	     MOVE WS-APAC-SYSTEM TO APAC-SYSTEM.
	     MOVE TODAY-DDMMYY	 TO W12-TODAY.
	   IF APAC-END
	       DISPLAY CLR-SCREEN
	       STOP RUN.
	     MOVE WS-L-OR-N	 TO W02-L-OR-N.
	     MOVE WS-SYS-ID	 TO W02-SYSID.
	     OPEN I-O APACFIDS.
	   IF APAC-INIT
	       PERFORM ZA100
	       GO TO ZA000-OPEN.
038160	     PERFORM ZA60.
	   IF (WS-DEM = 1 AND WS-DAYS < 66) OR
	      (WS-DEM > 1)
	       CALL "UTP\SYS001" USING WS-PARID WS-USER-ID WS0-PROGRAMS
	       CANCEL "UTP\SYS001".
	     CALL "UTP\USR001"
		 USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY.
	     CANCEL "UTP\USR001".
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ D o   n o t   d i s p l a y   E R R O R   m e s s a g e s ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 2		 TO USER-ACTION.
	     MOVE 44		 TO USER-NUMBER.
	     MOVE 1		 TO USER-SETTING.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	   S e t   u p	 t h e	 F U N C T I O N   k e y s     ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 1		 TO USER-ACTION
				    USER-SETTING.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		       ESC, F1 to F10 keys		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE ZERO		 TO USER-NUMBER.
	     MOVE 11		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		    PAGE-UP and PAGE-DOWN keys		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 53		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ		   A C T I V A T E   M O U S E		       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 64		 TO MOUSE-FUNC.
	     MOVE 1		 TO MOUSE-PARAM.
	     CALL X"AF" USING MOUSE-FUNC
			      MOUSE-PARAM.
	   IF MOUSE-FUNC NOT = 255
	       MOVE "Y"		 TO MOUSE-ATTACHED
	   ELSE
	       GO TO ZA00.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	       Set MOUSE key to act as FUNCTION key	       ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	     MOVE 3		 TO USER-ACTION.
	     MOVE 27		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.

       ZA00.
	     DISPLAY CLR-SCREEN.
	   IF (WS-DEM = 1) AND (WS-DAYS > 85)
	       COMPUTE WS-NUM = 15 - (WS-DAYS - 85)
	       DISPLAY "This package must be registered within " AT 2102 WITH BACKGROUND-COLOR Cyan FOREGROUND-COLOR Red HIGHLIGHT
			WS-NUM WITH BACKGROUND-COLOR Cyan FOREGROUND-COLOR Grey HIGHLIGHT BLINK " days" WITH BACKGROUND-COLOR Cyan FOREGROUND-COLOR Red HIGHLIGHT.
	     GO TO ZA999.
      *    ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
      *    ณ	    Setup the file ID's including path names           ณ
      *    ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
      *    *************************************************************
      *    **** 	  P A R A M E T E R   F I L E		    ****
      *    *************************************************************
       ZA00A.
	     MOVE "PARAM"	 TO AFID-KEY.

       ZA00-READ-APACFIDS.
000030	     READ APACFIDS WITH IGNORE LOCK
	       KEY IS AFID-KEY.
	   IF WS-STATUS = "00"
	       GO TO ZA00-READ-APACFIDS-EXIT.
006260	     STRING "Missing " DELIMITED SIZE
		     AFID-KEY DELIMITED BY " "
		     " file ID - Status " DELIMITED SIZE
		     WS-STATUS DELIMITED SIZE
		     INTO WS-ERR-MES.
	     PERFORM ERROR-LENGTH THRU ERROR-EXIT.
006370	     STOP RUN.

       ZA00-READ-APACFIDS-EXIT.
	     EXIT.

       ZA00A-CONTINUE.
	     MOVE AFID-PATH	 TO W02-PARAM.

       ZA00B.
038200	     OPEN I-O PARAM.
038210     IF RUNTIME-ERROR
038220         IF FLE-LOCKED
038230             GO TO ZA200
038240         ELSE
038250         IF FLE-LIMIT
038260             GO TO ZA49.
038270     IF WS-STATUS NOT = "00"
038280         MOVE 15           TO WS-F-ERROR
038290         PERFORM OPEN-ERROR.
038300       MOVE 3              TO WS-PARKEY.
038310       PERFORM READ-PARAM THRU READ-PARAM-EXIT.
      *    *************************************************************
      *    **** 	    C O N T R O L   F I L E		    ****
      *    *************************************************************
	     MOVE "NETWORK"	 TO AFID-KEY.
	     PERFORM ZA00-READ-APACFIDS THRU ZA00-READ-APACFIDS-EXIT.
	     MOVE AFID-PATH	 TO W02-NETWORK.
      *    *************************************************************
      *    **** 	   D E P A R T M E N T	 F I L E	    ****
      *    *************************************************************
	     MOVE "DEPART"	 TO AFID-KEY.
	     PERFORM ZA00-READ-APACFIDS THRU ZA00-READ-APACFIDS-EXIT.
	     MOVE AFID-PATH	 TO W02-DEPART.
      *    *************************************************************
      *    ****      N E T W O R K   (S H A R E D)   F I L E	    ****
      *    *************************************************************
	     MOVE "SHARED"	 TO AFID-KEY.
	     PERFORM ZA00-READ-APACFIDS THRU ZA00-READ-APACFIDS-EXIT.
	     MOVE AFID-PATH	 TO W02-SHARED.
      *    *************************************************************
      *    ****       V A L U E	  A D D E D   T A X   F I L E	    ****
      *    *************************************************************
	     MOVE "TXTRAN"	 TO AFID-KEY.
	     PERFORM ZA00-READ-APACFIDS THRU ZA00-READ-APACFIDS-EXIT.
	     MOVE AFID-PATH	 TO W02-TXTRAN.
	     MOVE PAR-CRDX	 TO WS-CARDEX.
      *	     MOVE "X"		 TO WS-CRDMTH.
	     MOVE PAR-NEW-SYS	 TO WS-OPTION.
      *    *************************************************************
      *    ****    C O N T R O L   F I L E
      *    *************************************************************
038470	     OPEN I-O NETWORK.
038480     IF RUNTIME-ERROR
038490         IF FLE-LOCKED
038500             GO TO ZA200
038510         ELSE
038520         IF FLE-LIMIT
038530             GO TO ZA49.
038540     IF WS-STATUS NOT = "00"
038550         MOVE 2            TO WS-F-ERROR
038560         PERFORM OPEN-ERROR.
      *    *************************************************************
      *    ****    O P E N   T H E   S H A R E D   F I L E
      *    *************************************************************
038470	     OPEN I-O SHARED.
038480     IF RUNTIME-ERROR
038490         IF FLE-LOCKED
038500             GO TO ZA200
038510         ELSE
038520         IF FLE-LIMIT
038530             GO TO ZA49.
	   IF WS-STATUS = "05"
	       PERFORM ZA05 THRU ZA15.
038540	   IF WS-STATUS NOT = "00"
038550	       MOVE 37		 TO WS-F-ERROR
038560         PERFORM OPEN-ERROR.
	     MOVE 5		 TO WS-SHARED.
	     READ SHARED WITH LOCK.
	   IF NOT (SHR-RUN-DATE = W12-TODAY)
	       MOVE W12-TODAY	 TO SHR-RUN-DATE
	       MOVE ZERO	 TO SHR-UPDATE-SEQ
	       REWRITE SHR-RECORD.
	     UNLOCK SHARED.
      *    *************************************************************
      *    ****    D E P A R T M E N T	 /   S A L E S	 L E D G E R
      * 	   F I L E
      *    *************************************************************
       ZA01.
038810	     OPEN I-O DEPART.
042120	   IF (WS-STAT1 = "9" AND IDX-CORRUPT) OR
	      (WS-STATUS = "39")
	       CLOSE PARAM
	       PERFORM SAVE-SCREEN-3
	       CALL "UTP\DPTREB"
		     USING WS-PARID WS-USER-ID WS0-PROGRAMS
			   WS0-SECURITY
	       CANCEL "UTP\DPTREB"
	       PERFORM RESTORE-SCREEN-3
	       CLOSE DEPART
	       OPEN I-O PARAM NETWORK
	       GO TO ZA01.
038820	   IF RUNTIME-ERROR
038830         IF FLE-LOCKED
038840             GO TO ZA200
038850         ELSE
038860         IF FLE-LIMIT
038870             GO TO ZA49.
038910     IF WS-STATUS NOT = "00"
038920	       MOVE 7		 TO WS-F-ERROR
038930         PERFORM OPEN-ERROR.

       ZA02.
038670	     OPEN I-O TXTRAN.
042120	   IF (WS-STAT1 = "9" AND IDX-CORRUPT) OR
	      (WS-STATUS = "39")
	       CLOSE PARAM
	       PERFORM SAVE-SCREEN-3
	       CALL "UTP\TAXREB"
		     USING WS-PARID WS-USER-ID WS0-PROGRAMS
			   WS0-SECURITY
	       CANCEL "UTP\TAXREB"
	       PERFORM RESTORE-SCREEN-3
	       OPEN I-O PARAM NETWORK
	       GO TO ZA02.
038680	   IF RUNTIME-ERROR
038690         IF FLE-LOCKED
038700             GO TO ZA200
038710         ELSE
038720         IF FLE-LIMIT
038730		   GO TO ZA49
038740         ELSE
038750	       IF IDX-CORRUPT
038760		   MOVE 32	 TO WS-F-ERROR
038770             GO TO ZA50.
038780     IF WS-STATUS NOT = "00"
038790	       MOVE 32		 TO WS-F-ERROR
	       IF WS-STATUS = "39"
038770		   GO TO ZA50
	       ELSE
038800		   PERFORM OPEN-ERROR.
038300	     MOVE 251		 TO WS-PARKEY.
038310	     PERFORM READ-PARAM THRU READ-PARAM-EXIT.
      *    *************************************************************
      *    ****    C H E C K   I F   C O N V E R S I O N S
      * 	   R E Q U I R E D
      *    *************************************************************
	     MOVE 1		 TO WS-NETKEY.
	     READ NETWORK.
	   IF DEB-VER < "8.09"
	       PERFORM SAVE-SCREEN-3
	       CALL "CNV\DEBCON" USING WS-PARID WS-USER-ID
	       CANCEL "CNV\DEBCON"
	       PERFORM RESTORE-SCREEN-3.
	   IF DEB-VER < "8.11"
	       PERFORM SAVE-SCREEN-3
	       CALL "UTP\JOBREB"
		  USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY
	       CALL "CNV\DEBJOB" USING WS-PARID WS-USER-ID
	       CANCEL "CNV\DEBJOB"
	       PERFORM RESTORE-SCREEN-3.
	   IF DEB-VER < "8.12"
	       PERFORM SAVE-SCREEN-3
	       CALL "CNV\DEBAGE" USING WS-PARID WS-USER-ID
	       CANCEL "CNV\DEBAGE"
	       PERFORM RESTORE-SCREEN-3.
	   IF DEB-VER < "8.13"
	       PERFORM SAVE-SCREEN-3
	       CALL "CNV\DEBREST" USING WS-PARID WS-USER-ID
	       CANCEL "CNV\DEBREST"
	       PERFORM RESTORE-SCREEN-3.
	     MOVE 2		 TO WS-NETKEY.
	     READ NETWORK.
	   IF P-VER < "8.12"
	       PERFORM SAVE-SCREEN-3
	       CALL "CNV\PURCON" USING WS-PARID WS-USER-ID
	       CANCEL "CNV\PURCON"
	       PERFORM RESTORE-SCREEN-3.
	     MOVE 3		 TO WS-NETKEY.
	     READ NETWORK.
	   IF STK-VER < "8.09"
	       PERFORM SAVE-SCREEN-3
	       CALL "CNV\SRDCON" USING WS-PARID WS-USER-ID
	       CANCEL "CNV\SRDCON"
	       CALL "UTP\CARREB"
		  USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY
	       PERFORM RESTORE-SCREEN-3.
	   IF STK-VER < "8.14"
	       PERFORM SAVE-SCREEN-3
	       CALL "CNV\CARCON" USING WS-PARID WS-USER-ID
	       CANCEL "CNV\CARCON"
	       CALL "UTP\CARREB"
		  USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY
	       PERFORM RESTORE-SCREEN-3.
039770	     GO TO ZA999.

       ZA05.
	     MOVE 1		 TO WS-SHARED
				    WS-NETKEY.
       ZA10.
000030	     READ NETWORK IGNORE LOCK.
	     MOVE NET-RECORD	 TO SHR-RECORD.
	   IF WS-NETKEY = 5
	       MOVE "N"		 TO SHR-DEBT
				    SHR-CRED
				    SHR-STOCK
				    SHR-GLED
				    SHR-LAY.
	     WRITE SHR-RECORD.
	  IF WS-NETKEY < 5
	      ADD 1		 TO WS-SHARED
				    WS-NETKEY
	      GO TO ZA10.

       ZA15.
	     EXIT.

       COPY ZA49.PRO.

039850 ZA50.
039860	   IF WS-F-ERROR = 32
039870	       MOVE "TAX file"	 TO WS-FILE.
039980	     DISPLAY "Rebuild " AT 0812
039990		      WS-FILE WITH FOREGROUND-COLOR Brown HIGHLIGHT.
040000	     DISPLAY "Press any key to continue" AT 1012.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.

040020 ZA51.
040030       EXIT PROGRAM.
      *    *************************************************************
      *    ****    S E T U P   T H E   S C R E E N   G R A P H I C S
      *    *************************************************************
040090 ZA60.
040650	     MOVE WS-COMPANY	 TO WS-TOP-COMP.
	   IF WS-USER = WS-SYS-ID
	       MOVE "Supervisorฤ"  TO WS-WRKHD
	   ELSE
	       MOVE "Workstation"  TO WS-WRKHD
	       MOVE WS-USER	   TO WS-WRKST.
      *    *************************************************************
      *    ****    I N I T I A L I Z E	 F I L E S
      *    *************************************************************
       ZA100.
	     MOVE WS-NEXT-PRG	 TO PRG-NAME.
	     MOVE SPACES	 TO WS-NEXT-PRG.
	     CALL PRG-NAME
		  USING WS-PARID WS-USER-ID WS0-PROGRAMS WS0-SECURITY
		  ON EXCEPTION
		  STOP RUN.
	     CANCEL PRG-NAME.
	   IF WS-NEXT-PRG NOT = SPACES
	       GO TO ZA100.

040660 ZA200.

       COPY LOCKED.PRO.

040730 ZA205.
040740       EXIT PROGRAM.

040750 ZA999.
040760       EXIT.

040780 I-O-ERRORS      SECTION  91.

       COPY ERRORS.PRO.
040930
040950 DISPLAY-FILE-NAME.
040960	   IF WS-F-ERROR = 2
040970	       MOVE W02-NETWORK  TO WS-FILE
040980	       MOVE WS-NETKEY	 TO WS-KEY
041110	   ELSE
040960	   IF WS-F-ERROR = 7
041820	       MOVE W02-DEPART	 TO WS-FILE
041870         MOVE ZERO         TO WS-KEY
041830	       MOVE DPT-CODE	 TO WS-KEYX
041110	   ELSE
041120     IF WS-F-ERROR = 15
041130	       MOVE W02-PARAM	 TO WS-FILE
041140         MOVE WS-PARKEY    TO WS-KEY
041840	   ELSE
041850     IF WS-F-ERROR = 32
041860         MOVE W02-TXTRAN   TO WS-FILE
041870         MOVE ZERO         TO WS-KEY
	       MOVE TAX-KEY	 TO WS-KEYX
041110	   ELSE
041120	   IF WS-F-ERROR = 37
041130	       MOVE W02-SHARED	 TO WS-FILE
041140	       MOVE WS-SHARED	 TO WS-KEY.

       COPY DISPERR.PRO.
