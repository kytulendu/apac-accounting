      $SET LINKCOUNT"256"
      ******************************************************************
      *                                                                *
      *       ******	*******	    ******     ******	 **	       *
      *      **	   **	**    **   **	 **   **    **	 **	       *
      *      **		**    **   **	 **   **    **	 **	       *
      *       ******	*******	   **	 **   **    **	 **	       *
      * 	   **	**	   **	 **   **    **	 **	       *
      *      **	   **	**	   **	 **   **    **	 **	       *
      *       ******	**	    ******     ******	 ********      *
      *                                                                *
      *     ENGLISH                                                    *
      *                                                                *
      *     P R I N T	S P O O L   F I L E   U T I L I T Y   P R O G  *
      *                                                                *
      *     VERSION 8.15.00 - January 2011			       *
      * 							       *
      ******************************************************************
000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.     SPOOLPRN.
000030 AUTHOR.         J W LEMMON (APAC).
000040 DATE-WRITTEN.   January 1997.

	   This program is used to print the spool file.

	   The program performs the following functions:

	       Select the spool file to be printed.
	       Print the selected file.
	       View the selected file on the screen.

		   COPYRIGHT NOTICE: COPYRIGHT (C) 1997 - 2011
				     by James William Lemmon.
				       (Id No. 4412165050082).

		   All rights reserved.

		   e-mail jwlemmon@gmail.com.

000050 SECURITY.
		   This program is free software; you can redistribute
		   it and/or modify it under the terms of the GNU General
		   Public License as published by the Free Software
		   Foundation; either version 2 of the License, or (at
		   your option) any later version.

		   This program is distributed in the hope that it will
		   be useful, but WITHOUT ANY WARRANTY; without even the
		   implied warranty of MERCHANTABILITY or FITNESS FOR A
		   PARTICULAR PURPOSE.	See the GNU General Public License
		   for more details.

		   You should have received a copy of the GNU General
		   Public License along with this program; if not, write
		   to the Free Software Foundation, Inc., 59 Temple Place
		   - Suite 330, Boston, MA 02111-1307, USA.

000050 ENVIRONMENT DIVISION.
000060 CONFIGURATION SECTION.
000070 SPECIAL-NAMES.
000080                 CURSOR IS CSTART
000090		       CONSOLE IS CRT
		       CRT STATUS IS KEY-STATUS.

000100 INPUT-OUTPUT SECTION.
000100 FILE-CONTROL.

       COPY APACFIDS.SL.

000120 COPY PARAM.SL.

000200	   SELECT PRNREP  ASSIGN W02-PRINTER
                          ORGANIZATION LINE SEQUENTIAL.

000200	   SELECT PRNSPL  ASSIGN W02-SPOOLER
                          ORGANIZATION LINE SEQUENTIAL.

      * I-O-CONTROL.
      *	   SAME RECORD AREA FOR PRNREP PRNSPL.

000220 DATA DIVISION.
000230 FILE SECTION.

       COPY APACFIDS.FDE.

000250 COPY PARAM.FDE.

      /
000330 FD  PRNREP    LABEL RECORD OMITTED
		     LINAGE WS-PGE-LENGTH.
       01  R-SL1.
	   03  R-SLA	       PIC  X(78).
	   03  FILLER	       PIC  X(58).
       01  R-SL2.
	   03  FILLER	       PIC  X(58).
	   03  R-SLB	       PIC  X(78).
000350 01  REP-LINE1.
000360	   03  REP-DETAIL1     PIC  X(136).

000330 FD  PRNSPL.
       01  SPL-L1.
	   03  SPL-CONT.
	       05  SPL-ADV     PIC  9(02).
	       05  SPL-LIN     PIC  9(02).
000360	   03  SPL-DETAIL1     PIC  X(136).

      /
001690 WORKING-STORAGE SECTION.
       77  WS-CHECK	   PIC	X(18)	 VALUE
			   "aeWlimemnomLalismJ".
003260 77  WS-S1	   PIC	9(04)	 COMP-5.
003270 77  WS-S2	   PIC	9(04)	 COMP-5.
003280 77  WS-S3	   PIC	9(04)	 COMP-5.
003290 77  WS-S4	   PIC	9(04)	 COMP-5.
003300 77  WS-S5	   PIC	9(04)	 COMP-5.
003310 77  WS-S6	   PIC	9(04)	 COMP-5.
003320 77  WS-S7	   PIC	9(04)	 COMP-5.
003330 77  WS-S8	   PIC	9(04)	 COMP-5.
003330 77  WS-LEFT	   PIC	9(04)	 COMP-5.
003330 77  WS-RIGHT	   PIC	9(04)	 COMP-5.
001670 77  WS-SPL-REC	   PIC	9(06)	 COMP-5.
001660 77  WS-PARKEY       PIC  9(06)    COMP-5.
001820 77  WS-OPTION	   PIC	X(01).
       77  WS-ERROR	   PIC	9(01)	 VALUE ZERO.
       77  WS-LINES	   PIC	9(02)	 VALUE ZERO.
002570 77  WS-PGE-LENGTH   PIC	9(02)	 VALUE 66.
001870 77  WS-PRN-LENGTH   PIC	9(02)	 VALUE 62.
003650 77  WS-COND	   PIC	X(06)	 VALUE X"000000000000".
003660 77  WS-NORM	   PIC	X(06)	 VALUE X"000000000000".
003070 77  WS-EXPP	   PIC	X(06)	 VALUE X"000000000000".
003080 77  WS-ECAN	   PIC	X(06)	 VALUE X"000000000000".
003090 77  WS-8LPI	   PIC	X(06)	 VALUE X"000000000000".
003100 77  WS-6LPI	   PIC	X(06)	 VALUE X"000000000000".
       77  WS-10CPI	   PIC	X(06)	 VALUE X"000000000000".
       77  WS-12CPI	   PIC	X(06)	 VALUE X"000000000000".
       77  WS-17CPI	   PIC	X(06)	 VALUE X"000000000000".
003150 77  WS-PRN-NO	   PIC	X(01)	 COMP-X VALUE 9.
003160 77  WS-PRN-STAT	   PIC	X(01)	 COMP-X.
       77  TODAY-DDMMYY	   PIC	9(08) COMP-5.
       77  WS-USUB	   PIC	9(04) COMP-5.

003050 01  WS-DB-LINE.
003080	   03  WS-TOP-LNE2.
001390	       05  WS-TCR   PIC  X(80) VALUE "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -        "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿".
003100	   03  WS-TP-LINE2 REDEFINES WS-TOP-LNE2.
003110         05  FILLER      PIC  X(01).
003120         05  WS-TOP-COMP PIC  X(40).
001430	       05  FILLER      PIC  X(23).
	       05  WS-WRKHD    PIC  X(11).
001430	       05  FILLER      PIC  X(01).
	       05  WS-WRKST    PIC  X(03).
001430	       05  FILLER      PIC  X(01).
003160	   03  WS-MID-LNE2.
	       05  FILLER      PIC  X(01) VALUE "³".
	       05  WS-BLNK78   PIC  X(78) VALUE ALL "°".
	       05  FILLER      PIC  X(01) VALUE "³".
003200	   03  WS-BOT-LNE2.
001510	       05  WS-BCR   PIC  X(80) VALUE "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -        "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ".
003240	   03  WS-B-LINE REDEFINES WS-BOT-LNE2.
003250	       05  FILLER      PIC X(01).
               05  WS-MEM-LINE.
003260            07  WS-SRT-LINE
003270			       PIC X(50).
		  07  FILLER   PIC X(10).
003280	       05  FILLER      PIC X(19).

       COPY WS.WS.

000290 01  WS-PARID.
000020	   03  WS-SYS-ID       PIC  X(03).

       01  W02-FILE-IDS.

       COPY APACFIDS.ID.

       COPY PARAM.ID.

	   03  W02-PRINTER.
	       05  FILLER      PIC  X(06).

	   03  W02-SPOOLER.
	       05  W02-WS      PIC  X(02).
	       05  W02-US      PIC  X(01).
	       05  W02-TERM    PIC  X(03).
	       05  W02-US2     PIC  X(01).
	       05  W02-REP     PIC  X(01).
	       05  W02-P       PIC  X(01).
	       05  W02-USER    PIC  X(03).

	   03  W02-SPL-DET.
	       05  W02-SPL-SIZE    PIC	X(08) COMP-X.
	       05  W02-SPL-DATE.
		   07  W02-SPL-DAY PIC	X(01) COMP-X.
		   07  W02-SPL-MTH PIC	X(01) COMP-X.
		   07  W02-SPL-YR  PIC	X(02) COMP-X.
	       05  W02-SPL-TIME.
		   07  W02-SPL-HR  PIC	X(01) COMP-X.
		   07  W02-SPL-MIN PIC	X(01) COMP-X.
		   07  W02-SPL-SEC PIC	X(01) COMP-X.
		   07  W02-SPL-DEC PIC	X(01) COMP-X.

       01  W05-SCREEN.
	   03  W05-PRINT-DETAIL.
	     05  W05-LINE OCCURS 20.
	       07  W05-DETAIL  PIC  X(136).
	   03  W05-PRINT-DETAIL2 REDEFINES W05-PRINT-DETAIL.
	     05  W05-LINE2 OCCURS 20.
	       07  W05-SLA     PIC  X(78).
	       07  FILLER      PIC  X(58).
	   03  W05-PRINT-DETAIL2 REDEFINES W05-PRINT-DETAIL.
	     05  W05-LINE3 OCCURS 20.
	       07  FILLER      PIC  X(58).
	       07  W05-SLB     PIC  X(78).
	   03  W05-PRINT-DETAIL3 REDEFINES W05-PRINT-DETAIL.
	     05  W05-LINE4 OCCURS 20.
	       07  W05-CHAR    PIC  X(01) OCCURS 136.

       01  W06-SCREEN.
	   03  W06-PRINT-DETAIL.
	     05  W06-LINE OCCURS 20.
	       07  W06-CHAR    PIC  X(01) OCCURS 78.


001270 01  W08-EXPD.
	   03  W08-CHAR        PIC  X(06).
001280	   03  W08-DEC REDEFINES W08-CHAR
			       PIC  X(01) COMP-X OCCURS 6.

003930 01  W25-CALCS.
002860	   03  W25-RESULT      PIC 9(05)V99.
002870     03  W25-RESULT1 REDEFINES W25-RESULT.
002880         05  W25-WHOLE   PIC 9(05).
002890         05  W25-DECIMAL PIC 9(02).
           03  W25-RESULT2 REDEFINES W25-RESULT.
	       05  W25-KEY     PIC 9(04).
	       05  W25-SUB     PIC 9(01).
	       05  FILLER      PIC 9(02).

       COPY W40.WS.

       COPY FUNCTION.WS.

       LINKAGE SECTION.

       COPY CHAIN.LS.

      /
004580 SCREEN SECTION.

       COPY BLANK.CRT.

000850 01  S-PROG.
000860	   03  LINE  2 COLUMN 30 FOREGROUND-COLOR 7
				 HIGHLIGHT
				 VALUE "PRINT SPOOLER UTILITY".

       01  S-SELECT.
	   03  LINE  4 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "¿".
	   03  LINE  5 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³     ".
	   03	       COLUMN 31 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "SELECT SPOOL FILE".
	   03	       COLUMN 48 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "     ³".
	   03  LINE  6 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³".
	   03	       COLUMN 26 FOREGROUND-COLOR 7 BACKGROUND-COLOR 4
				 VALUE "ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE  7 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "1".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Picking Slips         ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE  8 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "2".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Invoices/Credit Notes ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE  9 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "3".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Stock Reports         ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 10 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "4".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Creditor Reports      ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 11 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "5".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Debtor Reports        ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 12 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "6".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = General Ledger Reports".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 13 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "7".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Statements            ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 14 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "8".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Labels	         ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 15 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "9".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = Quotations/Jobs       ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 16 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "³ ".
	   03	       COLUMN 27 FOREGROUND-COLOR 7 HIGHLIGHT
				 BACKGROUND-COLOR 4 VALUE "0".
	   03	       COLUMN 28 FOREGROUND-COLOR 7
				 BACKGROUND-COLOR 4
				 VALUE " = E X I T   	         ".
	   03	       COLUMN 53 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "³".
	   03  LINE 17 COLUMN 25 FOREGROUND-COLOR 4 HIGHLIGHT
				 BACKGROUND-COLOR 4
				 VALUE "À".
	   03	       COLUMN 26 FOREGROUND-COLOR 0 BACKGROUND-COLOR 4
				 VALUE "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ".

       01  MENU-INSTRUCT.
	   03  LINE 25 COLUMN  2 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE "Use ".
	   03	       COLUMN  6 HIGHLIGHT
				 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 6
				 VALUE "".
	   03	       COLUMN  7 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE " or ".
	   03	       COLUMN 11 HIGHLIGHT
				 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 6
				 VALUE "".
	   03	       COLUMN 12 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE " to point to an item, and ".
	   03	       COLUMN 38 HIGHLIGHT
				 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 6
				 VALUE "<Enter>".
	   03	       COLUMN 45 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE " to Select ".
	   03	       COLUMN 56 HIGHLIGHT
				 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 6
				 VALUE "<Esc>".
	   03	       COLUMN 61 BACKGROUND-COLOR 3
				 FOREGROUND-COLOR 1
				 VALUE " to Exit".

       01  SD-LEFT.
	   03  LINE  3 COLUMN  1 FOREGROUND-COLOR 3 BACKGROUND-COLOR 0
				 VALUE "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -        "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´".
	   03  LINE  4 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (1).
	   03  LINE  5 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (2).
	   03  LINE  6 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (3).
	   03  LINE  7 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (4).
	   03  LINE  8 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (5).
	   03  LINE  9 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (6).
	   03  LINE 10 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (7).
	   03  LINE 11 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (8).
	   03  LINE 12 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (9).
	   03  LINE 13 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (10).
	   03  LINE 14 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (11).
	   03  LINE 15 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (12).
	   03  LINE 16 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (13).
	   03  LINE 17 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (14).
	   03  LINE 18 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (15).
	   03  LINE 19 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (16).
	   03  LINE 20 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (17).
	   03  LINE 21 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (18).
	   03  LINE 22 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (19).
	   03  LINE 23 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLA (20).

       01  SD-RIGHT.
	   03  LINE  3 COLUMN  1 FOREGROUND-COLOR 3 BACKGROUND-COLOR 0
				 VALUE "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -        "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´".
	   03  LINE  4 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (1).
	   03  LINE  5 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (2).
	   03  LINE  6 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (3).
	   03  LINE  7 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (4).
	   03  LINE  8 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (5).
	   03  LINE  9 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (6).
	   03  LINE 10 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (7).
	   03  LINE 11 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (8).
	   03  LINE 12 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (9).
	   03  LINE 13 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (10).
	   03  LINE 14 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (11).
	   03  LINE 15 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (12).
	   03  LINE 16 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (13).
	   03  LINE 17 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (14).
	   03  LINE 18 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (15).
	   03  LINE 19 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (16).
	   03  LINE 20 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (17).
	   03  LINE 21 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (18).
	   03  LINE 22 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (19).
	   03  LINE 23 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W05-SLB (20).

       01  SD-RANDOM.
	   03  LINE  3 COLUMN  1 FOREGROUND-COLOR 3 BACKGROUND-COLOR 0
				 VALUE "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      -        "ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´".
	   03  LINE  4 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (1).
	   03  LINE  5 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (2).
	   03  LINE  6 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (3).
	   03  LINE  7 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (4).
	   03  LINE  8 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (5).
	   03  LINE  9 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (6).
	   03  LINE 10 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (7).
	   03  LINE 11 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (8).
	   03  LINE 12 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (9).
	   03  LINE 13 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (10).
	   03  LINE 14 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (11).
	   03  LINE 15 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (12).
	   03  LINE 16 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (13).
	   03  LINE 17 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (14).
	   03  LINE 18 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (15).
	   03  LINE 19 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (16).
	   03  LINE 20 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (17).
	   03  LINE 21 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (18).
	   03  LINE 22 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (19).
	   03  LINE 23 COLUMN  2 FOREGROUND-COLOR 0 BACKGROUND-COLOR 7
				 PIC  X(78) FROM W06-LINE (20).

	   01  S-COUNT.
	       03  LINE 12 COLUMN 12 VALUE "Spool Record:".
	       03	   COLUMN 26 FOREGROUND-COLOR 3 HIGHLIGHT
				     BACKGROUND-COLOR 5
				     PIC ZZZZZ9 FROM WS-SPL-REC.

004870 COPY S99.CRT.

       COPY ERROR.CRT.

       COPY OPT.CRT.

      /
001230 PROCEDURE DIVISION
		 USING LS-PARID LS-USER-ID LS0-PROGRAMS LS0-SECURITY.
010250 AA000-MAIN      SECTION.
010260 AA000-INIT.
008560	     PERFORM ZA000.
	     PERFORM BA000.

       AA999.
	     EXIT PROGRAM.

       COPY FUNCTION.CRT.

       COPY OPTION.CRT.

011390 COPY LOCKED.RC2.

011410 COPY CLEAR.CRT.

      /
      *    ****    READ FILES ROUTINES
      *
011650 AC000	       SECTION.

011750 COPY PARAM.RD.



       BA000	       SECTION.
       BA00.
	   IF MOUSE-ATTACHED = "Y"
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 1		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM.
006630       DISPLAY CLR-SCREEN.
	     DISPLAY S-PROG.
	     MOVE 5		 TO SHADE-ROW.
	     MOVE 27		 TO SHADE-COL.
	     MOVE 27		 TO SHADE-WIDTH.
	     MOVE 13		 TO SHADE-LINES.
	     DISPLAY S-SELECT.
	     DISPLAY MENU-INSTRUCT.
	     PERFORM SCREEN-SHADOW.

       BA02.
	     MOVE 6		 TO TOP-ROW.
	     MOVE 15		 TO BOTTOM-ROW.
	     MOVE 6		 TO SCREEN-LIN.
	     MOVE 27		 TO SCREEN-COL.
	     MOVE 25		 TO STRING-LENGTH.
	     PERFORM SAVE-ATTR.

       BA05.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.

006660 BA10.
	   IF ADIS-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN UP-KEY	 PERFORM MOVE-BLOCK-UP
		 WHEN DOWN-KEY	 PERFORM MOVE-BLOCK-DOWN
		 WHEN MOUSE-KEY  PERFORM POSITION-MOUSE
				 IF MOUSE-ENTER = "Y"
				     MOVE "N"	 TO MOUSE-ENTER
				     GO TO BA15
				 END-IF
				 IF MOUSE-Y = 24
				     IF MOUSE-X = 5
					 MOVE 5  TO KEY-CODE-1
					 GO TO BA10
				     ELSE
				     IF MOUSE-X = 10
					 MOVE 6  TO KEY-CODE-1
					 GO TO BA10
				     ELSE
				     IF MOUSE-X > 36 AND < 44
					 MOVE 0  TO KEY-CODE-1
					 GO TO BA10
				     ELSE
				     IF MOUSE-X > 54 AND < 60
					 MOVE 0  TO KEY-CODE-1
					 MOVE 1  TO KEY-TYPE
					 GO TO BA10
				     END-IF
				 END-IF
		 WHEN ENTER-KEY  GO TO BA15
		 WHEN OTHER	 CALL X"E5"
	       END-EVALUATE
	       GO TO BA05
	   ELSE
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		     MOVE "0"	 TO WS-OPTION
		     GO TO BA18
		 WHEN OTHER	 CALL X"E5"
	       END-EVALUATE
	       GO TO BA05
	   ELSE
	   IF DATA-8BIT
	       MOVE KEY-CODE-1X  TO WS-OPTION
	       CALL "CBL_TOUPPER" USING WS-OPTION
				  BY VALUE WS-LENGTH
				  RETURNING WS-STATUS
	       IF WS-OPTION < "0" OR > "9"
		   CALL X"E5"
		   GO TO BA05
	       END-IF
	       GO TO BA16
	   ELSE
	       CALL X"E5"
	       GO TO BA05.

       BA15.
	   IF SCREEN-LIN < 6
	       CALL X"E5"
	       GO TO BA05
	   ELSE
	   IF SCREEN-LIN = 6
	       MOVE "1"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 7
	       MOVE "2"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 8
	       MOVE "3"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 9
	       MOVE "4"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 10
	       MOVE "5"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 11
	       MOVE "6"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 12
	       MOVE "7"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 13
	       MOVE "8"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 14
	       MOVE "9"		 TO WS-OPTION
	   ELSE
	   IF SCREEN-LIN = 15
	       MOVE "0"		 TO WS-OPTION.
	   GO TO BA18.

       BA16.
	     PERFORM CLEAR-BLOCK.
	   IF WS-OPTION = "0"
	       MOVE 15		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "1"
	       MOVE 6		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "2"
	       MOVE 7		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "3"
	       MOVE 8		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "4"
	       MOVE 9		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "5"
	       MOVE 10		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "6"
	       MOVE 11		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "7"
	       MOVE 12		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "8"
	       MOVE 13		 TO SCREEN-LIN
	   ELSE
	   IF WS-OPTION = "9"
	       MOVE 14		 TO SCREEN-LIN.
	     PERFORM SAVE-ATTR.
	     PERFORM MARK-BLOCK.

       BA18.
006630       DISPLAY CLR-SCREEN.
	   IF MOUSE-ATTACHED = "Y"
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 0		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM.
006730	   IF WS-OPTION = "0"
006740	       GO TO BA999.
006750     IF WS-OPTION = "1"
006760	       PERFORM CA000
006770     ELSE
006780     IF WS-OPTION = "2"
006790	       PERFORM DA000
006800     ELSE
006810	   IF WS-OPTION = "3" OR "4" OR "5" OR "6"
	       MOVE WS-OPTION	 TO WS-REPORT
006820	       PERFORM EA000
006830     ELSE
006840	   IF WS-OPTION = "7"
006850	       PERFORM FA000
006860     ELSE
006870	   IF WS-OPTION = "8"
006880	       PERFORM GA000
006890     ELSE
006900	   IF WS-OPTION = "9"
006910	       PERFORM HA000.
      *
      *    ****   C H E C K   I F   S P O O L	F I L E   O N
      * 	  D I S K
      *
	     CALL "CBL_CHECK_FILE_EXIST" USING W02-SPOOLER
					       W02-SPL-DET
				     RETURNING WS-STATUS.
	   IF NOT (WS-STATUS = X"0000")
	       MOVE "Spool file requested NOT on disk"
				 TO WS-ERR-STRING
003260	       PERFORM ERROR-MESSAGE
	       GO TO BA00.
	     MOVE "P"		 TO WS-OPTION.

       BA20.
	     MOVE SPACES	 TO WS-ERR-MES.
	     STRING "'P'rinter or 'S'creen  ["
		      DELIMITED SIZE
		      WS-OPTION DELIMITED SIZE
		      "]" DELIMITED SIZE
				 INTO WS-ERR-MES.
	     PERFORM OPT-MESSAGE.
	   IF NOT (WS-OPTION = "P" OR "S")
	       GO TO BA20.
	   IF WS-OPTION = "S"
	       GO TO BA25.
	     PERFORM OPEN-PRINT-FILE.
	   IF WS-ERROR = 1
	       GO TO BA00.
	     PERFORM LINE-PRINT-SPOOL.
	     PERFORM CLOSE-PRINT-FILE.
	     MOVE " "		 TO WS-OPTION.
007060	     GO TO BA30.

       BA25.
	     OPEN INPUT PRNSPL.
	     CALL X"91" USING X91-RES X91-FUN PRNSPL.
	     PERFORM SCREEN-PRINT.
	     CLOSE PRNSPL.
	     MOVE " "		 TO WS-OPTION.

       BA30.
	     MOVE "Delete Spool File Y/N  [ ]"
				 TO WS-ERR-MES.
	     PERFORM OPT-MESSAGE.
020250	   IF NOT (WS-OPTION = "N" OR "Y")
	       GO TO BA30.
           IF WS-OPTION = "N"
	       GO TO BA00.
	     CALL "CBL_DELETE_FILE" USING W02-SPOOLER
				RETURNING WS-STATUS.
007060	     GO TO BA00.

       BA999.
	     EXIT.
      *
      *    ****   O P E N   P R I N T E R   /	S P O O L   F I L E
      *
       OPEN-PRINT-FILE	SECTION 50.
       OPEN-PRINTER.
	     DIVIDE W25-RESULT BY 2
                                 GIVING WS-PARKEY
                                 REMAINDER WS-S6.
             ADD 1               TO WS-S6.
             PERFORM READ-PARAM THRU READ-PARAM-EXIT.
	     MOVE TRM-LENGTH (WS-S6)
				 TO WS-PRN-LENGTH.
	     MOVE TRM-PAGE (WS-S6)
				 TO WS-PGE-LENGTH.
	   IF WS-PRN-NO < 3
	       PERFORM CHECK-PRINTER THRU CHECK-PRINTER-EXIT
	       IF WS-ERROR = 1
		   GO TO OPEN-PRINTER-EXIT
	       END-IF
	   ELSE
	       MOVE "Waiting for printer response"
				 TO WS-ERR-MES
	       PERFORM OPT-CURSOR THRU OPT-REPLY.
019890	     OPEN OUTPUT PRNREP.
	     MOVE ZERO		 TO WS-SPL-REC.
	     PERFORM RESTORE-SCREEN.
	     CALL X"91" USING X91-RES X91-FUN PRNREP.
	     OPEN INPUT PRNSPL.
	     CALL X"91" USING X91-RES X91-FUN PRNSPL.
	     GO TO OPEN-PRINTER-EXIT.

       CHECK-PRINTER.
	     MOVE ZERO		 TO WS-ERROR
				    WS-S1 WS-S2 WS-S3 WS-S4
				    WS-S5 WS-S6 WS-S7 WS-S8.
	     CALL "PC_TEST_PRINTER" USING WS-PRN-NO
					  WS-PRN-STAT
				    RETURNING WS-STATUS.
	   IF WS-PRN-STAT > 127
	       MOVE 1		 TO WS-S1
	       SUBTRACT 128	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 63
	       MOVE 1		 TO WS-S2
	       SUBTRACT 64	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 31
	       MOVE 1		 TO WS-S3
	       SUBTRACT 32	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 15
	       MOVE 1		 TO WS-S4
	       SUBTRACT 16	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 7
	       MOVE 1		 TO WS-S5
	       SUBTRACT 8	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 3
	       MOVE 1		 TO WS-S6
	       SUBTRACT 4	 FROM WS-PRN-STAT.
	   IF WS-PRN-STAT > 1
	       MOVE 1		 TO WS-S7
	       SUBTRACT 2	 FROM WS-PRN-STAT.
	     MOVE WS-PRN-STAT	 TO WS-S8.
	   IF WS-S3 = 0 AND
	      WS-S5 = 0 AND
	      WS-S8 = 0
	       GO TO CHECK-PRINTER-EXIT.

       PRINTER-NOT-READY.
	     MOVE "Check printer! - 'R'etry or 'A'bort  [ ] "
				 TO WS-ERR-MES.
	     PERFORM OPT-MESSAGE.
	   IF NOT (WS-OPTION = "R" OR "A")
	       GO TO PRINTER-NOT-READY.
	     IF WS-OPTION = "A"
		 MOVE 1 	 TO WS-ERROR
		 GO TO CHECK-PRINTER-EXIT.
	       GO TO CHECK-PRINTER.

       CHECK-PRINTER-EXIT.
	     EXIT.

       OPEN-PRINTER-EXIT.
	     EXIT.

       CLOSE-PRINT-FILE  SECTION 51.
       CLOSE-PRINTER.
	   IF WS-PRINTER = "S"
	       GO TO CLOSE-PRINTER-STATUS.
	     MOVE WS-10CPI	 TO REP-DETAIL1.
	     WRITE REP-LINE1 BEFORE 0 LINES.
	     MOVE WS-6LPI	 TO REP-DETAIL1.
	     WRITE REP-LINE1 BEFORE 0 LINES.
	     CLOSE PRNREP.
	     CLOSE PRNSPL.

       CLOSE-PRINTER-STATUS.

       CLOSE-PRINTER-EXIT.
	     EXIT.

       LINE-PRINT-SPOOL	 SECTION 52.
       PRINT-A-LINE.
	     READ PRNSPL AT END
		  GO TO LINE-PRINT-EXIT.
	   IF (SPL-CONT NOT = "PAGE") AND (SPL-LIN > ZERO)
	       CLOSE PRNREP
	       MOVE SPL-LIN	 TO WS-PGE-LENGTH
	       OPEN OUTPUT PRNREP
	       CALL X"91" USING X91-RES X91-FUN PRNREP
	       GO TO PRINT-A-LINE.
	     ADD 1		 TO WS-SPL-REC.
	     DISPLAY S-COUNT.
	     MOVE SPL-DETAIL1	 TO REP-DETAIL1.
	   IF SPL-CONT = "PAGE"
	       WRITE REP-LINE1 BEFORE PAGE
	   ELSE
	       WRITE REP-LINE1 BEFORE SPL-ADV.
	     GO TO PRINT-A-LINE.

       LINE-PRINT-EXIT.
	     EXIT.


       SCREEN-PRINT    SECTION 54.
       SCREEN-PRINT-INIT.
	     MOVE 1		 TO WS-S8.

       SCREEN-INIT-LOOP.
	     MOVE SPACES	 TO W05-DETAIL (WS-S8).
	   IF WS-S8 < 20
	       ADD 1		 TO WS-S8
	       GO TO SCREEN-INIT-LOOP.
	     MOVE ZERO		 TO WS-SCREEN-LIN.
	     MOVE 1		 TO WS-SCREEN
				    WS-LEFT.
	     MOVE 78		 TO WS-RIGHT.

       SCREEN-READ-SPOOL.
	     READ PRNSPL AT END
		  PERFORM SCREEN-CONTROL THRU SCREEN-CONTROL-EXIT
		  GO TO SCREEN-PRINT-EXIT.
	   IF ((SPL-CONT NOT = "PAGE") AND (SPL-LIN > ZERO)) OR
	      (SPL-ADV = ZERO)
	       GO TO SCREEN-READ-SPOOL.
	   IF SPL-CONT = "PAGE"
	       MOVE 3		 TO WS-ADVANCE
	   ELSE
	       MOVE SPL-ADV	 TO WS-ADVANCE.

       SCREEN-PRINT-START.
	     MOVE WS-SCREEN-LIN  TO WS-S8.
	   IF WS-SCREEN-LIN < 20
	       ADD 1		 TO WS-S8
	   ELSE
	       GO TO SCREEN-PRINT-SCROLL.

       DISPLAY-A-PRINT-LINE.
	     MOVE SPL-DETAIL1	 TO W05-DETAIL (WS-S8).
	   IF WS-LEFT > 1 AND < 60
	       PERFORM SCREEN-SHIFT-DATA THRU SCREEN-SHIFT-LOOP
	   ELSE
	   IF WS-SCREEN = 1
	       DISPLAY SD-LEFT
	   ELSE
	       DISPLAY SD-RIGHT.
	     GO TO SCREEN-PRINT-CHECK.

       SCREEN-PRINT-SCROLL.
	     MOVE 1		 TO WS-S7.
	     MOVE 2		 TO WS-S8.

       SCREEN-PRINT-LOOP.
	     MOVE W05-LINE (WS-S8)
				 TO W05-LINE (WS-S7).
	   IF WS-S8 < 20
	       ADD 1		 TO WS-S7 WS-S8
	       GO TO SCREEN-PRINT-LOOP.
	     GO TO DISPLAY-A-PRINT-LINE.

       SCREEN-PRINT-CHECK.
	     MOVE WS-S8 	 TO WS-SCREEN-LIN.
	   IF WS-COMMAND = "E"
	       GO TO SCREEN-CONTROL.
	   IF (WS-S8 = 20)
	       PERFORM SCREEN-CONTROL THRU SCREEN-CONTROL-EXIT
	       IF WS-COMMAND = "Z"
		   GO TO SCREEN-PRINT-EXIT.
	   IF WS-ADVANCE > 1
	       SUBTRACT 1	 FROM WS-ADVANCE
	       MOVE SPACES	 TO SPL-DETAIL1
	       GO TO SCREEN-PRINT-START.
	     GO TO SCREEN-READ-SPOOL.

       SCREEN-SHIFT-LEFT.
	   IF WS-LEFT > 1
	       SUBTRACT 1	 FROM WS-LEFT
				      WS-RIGHT.
	       PERFORM SCREEN-SHIFT-DATA THRU SCREEN-SHIFT-LOOP.

       SCREEN-SHIFT-RIGHT.
	   IF WS-RIGHT < 136
	       ADD 1		 TO WS-LEFT
				    WS-RIGHT.
	       PERFORM SCREEN-SHIFT-DATA THRU SCREEN-SHIFT-LOOP.

       SCREEN-SHIFT-DATA.
	     MOVE 1		 TO WS-S1 WS-S2.
	     MOVE WS-LEFT	 TO WS-S3.

       SCREEN-SHIFT-LOOP.
	     MOVE W05-CHAR (WS-S1, WS-S3)
				 TO W06-CHAR (WS-S1, WS-S2).
	   IF WS-S2 < 78
	       ADD 1		 TO WS-S2 WS-S3
	       GO TO SCREEN-SHIFT-LOOP.
	   IF WS-S1 < 20
	       ADD 1		 TO WS-S1
	       MOVE 1		 TO WS-S2
	       MOVE WS-LEFT	 TO WS-S3
	       GO TO SCREEN-SHIFT-LOOP.
	     DISPLAY SD-RANDOM.

       SCREEN-CONTROL.
	     DISPLAY "L" AT 2502
		      WITH FOREGROUND-COLOR 6 HIGHLIGHT
			   BACKGROUND-COLOR 3
		     "eft, "
		     "R" WITH FOREGROUND-COLOR 6 HIGHLIGHT
			      BACKGROUND-COLOR 3
		     "ight, "
		      WITH FOREGROUND-COLOR 1 BACKGROUND-COLOR 3
		     X"1B201A" WITH FOREGROUND-COLOR 6 HIGHLIGHT
				BACKGROUND-COLOR 3
		     "," WITH FOREGROUND-COLOR 1 BACKGROUND-COLOR 3
		     "N" WITH FOREGROUND-COLOR 6 HIGHLIGHT
			      BACKGROUND-COLOR 3
		     "ext, " WITH FOREGROUND-COLOR 1
				  BACKGROUND-COLOR 3
		     "P" WITH FOREGROUND-COLOR 6 HIGHLIGHT
			      BACKGROUND-COLOR 3
		     "age or " WITH FOREGROUND-COLOR 1
				    BACKGROUND-COLOR 3
		     "Esc" WITH FOREGROUND-COLOR 6 HIGHLIGHT
				BACKGROUND-COLOR 3
		     "ape" WITH FOREGROUND-COLOR 1 BACKGROUND-COLOR 3.

       SCREEN-CONTROL-OPT.
	     CALL X"AF" USING GET-SINGLE-CHAR, KEY-STATUS.
	   IF USER-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN ESC-KEY
		     MOVE "Z"	 TO WS-COMMAND
		     GO TO SCREEN-CONTROL-EXIT
		 WHEN PAGE-DOWN
		     GO TO SCREEN-CLEAR
		 WHEN OTHER	 CALL X"E5"
		     GO TO SCREEN-CONTROL-OPT
	       END-EVALUATE
	   ELSE
	   IF DATA-8BIT
	       MOVE KEY-CODE-1X  TO WS-OPTION
	   ELSE
	   IF ADIS-FUNC
	       EVALUATE KEY-CODE-1
		 WHEN LEFT-KEY
		     PERFORM SCREEN-SHIFT-LEFT
		     GO TO SCREEN-CONTROL-OPT
		 WHEN RIGHT-KEY
		     PERFORM SCREEN-SHIFT-RIGHT
		     GO TO SCREEN-CONTROL-OPT
		 WHEN DOWN-KEY
		     GO TO SCREEN-CONTROL-EXIT
		 WHEN OTHER	 CALL X"E5"
		     GO TO SCREEN-CONTROL-OPT
	       END-EVALUATE
	   ELSE
	       GO TO SCREEN-CONTROL-OPT.
	     CALL "CBL_TOUPPER" USING WS-OPTION
				BY VALUE WS-LENGTH
				RETURNING WS-STATUS.
	   IF NOT (WS-OPTION = "L" OR "N" OR "R" OR "P")
	       GO TO SCREEN-CONTROL-OPT.
	   IF WS-OPTION = "R"
	       MOVE 2		 TO WS-SCREEN
	       MOVE 59		 TO WS-LEFT
	       MOVE 136 	 TO WS-RIGHT
	   ELSE
	   IF WS-OPTION = "L"
	       MOVE 1		 TO WS-SCREEN
				    WS-LEFT
	       MOVE 78		 TO WS-RIGHT
	   ELSE
	   IF WS-OPTION = "P"
	       GO TO SCREEN-CLEAR
	   ELSE
	       PERFORM CLEAR-L50
	       GO TO SCREEN-CONTROL-EXIT.
	   IF WS-SCREEN = 1
	       DISPLAY SD-LEFT
	   ELSE
	       DISPLAY SD-RIGHT.
	     GO TO SCREEN-CONTROL-OPT.

       SCREEN-CLEAR.
	     MOVE 1		 TO WS-S8.

       SCREEN-CLEAR-LOOP.
	     MOVE SPACES	 TO W05-LINE (WS-S8).
	   IF WS-S8 < 20
	       ADD 1		 TO WS-S8
	       GO TO SCREEN-CLEAR-LOOP.
	     MOVE ZERO		 TO WS-SCREEN-LIN.

       SCREEN-CONTROL-EXIT.
	     EXIT.

       SCREEN-PRINT-EXIT.
	     EXIT.

       CA000	       SECTION 60.
       CA00.
	     DISPLAY "PICKING SLIPS" AT 0233
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT.
	     MOVE "WS"		 TO W02-WS.
	     MOVE "_"		 TO W02-US W02-US2.
	     MOVE LS-USER	 TO W02-TERM.
	     MOVE 1		 TO W02-REP.
	     MOVE "."		 TO W02-P.
	     MOVE LS-SYS-ID	 TO W02-USER.
	   IF TRM-PICP (WS-S6) = 1 OR 9
               MOVE "LPT1"       TO W02-PRINTER
	       MOVE ZERO	 TO WS-PRN-NO
           ELSE
           IF TRM-PICP (WS-S6) = 2
               MOVE "LPT2"       TO W02-PRINTER
	       MOVE 1		 TO WS-PRN-NO
           ELSE
           IF TRM-PICP (WS-S6) = 3
               MOVE "LPT3"       TO W02-PRINTER
	       MOVE 2		 TO WS-PRN-NO
           ELSE
           IF TRM-PICP (WS-S6) = 4
               MOVE "COM1"       TO W02-PRINTER
           ELSE
           IF TRM-PICP (WS-S6) = 5
	       MOVE "COM2"	 TO W02-PRINTER.
             ADD 501 TRM-PRN1 (WS-S6)
                                 GIVING W25-RESULT.

       CA999.
	     EXIT.

       DA000	       SECTION 61.
       DA00.
	     DISPLAY "INVOICES/CREDIT NOTES" AT 0229
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT.
	     MOVE "WS"		 TO W02-WS.
	     MOVE "_"		 TO W02-US W02-US2.
	     MOVE LS-USER	 TO W02-TERM.
	     MOVE 2		 TO W02-REP.
	     MOVE "."		 TO W02-P.
	     MOVE LS-SYS-ID	 TO W02-USER.
	   IF TRM-INVP (WS-S6) = 1 OR 9
               MOVE "LPT1"       TO W02-PRINTER
	       MOVE ZERO	 TO WS-PRN-NO
           ELSE
           IF TRM-INVP (WS-S6) = 2
               MOVE "LPT2"       TO W02-PRINTER
	       MOVE 1		 TO WS-PRN-NO
           ELSE
           IF TRM-INVP (WS-S6) = 3
               MOVE "LPT3"       TO W02-PRINTER
	       MOVE 2		 TO WS-PRN-NO
           ELSE
           IF TRM-INVP (WS-S6) = 4
               MOVE "COM1"       TO W02-PRINTER
           ELSE
           IF TRM-INVP (WS-S6) = 5
	       MOVE "COM2"	 TO W02-PRINTER.
             ADD 501 TRM-PRN2 (WS-S6)
                                 GIVING W25-RESULT.

       DA999.
	     EXIT.

       EA000	       SECTION 62.
       EA00.
	   IF WS-REPORT = 3
	       DISPLAY "GENERAL REPORTS - STOCK" AT 0228
			WITH FOREGROUND-COLOR 7 HIGHLIGHT
	   ELSE
	   IF WS-REPORT = 4
	       DISPLAY "GENERAL REPORTS - CREDITORS" AT 0226
			WITH FOREGROUND-COLOR 7 HIGHLIGHT
	   ELSE
	   IF WS-REPORT = 5
	       DISPLAY "GENERAL REPORTS - DEBTORS" AT 0229
			WITH FOREGROUND-COLOR 7 HIGHLIGHT
	   ELSE
	       DISPLAY "GENERAL REPORTS - G/LEDGER" AT 0226
			WITH FOREGROUND-COLOR 7 HIGHLIGHT.
	     MOVE "WS"		 TO W02-WS.
	     MOVE "_"		 TO W02-US W02-US2.
	     MOVE LS-USER	 TO W02-TERM.
	     MOVE WS-REPORT	 TO W02-REP.
	     MOVE "."		 TO W02-P.
	     MOVE LS-SYS-ID	 TO W02-USER.
	   IF TRM-STDP (WS-S6) = 1 OR 9
               MOVE "LPT1"       TO W02-PRINTER
	       MOVE ZERO	 TO WS-PRN-NO
           ELSE
           IF TRM-STDP (WS-S6) = 2
               MOVE "LPT2"       TO W02-PRINTER
	       MOVE 1		 TO WS-PRN-NO
           ELSE
           IF TRM-STDP (WS-S6) = 3
               MOVE "LPT3"       TO W02-PRINTER
	       MOVE 2		 TO WS-PRN-NO
           ELSE
           IF TRM-STDP (WS-S6) = 4
	       MOVE "COM1"	 TO W02-PRINTER
           ELSE
           IF TRM-STDP (WS-S6) = 5
	       MOVE "COM2"	 TO W02-PRINTER.
             ADD 501 TRM-PRN3 (WS-S6)
                                 GIVING W25-RESULT.

       EA999.
	     EXIT.

       FA000	       SECTION 63.
       FA00.
	     DISPLAY "DEBTOR STATEMENTS" AT 0231
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT.
	     MOVE "WS"		 TO W02-WS.
	     MOVE "_"		 TO W02-US W02-US2.
	     MOVE LS-USER	 TO W02-TERM.
	     MOVE 7		 TO W02-REP.
	     MOVE "."		 TO W02-P.
	     MOVE LS-SYS-ID	 TO W02-USER.
	   IF TRM-STMP (WS-S6) = 1 OR 9
	       MOVE "LPT1"	 TO W02-PRINTER
           ELSE
           IF TRM-STMP (WS-S6) = 2
	       MOVE "LPT2"	 TO W02-PRINTER
           ELSE
           IF TRM-STMP (WS-S6) = 3
	       MOVE "LPT3"	 TO W02-PRINTER
           ELSE
           IF TRM-STMP (WS-S6) = 4
	       MOVE "COM1"	 TO W02-PRINTER
           ELSE
           IF TRM-STMP (WS-S6) = 5
	       MOVE "COM2"	 TO W02-PRINTER.
             ADD 501 TRM-PRN4 (WS-S6)
                                 GIVING W25-RESULT.

       FA999.
	     EXIT.

       GA000	       SECTION 64.
       GA00.
	     DISPLAY "PRICE LABELS" AT 0233
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT.
	     MOVE "WS"		 TO W02-WS.
	     MOVE "_"		 TO W02-US W02-US2.
	     MOVE LS-USER	 TO W02-TERM.
	     MOVE 8		 TO W02-REP.
	     MOVE "."		 TO W02-P.
	     MOVE LS-SYS-ID	 TO W02-USER.
	   IF TRM-CSHP (WS-S6) = 1 OR 9
               MOVE "LPT1"       TO W02-PRINTER
	       MOVE ZERO	 TO WS-PRN-NO
           ELSE
	   IF TRM-CSHP (WS-S6) = 2
               MOVE "LPT2"       TO W02-PRINTER
	       MOVE 1		 TO WS-PRN-NO
           ELSE
	   IF TRM-CSHP (WS-S6) = 3
               MOVE "LPT3"       TO W02-PRINTER
	       MOVE 2		 TO WS-PRN-NO
           ELSE
	   IF TRM-CSHP (WS-S6) = 4
               MOVE "COM1"       TO W02-PRINTER
           ELSE
	   IF TRM-CSHP (WS-S6) = 5
	       MOVE "COM2"	 TO W02-PRINTER.
	     ADD 501 TRM-PRN5 (WS-S6)
                                 GIVING W25-RESULT.

       GA999.
	     EXIT.

       HA000	       SECTION 65.
       HA00.
	     DISPLAY "QUOTATIONS/JOBS" AT 0233
		      WITH FOREGROUND-COLOR 7 HIGHLIGHT.
	     MOVE "WS"		 TO W02-WS.
	     MOVE "_"		 TO W02-US W02-US2.
	     MOVE LS-USER	 TO W02-TERM.
	     MOVE 9		 TO W02-REP.
	     MOVE "."		 TO W02-P.
	     MOVE LS-SYS-ID	 TO W02-USER.
	   IF TRM-POS (WS-S6) = 1 OR 9
               MOVE "LPT1"       TO W02-PRINTER
           ELSE
           IF TRM-POS (WS-S6) = 2
               MOVE "LPT2"       TO W02-PRINTER
           ELSE
           IF TRM-POS (WS-S6) = 3
               MOVE "LPT3"       TO W02-PRINTER
           ELSE
           IF TRM-POS (WS-S6) = 4
               MOVE "COM1"       TO W02-PRINTER
           ELSE
           IF TRM-POS (WS-S6) = 5
	       MOVE "COM2"	 TO W02-PRINTER.
	     ADD 501 TRM-PRN6 (WS-S6)
                                 GIVING W25-RESULT.

       HA999.
	     EXIT.
      /
      *    ****    INITIALIZE ROUTINE    ****
      *
029020 ZA000	       SECTION 90.
       ZA00.
	     MOVE LS-COMPANY	 TO WS-TOP-COMP.
	   IF LS-USER = LS-SYS-ID
	       MOVE "SupervisorÄ"  TO WS-WRKHD
	   ELSE
	       MOVE "Workstation"  TO WS-WRKHD
	       MOVE LS-USER	   TO WS-WRKST.
	     MOVE LS-PARID	 TO WS-PARID.
	     MOVE LS-L-OR-N	 TO W02-L-OR-N.
	     MOVE WS-SYS-ID	 TO W02-SYSID.
	     MOVE LS-TODAY-DDMMYY
				 TO TODAY-DDMMYY.
	     MOVE LS-USUB	 TO WS-USUB.
033950	     DISPLAY CLR-SCREEN.
      *
      *    ****    S E T   U P   T H E   F U N C T I O N   K E Y S
      *
	     MOVE 1		 TO USER-ACTION
				    USER-SETTING.
      *
      *    ESC, F1 to F10 keys
      *
	     MOVE ZERO		 TO USER-NUMBER.
	     MOVE 11		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *
      *    PAGE-UP AND PAGE-DOWN KEYS
      *
	     MOVE 53		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *
      *    ****    A C T I V A T E   M O U S E
      *
	     MOVE 64		 TO MOUSE-FUNC.
	     MOVE 1		 TO MOUSE-PARAM.
	     CALL X"AF" USING MOUSE-FUNC
			      MOUSE-PARAM.
	   IF MOUSE-FUNC NOT = 255
	       MOVE "Y"		 TO MOUSE-ATTACHED
	       MOVE 66		 TO MOUSE-FUNC
	       MOVE 0		 TO MOUSE-PARAM
	       CALL X"AF" USING MOUSE-FUNC
				MOUSE-PARAM
	   ELSE
	       GO TO ZA999.
      *
      *    ****    S E T   M O U S E   K E Y   T O   A C T
      * 	   A S	 F U N C T I O N   K E Y
      *
	     MOVE 3		 TO USER-ACTION.
	     MOVE 27		 TO USER-NUMBER.
	     MOVE 2		 TO USER-KEYS.
	     CALL X"AF" USING SET-BIT-PAIRS, USER-KEY-CONTROL.
      *
      *    ****    P A R A M E T E R   F I L E
      *
       ZA00A.
	     MOVE "PARAM"	 TO AFID-KEY.

       ZA00-READ-APACFIDS.
000030	     READ APACFIDS WITH IGNORE LOCK
	       KEY IS AFID-KEY.
	   IF WS-STATUS = "00"
	       GO TO ZA00-READ-APACFIDS-EXIT.
006260	     STRING "Missing " DELIMITED SIZE
		     AFID-KEY DELIMITED BY " "
		     " file ID - Status " DELIMITED SIZE
		     WS-STATUS DELIMITED SIZE
		     INTO WS-ERR-MES.
	     PERFORM ERROR-LENGTH THRU ERROR-EXIT.
006370	     STOP RUN.

       ZA00-READ-APACFIDS-EXIT.
	     EXIT.

       ZA00A-CONTINUE.
	     MOVE AFID-PATH	 TO W02-PARAM.
	   IF LS-USER NUMERIC
	       IF LS-USE > ZERO AND < 110
		   MOVE LS-USE	 TO WS-USUB
	       END-IF
	   ELSE
	       MOVE 110		 TO WS-USUB.
014240       ADD 2549 WS-USUB    GIVING W25-RESULT.
             MOVE W25-KEY        TO WS-PARKEY.
             ADD 1 W25-SUB       GIVING WS-S6.
014250       PERFORM READ-PARAM THRU READ-PARAM-EXIT.

035020 ZA999.
035030       EXIT.

      /
      *    ****    I / O   E R R O R   M E S S A G E S
      *
042900 ZB000-ERROR	     SECTION 91.

041480 OPEN-ERROR.
041490       DISPLAY CLR-SCREEN.
041500       DISPLAY "Open error" AT 0812 WITH FOREGROUND-COLOR 14.
041510       GO TO DISPLAY-FILE-NAME.

041480 READ-ERROR.
041490       DISPLAY CLR-SCREEN.
041500       DISPLAY "Read error" AT 0812 WITH FOREGROUND-COLOR 14.
041510       GO TO DISPLAY-FILE-NAME.

041520 WRITE-ERROR.
041530       DISPLAY CLR-SCREEN.
041540       DISPLAY "Write error" AT 0812 WITH FOREGROUND-COLOR 14.
041510       GO TO DISPLAY-FILE-NAME.
       I-O-ERROR-EXIT.
             EXIT.

041560 DISPLAY-FILE-NAME.
041850	   IF WS-F-ERROR = 15
041860	       MOVE WS-PARID	 TO WS-FILE
041870	       MOVE WS-PARKEY	 TO WS-KEY.
041880	   IF WS-STATUS = "10"
041890         MOVE "End of FILE" TO WS-STAT-MESSAGE
041900     ELSE
041910     IF WS-STATUS = "22"
041920         MOVE "Duplicate record number" TO WS-STAT-MESSAGE
041930     ELSE
041940     IF WS-STATUS = "23"
041950         MOVE "Invalid record number" TO WS-STAT-MESSAGE
041960     ELSE
041970     IF WS-STATUS = "24"
041980         MOVE "DISK full" TO WS-STAT-MESSAGE
041990     ELSE
042000     IF WS-STATUS = "30"
042010         MOVE "DISK error" TO WS-STAT-MESSAGE
042020     ELSE
042030     IF WS-STATUS = "94"
042040         MOVE "FILE locked" TO WS-STAT-MESSAGE.
045380       DISPLAY "File - " AT 1012 WS-FILE WITH FOREGROUND-COLOR 11.
045390       DISPLAY "Status " AT 1212
                      WS-STATUS WITH FOREGROUND-COLOR 11
                     ": " WS-STAT-MESSAGE WITH FOREGROUND-COLOR 14.
045400     IF WS-STATUS NOT = "94"
045410         DISPLAY "Key    " AT 1412
                        WS-KEY WITH FOREGROUND-COLOR 11
                        " " WS-KEYX WITH FOREGROUND-COLOR 11
045420         DISPLAY "Reverse backup or contact program Support"
                        AT 1612.
045440         DISPLAY "Please make a note of these details" AT 1812.
042170       STOP RUN.
