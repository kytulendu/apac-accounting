      *
      *    ****    E X T R A C T   C O N S O L O D A T E D
      * 	   A C C O U N T   T R A N S A C T I O N S
      *
       XA000	       SECTION 49.
       XA00.
	     PERFORM SAVE-SCREEN-3.
	     MOVE 10		 TO SHADE-ROW.
	     MOVE 14		 TO SHADE-COL.
	     MOVE 55		 TO SHADE-WIDTH.
	     MOVE 2		 TO SHADE-LINES.
	     DISPLAY
	     "旼컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴"
		      AT 0912 WITH FOREGROUND-COLOR 5 HIGHLIGHT
				   BACKGROUND-COLOR 5
		     "" WITH FOREGROUND-COLOR 0 BACKGROUND-COLOR 5.
	     DISPLAY " " AT 1012 WITH FOREGROUND-COLOR 5 HIGHLIGHT
				       BACKGROUND-COLOR 5
	     "Extracting consolodated transactions:                 "
		      WITH BACKGROUND-COLOR 0 FOREGROUND-COLOR 5.
	     DISPLAY "" AT 1112 WITH FOREGROUND-COLOR 5 HIGHLIGHT
				      BACKGROUND-COLOR 5
	     "컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸"
		      WITH BACKGROUND-COLOR 0 FOREGROUND-COLOR 5.
	     PERFORM SCREEN-SHADOW.
	     MOVE " !"		 TO DEB-NAME.
	     PERFORM START-AT-DEBT-NAME THRU READ-DEBTOR-EXIT.
010780	   IF WS-F-ERROR = 6
021070	       GO TO XA999-EXIT.

       XA05.
021090	     PERFORM READ-DEBTOR-NEXT THRU READ-DEBTOR-EXIT.
010780     IF WS-F-ERROR = 6
	       GO TO
	     DISPLAY DEB-ACNO AT 1052
		     WITH FOREGROUND-COLOR 7 HIGHLIGHT
			  BACKGROUND-COLOR 5.
	   IF NOT (DEB-CONAC = SPACES)
	       IF NOT (DEB-ACNO = DEB-CONAC)
		   PERFORM XA10 THRU XA


       XA10.
	     MOVE DEB-ACNO	 TO TRA-KEY.
             PERFORM START-AT-DTRN-KEY THRU READ-DBTRAN-EXIT.
           IF WS-F-ERROR = 5
022980	       GO TO XA********

       XA15.
023010       PERFORM READ-DBTRAN-NEXT THRU READ-DBTRAN-EXIT.
	   IF (WS-F-ERROR = 5) OR
              (TRA-AC NOT = DEB-ACNO)
	       GO TO XA*********
	     DISPLAY TRA-REF AT 1059
		     WITH FOREGROUND-COLOR 3 HIGHLIGHT
			  BACKGROUND-COLOR 5.
	     MOVE TRA-RECORD1	 TO CON-TRAN.
	     MOVE DEB-CONAC	 TO DBT-CON.
	     PERFORM WRITE-DBTCON THRU WRITE-DBTCON-EXIT.
	     GO TO XA15.
