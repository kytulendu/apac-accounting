
008460 READ-WORKSTAT.
008470	     READ WORKSTAT	 WITH IGNORE LOCK.
008480     IF WS-STATUS = "00"
008490	       GO TO READ-WORKSTAT-EXIT.
008500     IF WS-STAT1 = "2" OR "3" OR "4"
008510	       MOVE 41		 TO WS-F-ERROR
008520         PERFORM READ-ERROR.
008560	     MOVE 41		 TO WS-F-ERROR.
008570       PERFORM READ-ERROR.
008580	     GO TO READ-WORKSTAT-EXIT.

008590 READ-WORKSTAT-LOCK.
008600	     READ WORKSTAT WITH KEPT LOCK.
008610     IF WS-STATUS = "00"
008620	       GO TO READ-WORKSTAT-EXIT.
008630     IF WS-STAT1 = "2" OR "3" OR "4"
008640	       MOVE 41		 TO WS-F-ERROR
008650         PERFORM READ-ERROR.
008660     IF RECORD-LOCKED
	       MOVE W02-WORKSTAT TO WS-FILE
	       MOVE WS-TRMKEY	 TO WS-KEY
008670         PERFORM LOCKED-RECORD
008680	       GO TO READ-WORKSTAT-LOCK.
008690     IF TOO-MANY-LOCKS
008700	       UNLOCK WORKSTAT
008710	       GO TO READ-WORKSTAT-LOCK.
008720	     MOVE 41		 TO WS-F-ERROR.
008730       PERFORM READ-ERROR.

008740 READ-WORKSTAT-EXIT.
008750       EXIT.
