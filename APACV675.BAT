@ECHO OFF
:: APACV675.BAT
:: Do not change the name of this batch file
::
IF "%1==" GOTO USER

IF "%2==" GOTO ERROR
FOR %%S IN (C c) DO IF %1==/%%S GOTO CONVRT
GOTO ERROR

:COMP_CNV
CLS
ECHO Enter company to convert
FC CON NUL /LB1 /N | DATE | FIND "1: " > CNV_TEMP.BAT
ECHO @SET ADDPATH=%%5 > ENTER.BAT
CALL CNV_TEMP.BAT
DEL CNV_TEMP.BAT
DEL ENTER.BAT
IF NOT "%ADDPATH%==" CALL APACV675 /C %ADDPATH%
SET ADDPATH=

:USER
CLS
ECHO.
ECHO.
ECHO		 ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
ECHO		 ³    APAC Convertion Manager	  ³
ECHO		 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
ECHO		 ³     1. View System Files	  ³
ECHO		 ³     2. Convert Company	  ³
ECHO		 ³     3. End Convertion	  ³
ECHO		 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
ECHO.
CHOICE /C123 /N "                  Your choice: "
IF ERRORLEVEL 3 GOTO END
IF ERRORLEVEL 2 GOTO COMP_CNV
IF ERRORLEVEL 1 GOTO USER_VIEW
GOTO USER

:CONVRT
IF NOT EXIST SYST_%2.APC GOTO NOSYST

MD %2_DATA
:: Copy all files to the new directory
CD %2_DATA
COPY ..\SYST_%2.APC SYSTEM.DAT
DEL ..\SYST_%2.APC
IF EXIST ..\AUDT_%2.APC COPY ..\AUDT_%2.APC AUDIT.DAT
DEL ..\AUDT_%2.APC
IF EXIST ..\BCOD_%2.APC COPY ..\BCOD_%2.APC BARCODE.DAT
DEL ..\BCOD_%2.APC
IF NOT EXIST ..\CRDX_%2.APC GOTO CHQ
COPY ..\CRDX_%2.APC CARDEXSL.DAT
COPY ..\CRDX_%2.IDX CARDEXSL.IDX
DEL ..\CRDX_%2.APC
DEL ..\CRDX_%2.IDX

:CHQ
IF NOT EXIST ..\CHQE_%2.APC GOTO CNT
COPY ..\CHQE_%2.APC CHEQUE.DAT
COPY ..\CHQE_%2.IDX CHEQUE.IDX
DEL ..\CHQE_%2.APC
DEL ..\CHQE_%2.IDX

:CNT
IF EXIST ..\CONT_%2.APC COPY ..\CONT_%2.APC CONTROL.DAT
DEL ..\CONT_%2.APC
IF NOT EXIST ..\CMEM_%2.APC GOTO CRED
COPY ..\CMEM_%2.APC CRDMEM.DAT
COPY ..\CMEM_%2.IDX CRDMEM.IDX
DEL ..\CMEM_%2.APC
DEL ..\CMEM_%2.IDX

:CRED
IF NOT EXIST ..\CRED_%2.APC GOTO CTRN
COPY ..\CRED_%2.APC CREDIT.DAT
COPY ..\CRED_%2.IDX CREDIT.IDX
DEL ..\CRED_%2.APC
DEL ..\CRED_%2.IDX

:CTRN
IF NOT EXIST ..\CTRN_%2.APC GOTO DBFT
COPY ..\CTRN_%2.APC CRTRAN.DAT
COPY ..\CTRN_%2.IDX CRTRAN.IDX
DEL ..\CTRN_%2.APC
DEL ..\CTRN_%2.IDX

:DBFT
IF NOT EXIST ..\DBFT_%2.APC GOTO DTRN
COPY ..\DBFT_%2.APC DBCONT.DAT
COPY ..\DBFT_%2.IDX DBCONT.IDX
DEL ..\DBFT_%2.APC
DEL ..\DBFT_%2.IDX

:DTRN
IF NOT EXIST ..\DTRN_%2.APC GOTO DCOL
COPY ..\DTRN_%2.APC DBTRAN.DAT
COPY ..\DTRN_%2.IDX DBTRAN.IDX
DEL ..\DTRN_%2.APC
DEL ..\DTRN_%2.IDX

:DCOL
IF NOT EXIST ..\DCOL_%2.APC GOTO DMEM
COPY ..\DCOL_%2.APC DEBCOL.DAT
COPY ..\DCOL_%2.IDX DEBCOL.IDX
DEL ..\DCOL_%2.APC
DEL ..\DCOL_%2.IDX

:DMEM
IF NOT EXIST ..\DMEM_%2.APC GOTO DORD
COPY ..\DMEM_%2.APC DEBMEM.DAT
COPY ..\DMEM_%2.IDX DEBMEM.IDX
DEL ..\DMEM_%2.APC
DEL ..\DMEM_%2.IDX

:DORD
IF NOT EXIST ..\DORD_%2.APC GOTO DEBT
COPY ..\DORD_%2.APC DEBORD.DAT
COPY ..\DORD_%2.IDX DEBORD.IDX
DEL ..\DORD_%2.APC
DEL ..\DORD_%2.IDX

:DEBT
IF NOT EXIST ..\DEBT_%2.APC GOTO DEPT
COPY ..\DEBT_%2.APC DEBTOR.DAT
COPY ..\DEBT_%2.IDX DEBTOR.IDX
DEL ..\DEBT_%2.APC
DEL ..\DEBT_%2.IDX

:DEPT
IF EXIST ..\DEPT_%2.APC COPY ..\DEPT_%2.APC DEPART.DAT
DEL ..\DEPT_%2.APC
IF NOT EXIST ..\LEDG_%2.APC GOTO GUAR
COPY ..\LEDG_%2.APC GACCNT.DAT
COPY ..\LEDG_%2.IDX GACCNT.IDX
DEL ..\LEDG_%2.APC
DEL ..\LEDG_%2.IDX

:GUAR
IF NOT EXIST ..\GUAR_%2.APC GOTO GBHD
COPY ..\GUAR_%2.APC GARTEE.DAT
COPY ..\GUAR_%2.IDX GARTEE.IDX
DEL ..\GUAR_%2.APC
DEL ..\GUAR_%2.IDX

:GBHD
IF NOT EXIST ..\GBHD_%2.APC GOTO GINS
COPY ..\GBHD_%2.APC GLBHDR.DAT
COPY ..\GBHD_%2.IDX GLBHDR.IDX
DEL ..\GBHD_%2.APC
DEL ..\GBHD_%2.IDX

:GINS
IF NOT EXIST ..\GINS_%2.APC GOTO GTRN
COPY ..\GINS_%2.APC GLINST.DAT
COPY ..\GINS_%2.IDX GLINST.IDX
DEL ..\GINS_%2.APC
DEL ..\GINS_%2.IDX

:GTRN
IF NOT EXIST ..\GTRN_%2.APC GOTO INVC
COPY ..\GTRN_%2.APC GLTRAN.DAT
COPY ..\GTRN_%2.IDX GLTRAN.IDX
DEL ..\GTRN_%2.APC
DEL ..\GTRN_%2.IDX

:INVC
IF NOT EXIST ..\INVC_%2.APC GOTO JAUD
COPY ..\INVC_%2.APC INVOICE.DAT
COPY ..\INVC_%2.IDX INVOICE.IDX
DEL ..\INVC_%2.APC
DEL ..\INVC_%2.IDX

:JAUD
IF NOT EXIST ..\JAUD_%2.APC GOTO JOBS
COPY ..\JAUD_%2.APC JOBAUD.DAT
COPY ..\JAUD_%2.IDX JOBAUD.IDX
DEL ..\JAUD_%2.APC
DEL ..\JAUD_%2.IDX

:JOBS
IF NOT EXIST ..\JOBS_%2.APC GOTO JLIN
COPY ..\JOBS_%2.APC JOBHDR.DAT
COPY ..\JOBS_%2.IDX JOBHDR.IDX
DEL ..\JOBS_%2.APC
DEL ..\JOBS_%2.IDX

:JLIN
IF NOT EXIST ..\JLIN_%2.APC GOTO JREQ
COPY ..\JLIN_%2.APC JOBLIN.DAT
COPY ..\JLIN_%2.IDX JOBLIN.IDX
DEL ..\JLIN_%2.APC
DEL ..\JLIN_%2.IDX

:JREQ
IF NOT EXIST ..\JREQ_%2.APC GOTO JRMK
COPY ..\JREQ_%2.APC JOBREQ.DAT
COPY ..\JREQ_%2.IDX JOBREQ.IDX
DEL ..\JREQ_%2.APC
DEL ..\JREQ_%2.IDX

:JRMK
IF NOT EXIST ..\JRMK_%2.APC GOTO JWAR
COPY ..\JRMK_%2.APC JOBRMK.DAT
COPY ..\JRMK_%2.IDX JOBRMK.IDX
DEL ..\JRMK_%2.APC
DEL ..\JRMK_%2.IDX

:JWAR
IF NOT EXIST ..\JWAR_%2.APC GOTO LTRF
COPY ..\JWAR_%2.APC JOBWAR.DAT
COPY ..\JWAR_%2.IDX JOBWAR.IDX
DEL ..\JWAR_%2.APC
DEL ..\JWAR_%2.IDX

:LTRF
IF NOT EXIST ..\LTRF_%2.APC GOTO LTRG
COPY ..\LTRF_%2.APC LEDTRF.DAT
COPY ..\LTRF_%2.IDX LEDTRF.IDX
DEL ..\LTRF_%2.APC
DEL ..\LTRF_%2.IDX

:LTRG
IF NOT EXIST ..\LTRG_%2.APC GOTO PARM
COPY ..\LTRG_%2.APC LEDTRG.DAT
COPY ..\LTRG_%2.IDX LEDTRG.IDX
DEL ..\LTRG_%2.APC
DEL ..\LTRG_%2.IDX

:PARM
IF EXIST ..\PARM_%2.APC COPY ..\PARM_%2.APC PARAM.DAT
DEL ..\PARM_%2.APC
IF NOT EXIST ..\PCHQ_%2.APC GOTO PORD
COPY ..\PCHQ_%2.APC PDCHEQ.DAT
COPY ..\PCHQ_%2.IDX PDCHEQ.IDX
DEL ..\PCHQ_%2.APC
DEL ..\PCHQ_%2.IDX

:PORD
IF NOT EXIST ..\PORD_%2.APC GOTO PPLU
COPY ..\PORD_%2.APC PORDER.DAT
COPY ..\PORD_%2.IDX PORDER.IDX
DEL ..\PORD_%2.APC
DEL ..\PORD_%2.IDX

:PPLU
IF NOT EXIST ..\PPLU_%2.APC GOTO PRDX
COPY ..\PPLU_%2.APC POSPLU.DAT
COPY ..\PPLU_%2.IDX POSPLU.IDX
DEL ..\PPLU_%2.APC
DEL ..\PPLU_%2.IDX

:PRDX
IF NOT EXIST ..\PRDX_%2.APC GOTO ROUT
COPY ..\PRDX_%2.APC CARDEXPR.DAT
COPY ..\PRDX_%2.IDX CARDEXPR.IDX
DEL ..\PRDX_%2.APC
DEL ..\PRDX_%2.IDX

:ROUT
IF NOT EXIST ..\ROUT_%2.APC GOTO SLIP
COPY ..\ROUT_%2.APC ROUTE.DAT
COPY ..\ROUT_%2.IDX ROUTE.IDX
DEL ..\ROUT_%2.APC
DEL ..\ROUT_%2.IDX

:SLIP
IF NOT EXIST ..\SLIP_%2.APC GOTO SORD
COPY ..\SLIP_%2.APC PSLIPS.DAT
COPY ..\SLIP_%2.IDX PSLIPS.IDX
DEL ..\SLIP_%2.APC
DEL ..\SLIP_%2.IDX

:SORD
IF NOT EXIST ..\SORD_%2.APC GOTO PART
COPY ..\SORD_%2.APC SORDER.DAT
COPY ..\SORD_%2.IDX SORDER.IDX
DEL ..\SORD_%2.APC
DEL ..\SORD_%2.IDX

:PART
IF NOT EXIST ..\PART_%2.APC GOTO SMEM
COPY ..\PART_%2.APC SPARTS.DAT
COPY ..\PART_%2.IDX SPARTS.IDX
DEL ..\PART_%2.APC
DEL ..\PART_%2.IDX

:SMEM
IF NOT EXIST ..\SMEM_%2.APC GOTO STCK
COPY ..\SMEM_%2.APC STKMEM.DAT
COPY ..\SMEM_%2.IDX STKMEM.IDX
DEL ..\SMEM_%2.APC
DEL ..\SMEM_%2.IDX

:STCK
IF NOT EXIST ..\STCK_%2.APC GOTO SUSE
COPY ..\STCK_%2.APC STOCKF.DAT
COPY ..\STCK_%2.IDX STOCKF.IDX
DEL ..\STCK_%2.APC
DEL ..\STCK_%2.IDX

:SUSE
IF NOT EXIST ..\SUSE_%2.APC GOTO TTRN
COPY ..\SUSE_%2.APC SYSUSE.DAT
COPY ..\SUSE_%2.IDX SYSUSE.IDX
DEL ..\SUSE_%2.APC
DEL ..\SUSE_%2.IDX

:TTRN
IF NOT EXIST ..\TTRN_%2.APC GOTO TTRP
COPY ..\TTRN_%2.APC TXTRAN.DAT
COPY ..\TTRN_%2.IDX TXTRAN.IDX
DEL ..\TTRN_%2.APC
DEL ..\TTRN_%2.IDX

:TTRP
IF NOT EXIST ..\TTRP_%2.APC GOTO VCLE
COPY ..\TTRP_%2.APC TXPTRN.DAT
COPY ..\TTRP_%2.IDX TXPTRN.IDX
DEL ..\TTRP_%2.APC
DEL ..\TTRP_%2.IDX

:VCLE
IF NOT EXIST ..\VCLE_%2.APC GOTO VSTK
COPY ..\VCLE_%2.APC VEHICLE.DAT
COPY ..\VCLE_%2.IDX VEHICLE.IDX
DEL ..\VCLE_%2.APC
DEL ..\VCLE_%2.IDX

:VSTK
IF NOT EXIST ..\VSTK_%2.APC GOTO WHSE
COPY ..\WHSE_%2.APC WARHSE.DAT
COPY ..\WHSE_%2.IDX WARHSE.IDX
DEL ..\WHSE_%2.APC
DEL ..\WHSE_%2.IDX

:WSTK
IF NOT EXIST ..\WSTK_%2.APC GOTO ECNV
COPY ..\WSTK_%2.APC WSTOCK.DAT
COPY ..\WSTK_%2.IDX WSTOCK.IDX
DEL ..\WSTK_%2.APC
DEL ..\WSTK_%2.IDX

:ECNV
SHIFT
IF NOT "%2==" GOTO CONVRT
GOTO END

:NOSYST
ECHO Company code %2 does not exist
PAUSE
GOTO END

:ERROR
ECHO Command-line Error: %0 %1 %2 %3 %4 %5
ECHO.

:HELP
ECHO.
ECHO The Convertion Manager
ECHO.
ECHO    Usage:
ECHO.
ECHO	  APAC675		    == Interactive mode
ECHO.
ECHO	  APAC675 /C cpy ...	    == Convert one or more
ECHO				       companies
ECHO.
:END
