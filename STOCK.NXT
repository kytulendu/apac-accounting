      /
      *    ****    G E T   T H E   N E X T   S T O C K   R E C O R D
      *            V I A   T H E   I T E M   C O D E   I N D E X
      *
011010 GET-NEXT-STOCK  SECTION.

011020 NSTK-INIT.
011030       MOVE ZERO TO WS-ERROR.
011040       GO TO NSTK-CHK-IDX-LINK.

011050 NSTK-READ-IDX-CTAB.
011060       MOVE WS-IXS3 TO WS-SINKEY.
011070       PERFORM READ-SINDEX THRU READ-SINDEX-EXIT.

011080 NSTK-IDX-CTAB.
011090     IF (IND-PREF (WS-IXS1) NOT = SPACES) AND
011100        (IND-INDEX (WS-IXS1) NOT = ZERO)
011110         MOVE IND-INDEX (WS-IXS1) TO WS-SINKEY
011120         GO TO NSTK-READ-IDX-FTAB.
011130     IF WS-IXS1 < 58
011140         ADD 1 TO WS-IXS1
011150         GO TO NSTK-IDX-CTAB.
011160       GO TO NSTK-CHK-IDX-END.

011170 NSTK-READ-IDX-FTAB.
011180       PERFORM READ-SINDEX THRU READ-SINDEX-EXIT.
011190       MOVE 1 TO WS-IXS4.

011200 NSTK-IDX-FTAB.
011210     IF IND-SKEY (WS-IXS4) = ZERO
011220         GO TO NSTK-CHK-IDX-LINK.
           IF IND-TYPE (WS-IXS4) = WS-ETYPE
011230         MOVE IND-SKEY (WS-IXS4) TO WS-STKKEY
011240         GO TO GET-NEXT-STOCK-EXIT.

011250 NSTK-CHK-IDX-LINK.
011260     IF WS-IXS4 < 14
011270         ADD 1 TO WS-IXS4
011280         GO TO NSTK-IDX-FTAB.
011290     IF IND-LNK > ZERO
011300         MOVE IND-LNK TO WS-SINKEY
011310         GO TO NSTK-READ-IDX-FTAB.
011320     IF WS-IXS1 < 58
011330         ADD 1 TO WS-IXS1
011340         GO TO NSTK-READ-IDX-CTAB.

011350 NSTK-CHK-IDX-END.
011360       MOVE 1 TO WS-IXS1.
011370     IF WS-IXS3 < 67
011380         ADD 1 TO WS-IXS3
011390         GO TO NSTK-READ-IDX-CTAB.
011400       MOVE 1 TO WS-ERROR.

011410 GET-NEXT-STOCK-EXIT.
011420       EXIT.
